---
title: "CBA analysis for Vaccine storage"
author: "Nilanjan Biswas, Katie Gabrick, Owen Jonas, Jake Wesner"
date: "Fall 2023"
output: html_document
---


```{r initialization}
rm(list=ls())
```

# A. Cost Calculations

Cost calculations comprise of the following components:

## A.1. Cost calculations for energy systems

i.  Capital cost and Operating & Maintenance Costs for Energy systems
    It is assumed that currently Diesel generators are available as an alternate to grid energy to address power failures
ii. Environment costs for Diesel Generators

## A.2. Cost calculations for Vaccination programs

i. Vaccine Costs: Vaccine costs have been ranged from the lowest to the highest quotes as per the latest data from PAHO (2023), UNICEF (2021), and GAVI

ii. Vaccine delivery costs: Delivery costs across the target countries have been assumed as per Portnoy et al., 2019. They provide the per dose economic cost (US$ in 2018) break-up for vaccines as follows:

| Total Cost per dose  | Labor Cost per dose | Supply Chain Cost per dose | Service Delivery Cost per dose | Capital Cost per dose |
|----------|----------|----------|----------|----------|
|   $1.49 ($0.57 - 3.31)    | $0.59 ($0.23 - 1.28)    | $0.21 ($0.07 - 0.49)    | $0.52 ($0.17 - 1.23)   | $0.17 ($0.06 - 0.43)   |


# B. Benefit Calculations

Benefit calculations from the vaccination program are being calculated using three methodologies

## B.1. Cost of Illness averted method

Cost of illness averted values have been assumed from Ozawa et al. (2017) paper, Estimated economic impact of vaccinations in 73 low- and middleincome countries, 2001â€“2020, where they provide the Averted Cost of Illness (CoI) for per vaccinated individual, separately for each of the pathogens that are being considered in our estimates. The paper provides CoI in 2010 USD terms. These values have been inflated to 2022 levels using yearly inflation rates from World Bank 

## B.2. Value of Statistical Life (VSL) method

VSL based benefits have been calculated based on Death averted data provided by latest 2021 estimates from Vaccine Impact Modelling Consortium (VIMC) for each of the vaccines that are being considered for our estimates. VSL for the target countries has been arrived using VSL for USA as a base line and the following formula:

\[ VSL_{\text{target}} = VSL_{\text{base}} \times \left( \frac{\text{GDP}_{\text{target}}}{\text{GDP}_{\text{base}}} \right)^{\text{(income elasticity)}} \]

Using this VSL the benefits for each vaccine have been calculated as follows:

\[Benefit(VSL)_{\text{vaccine i}} =\sum_{t=1}^{n} NPV(VSL_{\text{i,t}} \times {\text{Death averted}_{i,t}}) \]

where i represents respective vaccine and t represents corresponding year.

##B.3. Values of Statistical Life years (VSLY) method 

VSLY based benefits have been calculated based on Disability Adjusted Life Years (DALY) data provided by latest 2021 estimates from Vaccine Impact Modelling Consortium (VIMC) for each of the vaccines that are being considered for our estimates. VSLY data has been calculated based on the VSL data for a country and the respective expected life years for each vaccine as follows:

\[VSLY = (\frac{r \times VSL}{1-(1+r)^{-L_a}})\]

Where r represents the discount rate, and La represents the expected life years for an effected person with respect to the pathogen associated with a specific vaccine. 

Using this VSLY enefits for each vaccine have been calculated as follows:

\[Benefit(VSLY)_{\text{vaccine i}} =\sum_{t=1}^{n} NPV(VSLY_{\text{i,t}} \times {\text{DALY averted}_{i,t}}) \]

where i represents respective vaccine and t represents corresponding year.


# 1. Status Quo

``` {r Cost Benefit Calculations_StatusQuo}
rm(list = ls())
set.seed(123) # Can be any number. This is done to maintain reproducibility 

########################################################## General Inputs##########################################################
# Set the number of Monte Carlo iterations
num_simulations <- 10000

discount_rate <- 0.03

population_base_year <- 2021
vaccination_estimation_end_year <- 2030
vac_estimation_length <- vaccination_estimation_end_year - population_base_year + 1

vaccine_annuity_factor = (1-(1/((1+discount_rate)^(vac_estimation_length
))))/discount_rate

### Cost calculations for energy systems ###

total_DG_NGA_capex_results <- numeric(num_simulations)
total_DG_NGA_opex_results <- numeric(num_simulations)
total_DG_NGA_totalcost_results <- numeric(num_simulations)
total_DG_NGA_fridgecost_results <- numeric(num_simulations)
total_DG_NGA_envcost_results <- numeric(num_simulations)

total_DG_MWI_capex_results <- numeric(num_simulations)
total_DG_MWI_opex_results <- numeric(num_simulations)
total_DG_MWI_totalcost_results <- numeric(num_simulations)
total_DG_MWI_fridgecost_results <- numeric(num_simulations)
total_DG_MWI_envcost_results <- numeric(num_simulations)

total_DG_DRC_capex_results <- numeric(num_simulations)
total_DG_DRC_opex_results <- numeric(num_simulations)
total_DG_DRC_totalcost_results <- numeric(num_simulations)
total_DG_DRC_fridgecost_results <- numeric(num_simulations)
total_DG_DRC_envcost_results <- numeric(num_simulations)

total_DG_totalcapex_results <- numeric(num_simulations)
total_DG_totalopex_results <- numeric(num_simulations)
total_DG_totalcost_results <- numeric(num_simulations)
total_DG_total_fridgecost_results <- numeric(num_simulations)
total_DG_envcost_results <- numeric(num_simulations)

# Cost and Benefit calculations for Vaccination programs #
vac_DG_NGA_cost_results <- numeric(num_simulations)
vac_DG_NGA_delivery_cost_results <- numeric(num_simulations)
vac_DG_NGA_total_cost_results <- numeric(num_simulations)
vac_DG_NGA_COI_results <- numeric(num_simulations)
vac_DG_NGA_NB_COI_results <- numeric(num_simulations)
vac_DG_NGA_VSL_results <- numeric(num_simulations)
vac_DG_NGA_NB_VSL_results <- numeric(num_simulations)
vac_DG_NGA_VSLY_results <- numeric(num_simulations)
vac_DG_NGA_NB_VSLY_results <- numeric(num_simulations)

vac_DG_MWI_cost_results <- numeric(num_simulations)
vac_DG_MWI_delivery_cost_results <- numeric(num_simulations)
vac_DG_MWI_total_cost_results <- numeric(num_simulations)
vac_DG_MWI_COI_results <- numeric(num_simulations)
vac_DG_MWI_NB_COI_results <- numeric(num_simulations)
vac_DG_MWI_VSL_results <- numeric(num_simulations)
vac_DG_MWI_NB_VSL_results <- numeric(num_simulations)
vac_DG_MWI_VSLY_results <- numeric(num_simulations)
vac_DG_MWI_NB_VSLY_results <- numeric(num_simulations)

vac_DG_DRC_cost_results <- numeric(num_simulations)
vac_DG_DRC_delivery_cost_results <- numeric(num_simulations)
vac_DG_DRC_total_cost_results <- numeric(num_simulations)
vac_DG_DRC_COI_results <- numeric(num_simulations)
vac_DG_DRC_NB_COI_results <- numeric(num_simulations)
vac_DG_DRC_VSL_results <- numeric(num_simulations)
vac_DG_DRC_NB_VSL_results <- numeric(num_simulations)
vac_DG_DRC_VSLY_results <- numeric(num_simulations)
vac_DG_DRC_NB_VSLY_results <- numeric(num_simulations)

vac_DG_cost_results <- numeric(num_simulations)
vac_DG_delivery_cost_results <- numeric(num_simulations)
vac_DG_total_cost_results <- numeric(num_simulations)
vac_DG_COI_results <- numeric(num_simulations)
vac_DG_NB_COI_results <- numeric(num_simulations)
vac_DG_VSL_results <- numeric(num_simulations)
vac_DG_NB_VSL_results <- numeric(num_simulations)
vac_DG_VSLY_results <- numeric(num_simulations)
vac_DG_NB_VSLY_results <- numeric(num_simulations)

### Cost calculation variables for energy systems ###

### Solar refrigerators

total_VCRC_NGA_opex_results <- numeric(num_simulations)
total_VCRC_NGA_capex_results <- numeric(num_simulations)
total_VCRC_NGA_envcost_results <- numeric(num_simulations)
total_VCRC_NGA_totalVCRCcost_results <- numeric(num_simulations)
total_DG_VCRC_NGA_opex_results <- numeric(num_simulations)
total_VCRC_NGA_batterycost_results <- numeric(num_simulations)
total_VCRC_NGA_totalcost_results <- numeric(num_simulations)
total_VCRC_NGA_gridpower_benefit <- numeric(num_simulations)


total_VCRC_MWI_opex_results <- numeric(num_simulations)
total_VCRC_MWI_capex_results <- numeric(num_simulations)
total_VCRC_MWI_envcost_results <- numeric(num_simulations)
total_VCRC_MWI_totalVCRCcost_results <- numeric(num_simulations)
total_DG_VCRC_MWI_opex_results <- numeric(num_simulations)
total_VCRC_MWI_batterycost_results <- numeric(num_simulations)
total_VCRC_MWI_totalcost_results <- numeric(num_simulations)
total_VCRC_MWI_gridpower_benefit <- numeric(num_simulations)

total_VCRC_DRC_opex_results <- numeric(num_simulations)
total_VCRC_DRC_capex_results <- numeric(num_simulations)
total_VCRC_DRC_envcost_results <- numeric(num_simulations)
total_VCRC_DRC_totalVCRCcost_results <- numeric(num_simulations)
total_DG_VCRC_DRC_opex_results <- numeric(num_simulations)
total_VCRC_DRC_batterycost_results <- numeric(num_simulations)
total_VCRC_DRC_totalcost_results <- numeric(num_simulations)
total_VCRC_DRC_gridpower_benefit <- numeric(num_simulations)

total_VCRC_opex_results <- numeric(num_simulations)
total_VCRC_capex_results <- numeric(num_simulations)
total_VCRC_totalVCRCcost_results <- numeric(num_simulations)
total_VCRC_DGopexcost_results <- numeric(num_simulations)
total_VCRC_envcost_results <- numeric(num_simulations)
total_VCRC_batterycost_results <- numeric(num_simulations)
total_VCRC_totalcost_results <- numeric(num_simulations)
total_VCRC_gridpower_benefit <- numeric(num_simulations)
### PV Systems

#total_PVSYS_NGA_opex_results <- numeric(num_simulations)
#total_PVSYS_NGA_capex_results <- numeric(num_simulations)
total_PVSYS_NGA_totalcost_results <- numeric(num_simulations)
total_PVSYS_NGA_envbenefit_results <- numeric(num_simulations)
total_PVSYS_NGA_eleccostaverted_results <- numeric(num_simulations)
total_PVSYS_NGA_fridgecost_results <- numeric(num_simulations)

#total_PVSYS_MWI_opex_results <- numeric(num_simulations)
#total_PVSYS_MWI_capex_results <- numeric(num_simulations)
total_PVSYS_MWI_totalcost_results <- numeric(num_simulations)
total_PVSYS_MWI_envbenefit_results <- numeric(num_simulations)
total_PVSYS_MWI_eleccostaverted_results <- numeric(num_simulations)
total_PVSYS_MWI_fridgecost_results <- numeric(num_simulations)

#total_PVSYS_DRC_opex_results <- numeric(num_simulations)
#total_PVSYS_DRC_capex_results <- numeric(num_simulations)
total_PVSYS_DRC_totalcost_results <- numeric(num_simulations)
total_PVSYS_DRC_envbenefit_results <- numeric(num_simulations)
total_PVSYS_DRC_eleccostaverted_results <- numeric(num_simulations)
total_PVSYS_DRC_fridgecost_results <- numeric(num_simulations)

#total_PVSYS_opex_results <- numeric(num_simulations)
#total_PVSYS_capex_results <- numeric(num_simulations)
total_PVSYS_totalcost_results <- numeric(num_simulations)
total_PVSYS_envbenefit_results <- numeric(num_simulations)
total_PVSYS_eleccostaverted_results <- numeric(num_simulations)
total_PVSYS_total_fridgecost_results <- numeric(num_simulations)

# Cost and Benefit calculation variables for Vaccination programs #
#Nigeria
vac_NGA_cost_results <- numeric(num_simulations)
vac_NGA_delivery_cost_results <- numeric(num_simulations)
vac_NGA_total_cost_results <- numeric(num_simulations)

vac_NGA_COI_results <- numeric(num_simulations)
vac_NGA_VSL_results <- numeric(num_simulations)
vac_NGA_VSLY_results <- numeric(num_simulations)

VCRC_NGA_NB_COI_results <- numeric(num_simulations)
VCRC_NGA_NB_VSL_results <- numeric(num_simulations)
VCRC_NGA_NB_VSLY_results <- numeric(num_simulations)

PVSYS_NGA_NB_COI_results <- numeric(num_simulations)
PVSYS_NGA_NB_VSL_results <- numeric(num_simulations)
PVSYS_NGA_NB_VSLY_results <- numeric(num_simulations)

#Malawi
vac_MWI_cost_results <- numeric(num_simulations)
vac_MWI_delivery_cost_results <- numeric(num_simulations)
vac_MWI_total_cost_results <- numeric(num_simulations)

vac_MWI_COI_results <- numeric(num_simulations)
vac_MWI_VSL_results <- numeric(num_simulations)
vac_MWI_VSLY_results <- numeric(num_simulations)

VCRC_MWI_NB_COI_results <- numeric(num_simulations)
VCRC_MWI_NB_VSL_results <- numeric(num_simulations)
VCRC_MWI_NB_VSLY_results <- numeric(num_simulations)

PVSYS_MWI_NB_COI_results <- numeric(num_simulations)
PVSYS_MWI_NB_VSL_results <- numeric(num_simulations)
PVSYS_MWI_NB_VSLY_results <- numeric(num_simulations)

#DRC
vac_DRC_cost_results <- numeric(num_simulations)
vac_DRC_delivery_cost_results <- numeric(num_simulations)
vac_DRC_total_cost_results <- numeric(num_simulations)

vac_DRC_COI_results <- numeric(num_simulations)
vac_DRC_VSL_results <- numeric(num_simulations)
vac_DRC_VSLY_results <- numeric(num_simulations)

VCRC_DRC_NB_COI_results <- numeric(num_simulations)
VCRC_DRC_NB_VSL_results <- numeric(num_simulations)
VCRC_DRC_NB_VSLY_results <- numeric(num_simulations)

PVSYS_DRC_NB_COI_results <- numeric(num_simulations)
PVSYS_DRC_NB_VSL_results <- numeric(num_simulations)
PVSYS_DRC_NB_VSLY_results <- numeric(num_simulations)

#Overall
vac_cost_results <- numeric(num_simulations)
vac_delivery_cost_results <- numeric(num_simulations)
vac_total_cost_results <- numeric(num_simulations)

vac_COI_results <- numeric(num_simulations)
vac_VSL_results <- numeric(num_simulations)
vac_VSLY_results <- numeric(num_simulations)

VCRC_NB_COI_results <- numeric(num_simulations)
VCRC_NB_VSL_results <- numeric(num_simulations)
VCRC_NB_VSLY_results <- numeric(num_simulations)

PVSYS_NB_COI_results <- numeric(num_simulations)
PVSYS_NB_VSL_results <- numeric(num_simulations)
PVSYS_NB_VSLY_results <- numeric(num_simulations)

################## Death averted due to vaccination programs ##################################################################
#Death Averted
NGA_death_averted <- matrix(ncol = 21, nrow = vac_estimation_length)
colnames(NGA_death_averted) <- c("NGA_HepA&HiB","NGA_HepA&HiB_Lo","NGA_HepA&HiB_Hi", "NGA_HPV","NGA_HPV_Lo","NGA_HPV_Hi","NGA_MR","NGA_MR_Lo","NGA_MR_Hi","NGA_PCV","NGA_PCV_Lo","NGA_PCV_Hi","NGA_Meningitis","NGA_Meningitis_Lo","NGA_Meningitis_Hi","NGA_Rotavirus","NGA_Rotavirus_Lo","NGA_Rotavirus_Hi","NGA_YF","NGA_YF_Lo","NGA_YF_Hi")
NGA_death_averted [,1] <- c(22201.065,23404.355,24697.123,25978.356,27177.682,28200.47,29149.332,30069.398,30473.614,30598.457) 
NGA_death_averted [,2] <- c(12171.839,12771.282,13340.176,13866.437,14315.008,14578.239,14781.009,15001.932,15023.344,14887.041) 
NGA_death_averted [,3] <- c(46504.125,49183.075,52070.4,55024.075,57952.575,60710.3,63472.175,66159.925,67594.55,68358.925)
NGA_death_averted [,4] <- c(0,0,0,0.056,0.125,0.202,0.284,0.369,2.155,4.176)
NGA_death_averted [,5] <- c(0,0,0,0,0,0,0,0,0.415,0.843)
NGA_death_averted [,6] <- c(0,0,0,0.14,0.309,0.501,0.705,0.915,3.5,6.756)
NGA_death_averted [,7] <- c(129552.319,173369.126,170165.006,182282.108,174131.624,189669.35,184048.361,187878.741,194340.917,189635.397)
NGA_death_averted [,8] <- c(29144.326,31881.756,33384.249,30333.47,27265.317,38648.136,27142.68,12390.565,20828.343,21245.245)
NGA_death_averted [,9] <- c(381008.917,374491.041,380820.562,378246.755,347531.194,366577.812,363671.996,368539.304,390161.871,348700.271)
NGA_death_averted [,10] <- c(19147.929,20008.154,20958.832,21917.889,22850.852,23718.701,24491.943,25185.909,25612.318,25902.99)
NGA_death_averted [,11] <- c(10237.975,10719,11298,11888.95,12478.975,13029,13568.975,14105,14413,14606.975)
NGA_death_averted [,12] <- c(28173.95,29532.725,31150.6,32825.575,34487.45,36058.4,37591.3,39125.05,40037.675,40620.975)
NGA_death_averted [,13] <- c(3670.207,4014.163,4813.905,4928.905,3915.669,4292.539,4168.656,3379.456,3517.726,3495.59)
NGA_death_averted [,14] <- c(0,0,0,0,0,0,0,-343.1,-5931.35,-14929.075)
NGA_death_averted [,15] <- c(23325.515,27036.199,28988.219,30197.712,25258.328,30165.329,28279.052,23386.835,28889.563,32034.299)
NGA_death_averted [,16] <- c(0,7202.344,12971.705,15149.7,16551.413,17618.101,18463.538,19195.507,19847.734,20257.197)
NGA_death_averted [,17] <- c(0,3264.507,5161.055,6093.665,6692.634,7116.625,7437.946,7690.158,7894.329,8063.662)
NGA_death_averted [,18] <- c(0,12046.816,22150.757,25467.461,27697.47,29455.871,30920.451,32224.267,33417.84,34082.945)
NGA_death_averted [,19] <- c(17620.595,18743.755,19251.703,19864.908,20574.708,21143.845,21647.213,22258.743,22959.5,23497.303)
NGA_death_averted [,20] <- c(2447.8,2567.425,2655.275,2741.05,2812.675,2875.8,2951.35,3029.2,3104.1,3176.875)
NGA_death_averted [,21] <- c(36984.225,39684.05,40617.1,41536.35,42125.675,45806.15,45966.7,45672.35,47632.525,48415.775)

NGA_death_averted <- as.data.frame(NGA_death_averted)

MWI_death_averted <- matrix(ncol = 21, nrow = vac_estimation_length)
colnames(MWI_death_averted) <- c("MWI_HepA&HiB","MWI_HepA&HiB_Lo","MWI_HepA&HiB_Hi", "MWI_HPV","MWI_HPV_Lo","MWI_HPV_Hi","MWI_MR","MWI_MR_Lo","MWI_MR_Hi","MWI_PCV","MWI_PCV_Lo","MWI_PCV_Hi","MWI_Meningitis","MWI_Meningitis_Lo","MWI_Meningitis_Hi","MWI_Rotavirus","MWI_Rotavirus_Lo","MWI_Rotavirus_Hi","MWI_YF","MWI_YF_Lo","MWI_YF_Hi")
MWI_death_averted [,1] <- c(1077.231,1072.919,1069.438,1066.62,1066.048,1062.504,1059.123,1057.434,1052.022,1044.367) 
MWI_death_averted [,2] <- c(694,695,691,693,694.975,690.772,676.791,659.515,639.658,623.989) 
MWI_death_averted [,3] <- c(1617.368,1597.861,1579.118,1562.341,1544.402,1552.49,1567.785,1584.737,1595.958,1596.737)
MWI_death_averted [,4] <- c(0,0,0,0.127,0.276,0.434,0.596,0.758,2.345,4.188)
MWI_death_averted [,5] <- c(0,0,0,0,0,0,0,0,0,0)
MWI_death_averted [,6] <- c(0,0,0,0.301,0.65,1.025,1.406,1.789,5.533,9.884)
MWI_death_averted [,7] <- c(13179.829,13553.483,13119.925,14036.757,14393.671,14541.215,14480.185,15312.068,15228.268,15559.174)
MWI_death_averted [,8] <- c(2522.649,3054.817,2686.845,3436.112,3507.954,3322.278,3538.522,3108.366,3065.023,2970.905)
MWI_death_averted [,9] <- c(20625.268,21205.896,21358.491,22091.096,22592.042,22791.621,23490.408,24334.104,24224.668,24930.983)
MWI_death_averted [,10] <- c(970.118,954.57,939.914,924.756,910.587,894.21,877.399,858.707,838.543,813.593)
MWI_death_averted [,11] <- c(970.118,954.57,939.914,924.756,910.587,894.21,877.399,858.707,838.543,813.593)
MWI_death_averted [,12] <- c(970.118,954.57,939.914,924.756,910.587,894.21,877.399,858.707,838.543,813.593)
MWI_death_averted [,13] <- c(0,0,0,0,0,0,0,0,0,0)
MWI_death_averted [,14] <- c(0,0,0,0,0,0,0,0,0,0)
MWI_death_averted [,15] <- c(0,0,0,0,0,0,0,0,0,0)
MWI_death_averted [,16] <- c(417.014,415.377,414.456,413.042,411.266,408.409,402.798,397.764,392.608,387.725)
MWI_death_averted [,17] <- c(310.164,318.195,326.738,334.873,342.062,349.466,351.889,350.801,338.416,325.548)
MWI_death_averted [,18] <- c(568.572,554.84,542.103,528.825,515.906,500.335,484.386,470.795,454.976,443.566)
MWI_death_averted [,19] <- c(0,0,0,0,0,0,0,0,0,0)
MWI_death_averted [,20] <- c(0,0,0,0,0,0,0,0,0,0)
MWI_death_averted [,21] <- c(0,0,0,0,0,0,0,0,0,0)

MWI_death_averted <- as.data.frame(MWI_death_averted)


DRC_death_averted <- matrix(ncol = 21, nrow = vac_estimation_length)
colnames(DRC_death_averted) <- c("DRC_HepA&HiB","DRC_HepA&HiB_Lo","DRC_HepA&HiB_Hi", "DRC_HPV","DRC_HPV_Lo","DRC_HPV_Hi","DRC_MR","DRC_MR_Lo","DRC_MR_Hi","DRC_PCV","DRC_PCV_Lo","DRC_PCV_Hi","DRC_Meningitis","DRC_Meningitis_Lo","DRC_Meningitis_Hi","DRC_Rotavirus","DRC_Rotavirus_Lo","DRC_Rotavirus_Hi","DRC_YF","DRC_YF_Lo","DRC_YF_Hi")
DRC_death_averted [,1] <- c(12337.441,12522.571,12688.822,12898.31,13121.55,13301.526,13536.011,13751.708,13983.484,14232.35) 
DRC_death_averted [,2] <- c(7030.49,7083.191,7137.713,7193.32,7292.813,7387.513,7470.129,7509.307,7545.593,7664.95) 
DRC_death_averted [,3] <- c(27189.9,27658.675,28072.425,28634.475,29247.7,29700.95,30410.15,31039.475,31714.775,32447.825)
DRC_death_averted [,4] <- c(585.128,625.708,668.358,712.755,758.382,806.875,857.837,912.771,970.63,1032.325)
DRC_death_averted [,5] <- c(14.975,15,15.975,17,18,21,22,25.975,28,32.95)
DRC_death_averted [,6] <- c(1412.125,1462.725,1533.35,1604.175,1669.25,1716.4,1820.275,1914.45,1997.625,2083.4)
DRC_death_averted [,7] <- c(73733.57,89389.616,92587.521,96526.951,97791.151,100450.747,101981.076,104662.547,106853.144,109849.679)
DRC_death_averted [,8] <- c(40164.997,74858.94,77228.425,80672.558,80011.958,83681.798,85505.731,88470.53,88575.732,92251.937)
DRC_death_averted [,9] <- c(99484.232,104048.904,107341.116,113405.704,115913.374,117549.506,119643.103,122206.192,125214.256,129246.038)
DRC_death_averted [,10] <- c(11699.527,11892.21,11991.905,12105.751,12214.109,12265.252,12366.469,12446.622,12538.92,12645.398)
DRC_death_averted [,11] <- c(5940.998,6058.386,6089.898,6101.501,6108.616,6106.667,6102.429,6098.02,6100.785,6157.561)
DRC_death_averted [,12] <- c(18610.2,19007.375,19228.45,19510.525,19787.725,19922.75,20206.75,20436.875,20700.85,21004.025)
DRC_death_averted [,13] <- c(0,0,0,0,0,0,0,0,0,0)
DRC_death_averted [,14] <- c(0,0,0,0,0,0,0,0,0,0)
DRC_death_averted [,15] <- c(0,0,0,0,0,0,0,0,0,0)
DRC_death_averted [,16] <- c(0,993.046,2475.381,3732.478,4230.58,4571.495,4834.215,5054.333,5245.203,5415.372)
DRC_death_averted [,17] <- c(0,0,1829.386,2906.131,3189.149,3392.869,3550.371,3675.641,3778.271,3864.843)
DRC_death_averted [,18] <- c(0,2280.002,3348.829,4375.251,5072.05,5548.534,5916.512,6233.515,6516.338,6774.897)
DRC_death_averted [,19] <- c(22780.333,26533.058,27988.945,29012.805,29721.858,30465.483,31210.47,31959.77,32711.125,33483.318)
DRC_death_averted [,20] <- c(234,829,959.775,989.45,1044.5,1016.925,1142.575,1178.95,1163.575,1181.975)
DRC_death_averted [,21] <- c(81023.75,92673.3,97518.875,101016.075,103450.575,105947.575,108479.425,111045.325,113639.5,116274.45)

DRC_death_averted <- as.data.frame(DRC_death_averted)

################## Disability Adjusted Life Yrs averted due to vaccination programs #############################################
#DALY Averted

NGA_DALY_averted <- matrix(ncol = 21, nrow = vac_estimation_length)
colnames(NGA_DALY_averted) <- c("NGA_HepA&HiB","NGA_HepA&HiB_Lo","NGA_HepA&HiB_Hi", "NGA_HPV","NGA_HPV_Lo","NGA_HPV_Hi","NGA_MR","NGA_MR_Lo","NGA_MR_Hi","NGA_PCV","NGA_PCV_Lo","NGA_PCV_Hi","NGA_Meningitis","NGA_Meningitis_Lo","NGA_Meningitis_Hi","NGA_Rotavirus","NGA_Rotavirus_Lo","NGA_Rotavirus_Hi","NGA_YF","NGA_YF_Lo","NGA_YF_Hi")
NGA_DALY_averted [,1] <- c(1467654.468,1555628.872,1649568.914,1744357.959,1849762.454,1936986.185,2018192.674,2097376.813,2146277.133,2190615.306)
NGA_DALY_averted [,2] <- c(714274.579,752512.516,788986.26,822629.996,865918.443,889290.399,907754.4,925595.22,931523.588,942102.126)
NGA_DALY_averted [,3] <- c(3132933.043,3337017.413,3559559.323,3790073.716,4032333.949,4250363.463,4453167.794,4665234.257,4818084.227,4941628.294)
NGA_DALY_averted [,4] <- c(0,0,0,3.879,8.512,13.746,19.053,24.573,120.981,229.721)
NGA_DALY_averted [,5] <- c(0,0,0,0.191,0.404,0.658,0.823,1.056,22.99,45.536)
NGA_DALY_averted [,6] <- c(0,0,0,8.602,18.923,30.554,42.745,55.145,194.46,371.688)
NGA_DALY_averted [,7] <- c(7460619.469,9979866.751,9797541.459,10566230.812,10333585.908,11247880.273,10919883.19,11150770.215,11533125.014,11498887.748)
NGA_DALY_averted [,8] <- c(1667452.653,1840692.324,1930329.057,1778699.047,1639604.573,2300231.613,1653156.923,786445.628,1264797.412,1383764.216)
NGA_DALY_averted [,9] <- c(21978399.154,21599219.605,21986117.053,22022048.944,20680305.935,21796010.994,21625893.567,21923747.394,23196763.094,21163274.195)
NGA_DALY_averted [,10] <- c(1097317.026,1150455.547,1208964.156,1268317.394,1336276.549,1394391.959,1445017.161,1490792.207,1520895.06,1552703.869)
NGA_DALY_averted [,11] <- c(587252.249,617816.704,654396.548,691940.383,730003.66,765888.84,801357.273,836934.036,859164.665,874833.581)
NGA_DALY_averted [,12] <- c(1626079.106,1712604.631,1815399.129,1922686.679,2030199.548,2133190.228,2234646.278,2336818.676,2403075.719,2449722.465)
NGA_DALY_averted [,13] <- c(220235.099,243128.026,289497.294,294921.869,238850.553,258447.644,252143.111,205669.124,211786.056,208554.061)
NGA_DALY_averted [,14] <- c(32.55,22.9,1.95,14.625,11.7,0,0,-18499.725,-357440.975,-902850.775)
NGA_DALY_averted [,15] <- c(1373049.489,1633009.07,1673225.568,1745268.086,1554919.193,1781870.933,1620553.598,1348509.861,1690027.025,1944602.016)
NGA_DALY_averted [,16] <- c(-40.837,305391.1,540840.768,634047.642,712913.163,761697.121,800201.815,832658.637,861339.109,898955.295)
NGA_DALY_averted [,17] <- c(-3050.006,182717.073,291797.798,345990.57,388758.321,415035.892,433900.99,448649.611,460594.309,479813.548)
NGA_DALY_averted [,18] <- c(2840.756,458425.933,824218.631,949238.274,1064929.771,1146123.927,1206979.158,1259887.499,1308418.762,1366625.213)
NGA_DALY_averted [,19] <- c(864361.32,908003.292,924643.406,960881.587,1002460.063,1029382.866,1040982.907,1063365.041,1099417.773,1137382.47)
NGA_DALY_averted [,20] <- c(133676.525,133411.125,135342.125,146586.275,147803.5,154704,151880.525,151804.775,162950.725,164315.375)
NGA_DALY_averted [,21] <- c(1803978.665,1906491.969,1953637.899,1985643.081,2098846.016,2222879.94,2199514.454,2175121.568,2251374.702,2346426.489)

NGA_DALY_averted <- as.data.frame(NGA_DALY_averted)

MWI_DALY_averted <- matrix(ncol = 21, nrow = vac_estimation_length)
colnames(MWI_DALY_averted) <- c("MWI_HepA&HiB","MWI_HepA&HiB_Lo","MWI_HepA&HiB_Hi", "MWI_HPV","MWI_HPV_Lo","MWI_HPV_Hi","MWI_MR","MWI_MR_Lo","MWI_MR_Hi","MWI_PCV","MWI_PCV_Lo","MWI_PCV_Hi","MWI_Meningitis","MWI_Meningitis_Lo","MWI_Meningitis_Hi","MWI_Rotavirus","MWI_Rotavirus_Lo","MWI_Rotavirus_Hi","MWI_YF","MWI_YF_Lo","MWI_YF_Hi")
MWI_DALY_averted [,1] <- c(81139.792,81401.567,81659.02,81962.009,83098.212,83437.25,83638.234,83838.327,83796.413,84033.047)
MWI_DALY_averted [,2] <- c(48879.96,49239.51,49315.003,49601.181,49480.769,48482.054,47389.23,46196.818,44970.577,44464.952)
MWI_DALY_averted [,3] <- c(132704.077,132425.537,132089.512,131671.057,133386.422,134178.775,135511.106,137333.884,138413.529,139936.95)
MWI_DALY_averted [,4] <- c(0,0,0,8.425,18.128,28.409,38.74,49.024,154.453,274.741)
MWI_DALY_averted [,5] <- c(0,0,0,0,0,0,0,0,6.338,12.006)
MWI_DALY_averted [,6] <- c(0,0,0,19.874,42.762,67.014,91.383,115.641,351.462,623.116)
MWI_DALY_averted [,7] <- c(873950.456,898383.619,870574.603,930294.949,974987.918,984893.804,981253.913,1036457.72,1031195.961,1072927.198)
MWI_DALY_averted [,8] <- c(164099.515,198753.336,174064.648,222969.493,232303.993,219628.407,233971.79,206452.642,202274.205,199961.858)
MWI_DALY_averted [,9] <- c(1381209.01,1415816.534,1432394.185,1472333.794,1538672.858,1561392.213,1609808.609,1640588.91,1645338.664,1727463.127)
MWI_DALY_averted [,10] <- c(65745.294,64947.11,64158.702,63319.543,63219.544,62439.099,61479.67,60357.688,59108.825,58008.254)
MWI_DALY_averted [,11] <- c(18705.246,18670.843,18632.962,18520.293,18472.913,18421.515,18295.59,18169.196,17963.151,17475.991)
MWI_DALY_averted [,12] <- c(111883.034,109624.212,107352.647,104984.366,104460.83,102042.497,97207.17,94256.824,90913.708,89159.68)
MWI_DALY_averted [,13] <- c(0,0,0,0,0,0,0,0,0,0)
MWI_DALY_averted [,14] <- c(0,0,0,0,0,0,0,0,0,0)
MWI_DALY_averted [,15] <- c(0,0,0,0,0,0,0,0,0,0)
MWI_DALY_averted [,16] <- c(24300.151,24118.018,23977.431,23803.995,24215.193,23948.2,23557.214,23161.798,22760.939,22853.955)
MWI_DALY_averted [,17] <- c(13822.335,14187.035,14579.874,14946.854,15674.658,15954.359,16133.841,16274.431,16425.779,16955.591)
MWI_DALY_averted [,18] <- c(37662.42,36779.922,35965.823,35114.263,35117.55,34175.662,33232.61,32286.025,31196.756,30816.73)
MWI_DALY_averted [,19] <- c(0,0,0,0,0,0,0,0,0,0)
MWI_DALY_averted [,20] <- c(0,0,0,0,0,0,0,0,0,0)
MWI_DALY_averted [,21] <- c(0,0,0,0,0,0,0,0,0,0)

MWI_DALY_averted <- as.data.frame(MWI_DALY_averted)

DRC_DALY_averted <- matrix(ncol = 21, nrow = vac_estimation_length)
colnames(DRC_DALY_averted) <- c("DRC_HepA&HiB","DRC_HepA&HiB_Lo","DRC_HepA&HiB_Hi", "DRC_HPV","DRC_HPV_Lo","DRC_HPV_Hi","DRC_MR","DRC_MR_Lo","DRC_MR_Hi","DRC_PCV","DRC_PCV_Lo","DRC_PCV_Hi","DRC_Meningitis","DRC_Meningitis_Lo","DRC_Meningitis_Hi","DRC_Rotavirus","DRC_Rotavirus_Lo","DRC_Rotavirus_Hi","DRC_YF","DRC_YF_Lo","DRC_YF_Hi")
DRC_DALY_averted [,1] <- c(812023.843,827986.614,842671.869,860279.854,883690.68,900933.828,920807.097,939330.301,958851.594,984008.841)
DRC_DALY_averted [,2] <- c(445070.188,453412.931,458845.811,462550.533,472637.147,477697.306,484625.693,495184.228,506434.627,518577.689)
DRC_DALY_averted [,3] <- c(1812527.565,1855500.597,1894727.973,1943146.491,1997603.686,2041723.404,2098832.508,2151744.3,2209225.622,2272370.301)
DRC_DALY_averted [,4] <- c(63678.795,68220.005,72911.802,77887.266,83468.673,88953.103,94592.799,100450.302,106491.774,113157.609)
DRC_DALY_averted [,5] <- c(2328.75,2475.425,2620.7,2818,3163.725,3620.15,4227.05,4736.75,5188.775,5729.7)
DRC_DALY_averted [,6] <- c(167423,177138.25,187561.575,197557.925,209746,220602.6,231571.85,242577.125,254417.375,268152.325)
DRC_DALY_averted [,7] <- c(4721715.187,5717089.193,5920978.97,6190505.681,6379289.785,6552177.521,6652787.828,6828131.197,6970892.99,7276198.261)
DRC_DALY_averted [,8] <- c(2596410.44,4801745.934,4919829.542,5149587.977,5188198.617,5429114.714,5569527.693,5757997.844,5774440.294,6089162.928)
DRC_DALY_averted [,9] <- c(6351368.935,6657652.558,6868396.813,7286970.177,7588205.085,7704292.366,7843093.421,8010878.19,8208886.033,8578530.997)
DRC_DALY_averted [,10] <- c(744024.053,758759.277,767306.71,776649.855,790041.583,796566.199,805327.781,812582.088,820551.79,833534.243)
DRC_DALY_averted [,11] <- c(744024.053,758759.277,767306.71,776649.855,790041.583,796566.199,805327.781,812582.088,820551.79,833534.243)
DRC_DALY_averted [,12] <- c(744024.053,758759.277,767306.71,776649.855,790041.583,796566.199,805327.781,812582.088,820551.79,833534.243)
DRC_DALY_averted [,13] <- c(0,0,0,0,0,0,0,0,0,0)
DRC_DALY_averted [,14] <- c(0,0,0,0,0,0,0,0,0,0)
DRC_DALY_averted [,15] <- c(0,0,0,0,0,0,0,0,0,0)
DRC_DALY_averted [,16] <- c(-19.529,61486.327,133715.388,192395.344,221401.551,239409.04,253333.52,264853.565,274784.67,288479.773)
DRC_DALY_averted [,17] <- c(-1456.652,0,73238.709,154618.034,184543.497,203009.905,217521.778,228307.507,236115.236,249029.639)
DRC_DALY_averted [,18] <- c(1352.05,140616.183,207178.627,242915.247,271849.079,290079.332,303768.853,317213.441,326253.265,340385.325)
DRC_DALY_averted [,19] <- c(1269105.822,1473664.507,1516696.91,1543961.611,1589052.661,1661093.027,1728056.325,1724747.143,1732220.87,1779291.296)
DRC_DALY_averted [,20] <- c(14672.15,43028.46,49605.722,48422.066,53523.612,53313.058,56232.406,60015.22,58459.496,61245.369)
DRC_DALY_averted [,21] <- c(4528825.375,5180109.175,5324003.05,5417717.8,5565299.05,5818465.475,6053042.375,6036854.5,6060523.025,6222897.75)

DRC_DALY_averted <- as.data.frame(DRC_DALY_averted)

############################## MC Loop #########################################################################################

for(j in 1:num_simulations){
#Start of MC simulation loop

#################################################################################################################################
######################## DEMOGRAPH CALCULATIONS #################################################################################
#################################################################################################################################  

###################### Vaccine Coverage rate inputs #############################################################################

#Vaccine coverage rate; source: WHO Immunization data
vac_coverage_NGA_HepA_Hib <- 0.62 
vac_coverage_MWI_HepA_Hib <- 0.86
vac_coverage_DRC_HepA_Hib <- 0.65

vac_coverage_NGA_HPV <- 0.76 #(Rate ramped from 0 to 76% in 4 yrs from 2023) 
vac_coverage_MWI_HPV <- 0.76 #(Rate ramped from 12 to 76% in 4 yrs from 2021)
vac_coverage_DRC_HPV <- 0.76 #(Rate ramped from 0 to 76% in 4 yrs from 2023)

vac_coverage_NGA_MR <- 0.60 
vac_coverage_MWI_MR <- 0.82
vac_coverage_DRC_MR <- 0.56

vac_coverage_NGA_PCV <- 0.60 
vac_coverage_MWI_PCV <- 0.87
vac_coverage_DRC_PCV <- 0.64

vac_coverage_NGA_MenA <- 0.55 
vac_coverage_MWI_MenA <- 0.00
vac_coverage_DRC_MenA <- 0.00

vac_coverage_NGA_Rota <- 0.60 #(Rate ramped from 0 to 60% in 4 yrs from 2022)
vac_coverage_MWI_Rota <- 0.85 
vac_coverage_DRC_Rota <- 0.59 

vac_coverage_NGA_YF <- 0.55 
vac_coverage_MWI_YF <- 0.00
vac_coverage_DRC_YF <- 0.59

#################### Vaccine Buffer storage rate inputs ##########################################################################
#Vaccine buffer quantity 0 to 25% (Patenaude et al., 2023)
vac_buffer_NGA_HepA_Hib <- sample(c(0, 0.25), size = 1)
vac_buffer_MWI_HepA_Hib <- sample(c(0, 0.25), size = 1)
vac_buffer_DRC_HepA_Hib <- sample(c(0, 0.25), size = 1)

vac_buffer_NGA_HPV <- sample(c(0, 0.25), size = 1)
vac_buffer_MWI_HPV <- sample(c(0, 0.25), size = 1)
vac_buffer_DRC_HPV <- sample(c(0, 0.25), size = 1)

vac_buffer_NGA_MR <- sample(c(0, 0.25), size = 1)
vac_buffer_MWI_MR <- sample(c(0, 0.25), size = 1)
vac_buffer_DRC_MR <- sample(c(0, 0.25), size = 1)

vac_buffer_NGA_PCV <- sample(c(0, 0.25), size = 1)
vac_buffer_MWI_PCV <- sample(c(0, 0.25), size = 1)
vac_buffer_DRC_PCV <- sample(c(0, 0.25), size = 1)

vac_buffer_NGA_MenA <- sample(c(0, 0.25), size = 1)
vac_buffer_MWI_MenA <- sample(c(0, 0.25), size = 1)
vac_buffer_DRC_MenA <- sample(c(0, 0.25), size = 1)

vac_buffer_NGA_Rota <- sample(c(0, 0.25), size = 1)
vac_buffer_MWI_Rota <- sample(c(0, 0.25), size = 1)
vac_buffer_DRC_Rota <- sample(c(0, 0.25), size = 1)

vac_buffer_NGA_YF <- sample(c(0, 0.25), size = 1)
vac_buffer_MWI_YF <- sample(c(0, 0.25), size = 1)
vac_buffer_DRC_YF <- sample(c(0, 0.25), size = 1)

##################### Vaccine Spoilage rates inputs ###########################################################################
#Vaccination spoilage rate; source : GAVI Detailed Product Profiles (DPPs) for WHO prequalified vaccines
vac_spoilage_NGA_HepA_Hib <- 0.05
vac_spoilage_MWI_HepA_Hib <- 0.05
vac_spoilage_DRC_HepA_Hib <- 0.05

vac_spoilage_NGA_HPV <- 0.07
vac_spoilage_MWI_HPV <- 0.07
vac_spoilage_DRC_HPV <- 0.07

vac_spoilage_NGA_MR <- 0.25
vac_spoilage_MWI_MR <- 0.25
vac_spoilage_DRC_MR <- 0.25

vac_spoilage_NGA_PCV <- 0.08
vac_spoilage_MWI_PCV <- 0.08
vac_spoilage_DRC_PCV <- 0.08

vac_spoilage_NGA_MenA <- 0.40
vac_spoilage_MWI_MenA <- 0.40
vac_spoilage_DRC_MenA <- 0.40

vac_spoilage_NGA_Rota <- 0.06
vac_spoilage_MWI_Rota <- 0.06
vac_spoilage_DRC_Rota <- 0.06

vac_spoilage_NGA_YF <- 0.25
vac_spoilage_MWI_YF <- 0.25
vac_spoilage_DRC_YF <- 0.25



##################### Vaccine Recommended doses inputs ###########################################################################
#Recommended number of doses; source: WHO, CDC, GAVI
vac_recommended_dose_HepA_Hib <- 3
vac_recommended_dose_HPV <- 2
vac_recommended_dose_MR <- 2
vac_recommended_dose_PCV <- 3
vac_recommended_dose_MenA <- 1
vac_recommended_dose_Rota <- 3
vac_recommended_dose_Rota_MWI <- 2
vac_recommended_dose_YF <- 1

#################### Population calculations #####################################################################################

#Nigeria#
Nigeria_pop <- matrix(ncol = 7, nrow = vac_estimation_length)

colnames(Nigeria_pop) <- c("Year", "Nigeria_Tot_Pop(million)", "Nigeria_CBR", "Nigeria_Pop_growth%", "Nigeria_New_born(million)","Nigeria_Female_10to14_growth%","Nigeria_Female_10to14(million)")
Nigeria_pop_baseyr <- 213.401322 #(in million) (sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Nigeria_pop_GR <- 0.0241 #(2021 % sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Nigeria_fem_age10to14_baseyr <- 13.2494365 #(in million) (sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Nigeria_fem_GR <- 0.0265883 #(2021 % sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Nigeria_CBR <- 37.117 #Crude Birth Rate per 1000 people sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

for (i in 1:vac_estimation_length){
  Nigeria_pop [i,1] = population_base_year + i - 1
  Nigeria_pop [i,3] = Nigeria_CBR
  Nigeria_pop [i,4] = Nigeria_pop_GR
  Nigeria_pop [i,2] = Nigeria_pop_baseyr*(1+Nigeria_pop[i,4])^(i-1)
  Nigeria_pop [i,5] = Nigeria_pop[i,3]/1000*Nigeria_pop[i,2]
  Nigeria_pop [i,6] = Nigeria_fem_GR
  Nigeria_pop [i,7] = Nigeria_fem_age10to14_baseyr*(1+Nigeria_pop[i,6])^(i-1)
}

Nigeria_pop <- as.data.frame(Nigeria_pop)

#Malawi#
Malawi_pop <- matrix(ncol = 7, nrow = vac_estimation_length)

colnames(Malawi_pop) <- c("Year", "Malawi_Tot_Pop(million)", "Malawi_CBR", "Malawi_Pop_growth%", "Malawi_New_born(million)","Malawi_Female_10to14_growth%","Malawi_Female_10to14(million)")
Malawi_pop_baseyr <- 19.889742 #(in million) (sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Malawi_pop_GR <- 0.026114 #(2021 % sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Malawi_fem_age10to14_baseyr <- 1.357462 #(in million) (sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Malawi_fem_GR <- 0.015728 #(2021 % sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Malawi_CBR <- 32.859 #Crude Birth Rate per 1000 people sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

for (i in 1:vac_estimation_length){
  Malawi_pop [i,1] = population_base_year + i - 1
  Malawi_pop [i,3] = Malawi_CBR
  Malawi_pop [i,4] = Malawi_pop_GR
  Malawi_pop [i,2] = Malawi_pop_baseyr*(1+Malawi_pop[i,4])^(i-1)
  Malawi_pop [i,5] = Malawi_pop[i,3]/1000*Malawi_pop[i,2]
  Malawi_pop [i,6] = Malawi_fem_GR
  Malawi_pop [i,7] = Malawi_fem_age10to14_baseyr*(1+Malawi_pop[i,6])^(i-1)
}
Malawi_pop <- as.data.frame(Malawi_pop)

#DRC#
DRC_pop <- matrix(ncol = 7, nrow = vac_estimation_length)

colnames(DRC_pop) <- c("Year", "DRC_Tot_Pop(million)", "DRC_CBR", "DRC_Pop_growth%", "DRC_New_born(million)","DRC_Female_10to14_growth%","DRC_Female_10to14(million)")
DRC_pop_baseyr <- 95.894119 #(in million) (sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

DRC_pop_GR <- 0.032225 #(2021 % sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

DRC_fem_age10to14_baseyr <- 6.085013 #(in million) (sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

DRC_fem_GR <- 0.0400456 #(2021 % sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

DRC_CBR <- 42.049 #Crude Birth Rate per 1000 people sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

for (i in 1:vac_estimation_length){
  DRC_pop [i,1] = population_base_year + i - 1
  DRC_pop [i,3] = DRC_CBR
  DRC_pop [i,4] = DRC_pop_GR
  DRC_pop [i,2] = DRC_pop_baseyr*(1+DRC_pop[i,4])^(i-1)
  DRC_pop [i,5] = DRC_pop[i,3]/1000*DRC_pop[i,2]
  DRC_pop [i,6] = DRC_fem_GR
  DRC_pop [i,7] = DRC_fem_age10to14_baseyr*(1+DRC_pop[i,6])^(i-1)
} 
DRC_pop <- as.data.frame(DRC_pop)


############### Calculations for Number of Vaccine doses #########################################################################
## Number of Vaccination doses ##

Nigeria_DG_vac_doses <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(Nigeria_DG_vac_doses) <- c("NGA_HepA&HiB", "NGA_HPV","NGA_MR","NGA_PCV","NGA_Meningitis","NGA_Rotavirus","NGA_YF")

Malawi_DG_vac_doses <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(Malawi_DG_vac_doses) <- c("MWI_HepA&HiB", "MWI_HPV","MWI_MR","MWI_PCV","MWI_Meningitis","MWI_Rotavirus","MWI_YF")

DRC_DG_vac_doses <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(DRC_DG_vac_doses) <- c("DRC_HepA&HiB", "DRC_HPV","DRC_MR","DRC_PCV","DRC_Meningitis","DRC_Rotavirus","DRC_YF")

for (i in 1:vac_estimation_length){

#HepA_HiB#

  Nigeria_DG_vac_doses [i,1] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_HepA_Hib)*vac_recommended_dose_HepA_Hib*(1+vac_buffer_NGA_HepA_Hib)*(1+vac_spoilage_NGA_HepA_Hib)
  
  Malawi_DG_vac_doses [i,1] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_HepA_Hib)*vac_recommended_dose_HepA_Hib*(1+vac_buffer_MWI_HepA_Hib)*(1+vac_spoilage_MWI_HepA_Hib)
  
  DRC_DG_vac_doses [i,1] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_HepA_Hib)*vac_recommended_dose_HepA_Hib*(1+vac_buffer_DRC_HepA_Hib)*(1+vac_spoilage_DRC_HepA_Hib)
  
#HPV#

  if (i %in% c(1, 2)) {
    vac_coverage_NGA_HPV_calc = 0
  } else if (i == 3) {
    vac_coverage_NGA_HPV_calc = 0.1407
  } else if (i == 4) {
    vac_coverage_NGA_HPV_calc = 0.1407 * 2
  } else if (i == 5) {
    vac_coverage_NGA_HPV_calc = 0.1407 * 3
  } else if (i > 5) {
    vac_coverage_NGA_HPV_calc = vac_coverage_NGA_HPV
  }

  Nigeria_DG_vac_doses[i, 2] = Nigeria_pop$`Nigeria_Female_10to14(million)`[i] * vac_coverage_NGA_HPV_calc * vac_recommended_dose_HPV * (1 + vac_buffer_NGA_HPV) * (1 + vac_spoilage_NGA_HPV)
  
  if (i ==1) {
    vac_coverage_MWI_HPV_calc = 0.12
  } else if (i == 2) {
    vac_coverage_MWI_HPV_calc = 0.1407
  } else if (i == 3) {
    vac_coverage_MWI_HPV_calc = 0.1407 * 2
  } else if (i == 4) {
    vac_coverage_MWI_HPV_calc = 0.1407 * 3
  } else if (i > 4) {
    vac_coverage_MWI_HPV_calc = vac_coverage_MWI_HPV
  }

  Malawi_DG_vac_doses[i, 2] = Malawi_pop$`Malawi_Female_10to14(million)`[i] * vac_coverage_MWI_HPV_calc * vac_recommended_dose_HPV * (1 + vac_buffer_MWI_HPV) * (1 + vac_spoilage_MWI_HPV)
  
  if (i %in% c(1, 2)) {
    vac_coverage_DRC_HPV_calc = 0
  } else if (i == 3) {
    vac_coverage_DRC_HPV_calc = 0.1407
  } else if (i == 4) {
    vac_coverage_DRC_HPV_calc = 0.1407 * 2
  } else if (i == 5) {
    vac_coverage_DRC_HPV_calc = 0.1407 * 3
  } else if (i > 5) {
    vac_coverage_DRC_HPV_calc = vac_coverage_DRC_HPV
  }

  DRC_DG_vac_doses[i, 2] = DRC_pop$`DRC_Female_10to14(million)`[i] * vac_coverage_DRC_HPV_calc * vac_recommended_dose_HPV * (1 + vac_buffer_DRC_HPV) * (1 + vac_spoilage_DRC_HPV)
  
#Measles and Rubella#

  Nigeria_DG_vac_doses [i,3] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_MR)*vac_recommended_dose_MR*(1+vac_buffer_NGA_MR)*(1+vac_spoilage_NGA_MR)
  
  Malawi_DG_vac_doses [i,3] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_MR)*vac_recommended_dose_MR*(1+vac_buffer_MWI_MR)*(1+vac_spoilage_MWI_MR)
  
  DRC_DG_vac_doses [i,3] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_MR)*vac_recommended_dose_MR*(1+vac_buffer_DRC_MR)*(1+vac_spoilage_DRC_MR)

#PCV#

  Nigeria_DG_vac_doses [i,4] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_PCV)*vac_recommended_dose_PCV*(1+vac_buffer_NGA_PCV)*(1+vac_spoilage_NGA_PCV)
  
  Malawi_DG_vac_doses [i,4] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_PCV)*vac_recommended_dose_PCV*(1+vac_buffer_MWI_PCV)*(1+vac_spoilage_MWI_PCV)
  
  DRC_DG_vac_doses [i,4] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_PCV)*vac_recommended_dose_PCV*(1+vac_buffer_DRC_PCV)*(1+vac_spoilage_DRC_PCV)


#Menningitis A#

  if (i == 1) {
    vac_coverage_NGA_MenA_calc = 0.5
  } else if (i > 1) {
    vac_coverage_NGA_MenA_calc = vac_coverage_NGA_MenA
  }

  Nigeria_DG_vac_doses[i, 5] = Nigeria_pop$`Nigeria_New_born(million)`[i] * vac_coverage_NGA_MenA_calc * vac_recommended_dose_MenA * (1 + vac_buffer_NGA_MenA) * (1 + vac_spoilage_NGA_MenA)
  
  Malawi_DG_vac_doses[i, 5] = Malawi_pop$`Malawi_New_born(million)`[i] * vac_coverage_MWI_MenA * vac_recommended_dose_MenA * (1 + vac_buffer_MWI_MenA) * (1 + vac_spoilage_MWI_MenA)
  
DRC_DG_vac_doses[i, 5] = DRC_pop$`DRC_New_born(million)`[i] * vac_coverage_DRC_MenA * vac_recommended_dose_MenA * (1 + vac_buffer_DRC_MenA) * (1 + vac_spoilage_DRC_MenA)
    
#Rota#

  if (i == 1) {
    vac_coverage_NGA_Rota_calc = 0
  } else if (i == 2) {
    vac_coverage_NGA_Rota_calc = 0.12
  } else if (i == 3) {
    vac_coverage_NGA_Rota_calc = 0.12*2
  } else if (i == 4) {
    vac_coverage_NGA_Rota_calc = 0.12*4
  } else if (i > 4) {
    vac_coverage_NGA_Rota_calc = vac_coverage_NGA_Rota
  }

  Nigeria_DG_vac_doses[i, 6] = Nigeria_pop$`Nigeria_New_born(million)`[i] * vac_coverage_NGA_Rota_calc * vac_recommended_dose_Rota * (1 + vac_buffer_NGA_Rota) * (1 + vac_spoilage_NGA_Rota)
  
  Malawi_DG_vac_doses[i, 6] = Malawi_pop$`Malawi_New_born(million)`[i] * vac_coverage_MWI_Rota * vac_recommended_dose_Rota_MWI * (1 + vac_buffer_MWI_Rota) * (1 + vac_spoilage_MWI_Rota)
  
  DRC_DG_vac_doses[i, 6] = DRC_pop$`DRC_New_born(million)`[i] * vac_coverage_DRC_Rota * vac_recommended_dose_Rota * (1 + vac_buffer_DRC_Rota) * (1 + vac_spoilage_DRC_Rota)

#Yellow Fever#

  Nigeria_DG_vac_doses [i,7] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_YF)*vac_recommended_dose_YF*(1+vac_buffer_NGA_YF)*(1+vac_spoilage_NGA_YF)
  
  Malawi_DG_vac_doses [i,7] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_YF)*vac_recommended_dose_YF*(1+vac_buffer_MWI_YF)*(1+vac_spoilage_MWI_YF)
  
  DRC_DG_vac_doses [i,7] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_YF)*vac_recommended_dose_YF*(1+vac_buffer_DRC_YF)*(1+vac_spoilage_DRC_YF)
}

Nigeria_DG_vac_doses <- as.data.frame(Nigeria_DG_vac_doses)
Malawi_DG_vac_doses <- as.data.frame(Malawi_DG_vac_doses)
DRC_DG_vac_doses <- as.data.frame(DRC_DG_vac_doses)
#################################################################################################################################

#################################################################################################################################
########################## COST CALCULATIONS ####################################################################################
#################################################################################################################################

####################### Diesel generator Costs inputs ###########################################################################

DG_upfront_cost_per_kW <- runif(1, 180, 200) #$/kW Olatomiwa et al. 2023 (https://www.mdpi.com/1996-1073/16/21/7259)
power_factor <- 0.8 #Power factor for typical diesel generators https://www.topone-power.com/power-factor-of-diesel-generator-sets/
DG_lifespan <- 15000 #hours Olatomiwa et al. (https://www.mdpi.com/1996-1073/16/21/7259)
diesel_consumption <- runif(1,0.2,0.4) #liter/hour/kW Olatomiwa et al. (https://www.mdpi.com/1996-1073/16/21/7259)
diesel_cost <- runif(1,0.7,1.25) # $/liter can range from $0.7/ ltr to $1.25 / ltr (https://www.nigerianstat.gov.ng/pdfuploads/AGO%20JANUARY%202022%20REPORT.pdf; https://www.arise.tv/petrol-price-in-nigeria-rose-by-230-78-in-one-year-says-nbs/#:~:text=On%20state%20profile%20analysis%2C%20the,by%20Katsina%20State%20at%20N771.)
dg_maintenance_cost <- runif(1, 0.05, 0.1) # $/kW/h Yakub et al. (Optimizing the performance of hybrid renewable energy systems to accelerate a sustainable energy transition in Nigeria: A case study of a rural healthcare centre in Kano)
diesel_emission_factor <- 2.676492 #kg/litre source: https://ghgprotocol.org/calculation-tools-and-guidance
global_social_cost_carbon <- runif(1,51,190) #$/ton CO2 source https://www.brookings.edu/articles/what-is-the-social-cost-of-carbon/


Avg_num_outage_NGA <- 32.8 #Average number of outages per month per facility in Nigeria (source World Bank: https://data.worldbank.org/indicator/IC.ELC.OUTG?locations=NG)
Avg_num_outage_MWI <- 6.7 #Average number of outages per month per facility in Nigeria (source World Bank: https://data.worldbank.org/indicator/IC.ELC.OUTG?locations=MW)
Avg_num_outage_DRC <- 12.3 #Average number of outages per month per facility in Nigeria (source World Bank: https://data.worldbank.org/indicator/IC.ELC.OUTG?locations=CD)

#outage data source: https://www.irena.org/-/media/Files/IRENA/Agency/Publication/2016/IRENA_Solar_PV_Costs_Africa_2016.pdf?rev=d3f8f61a82f14186ab6f8c20e7fa9e44
Avg_dur_outage_NGA <- runif(1,4,8) #Average duration of outages (hrs) per month per facility in Nigeria
Avg_dur_outage_MWI <- runif(1,4,8) #Average duration of outages (hrs) per month per facility in Malawi
Avg_dur_outage_DRC <- runif(1,4,8) #Average duration of outages (hrs) per month per facility in DRC

Total_Health_facilities_NGA <- 36428 #Total number of health facilities in Nigeria (Moner et al. 2021)
Total_Health_facilities_MWI <- 700 #Total number of health facilities in Malawi (Moner et al. 2021)
Total_Health_facilities_DRC <- 14746 #Total number of health facilities in DRC (Moner et al. 2021)

NEA_Health_facilities_NGA <- 13060 #Total number of health facilities with No access to electricity in Nigeria (Moner et al. 2021)
NEA_Health_facilities_MWI <- 353 #Total number of health facilities with No access to electricity in Malawi (Moner et al. 2021)
NEA_Health_facilities_DRC <- 9790 #Total number of health facilities with No access to electricity in DRC (Moner et al. 2021)

Health_facilities_NGA <- Total_Health_facilities_NGA - NEA_Health_facilities_NGA
Health_facilities_MWI <- Total_Health_facilities_MWI - NEA_Health_facilities_MWI
Health_facilities_DRC <- Total_Health_facilities_DRC - NEA_Health_facilities_DRC

NGA_perc_facilities_18 <- 0.96 #Percentage of Facilities with a demand of 1825 kWh/year, Nigeria
NGA_perc_facilities_73 <- 0.03 #Percentage of Facilities with a demand of 7300 kWh/year, Nigeria
NGA_perc_facilities_146 <- 0.01 #Percentage of Facilities with a demand of 14600 kWh/year, Nigeria
MWI_perc_facilities_18 <- 0.82 #Percentage of Facilities with a demand of 1825 kWh/year, Malawi
MWI_perc_facilities_73 <- 0.18 #Percentage of Facilities with a demand of 7300 kWh/year, Malawi
MWI_perc_facilities_146 <- 0.00 #Percentage of Facilities with a demand of 14600 kWh/year, Malawi
DRC_perc_facilities_18 <- 0.92 #Percentage of Facilities with a demand of 1825 kWh/year, DRC
DRC_perc_facilities_73 <- 0.08 #Percentage of Facilities with a demand of 7300 kWh/year, DRC
DRC_perc_facilities_146 <- 0.01 #Percentage of Facilities with a demand of 14600 kWh/year, DRC

################################ Cost calculations for DG sets ##########################

annual_outage_dur_NGA <- Avg_num_outage_NGA*Avg_dur_outage_NGA*12 #hours per year
annual_outage_dur_MWI <- Avg_num_outage_MWI*Avg_dur_outage_MWI*12 #hours per year
annual_outage_dur_DRC <- Avg_num_outage_DRC*Avg_dur_outage_DRC*12 #hours per year

NGA_num_facilities_18 <- NGA_perc_facilities_18*Health_facilities_NGA
NGA_num_facilities_73 <- NGA_perc_facilities_73*Health_facilities_NGA
NGA_num_facilities_146 <- NGA_perc_facilities_146*Health_facilities_NGA
MWI_num_facilities_18 <- MWI_perc_facilities_18*Health_facilities_MWI
MWI_num_facilities_73 <- MWI_perc_facilities_73*Health_facilities_MWI
MWI_num_facilities_146 <- MWI_perc_facilities_146*Health_facilities_MWI
DRC_num_facilities_18 <- DRC_perc_facilities_18*Health_facilities_DRC
DRC_num_facilities_73 <- DRC_perc_facilities_73*Health_facilities_DRC
DRC_num_facilities_146 <- DRC_perc_facilities_146*Health_facilities_DRC

NGA_kWh_healthfac <- NGA_num_facilities_18*1825 + NGA_num_facilities_73*7300 + NGA_num_facilities_146*14600
MWI_kWh_healthfac <- MWI_num_facilities_18*1825 + MWI_num_facilities_73*7300 + MWI_num_facilities_146*14600
DRC_kWh_healthfac <- DRC_num_facilities_18*1825 + DRC_num_facilities_73*7300 + DRC_num_facilities_146*14600

avg_kWh_per_fac_NGA <- NGA_kWh_healthfac/Health_facilities_NGA/8760 #kWh per hour
avg_kWh_per_fac_MWI <- MWI_kWh_healthfac/Health_facilities_MWI/8760 #kWh per hour
avg_kWh_per_fac_DRC <- DRC_kWh_healthfac/Health_facilities_DRC/8760 #kWh per hour

DG_kW_demand_NGA <- avg_kWh_per_fac_NGA*annual_outage_dur_NGA #kW per year per facility
DG_kW_demand_MWI <- avg_kWh_per_fac_MWI*annual_outage_dur_MWI #kW per year per facility
DG_kW_demand_DRC <- avg_kWh_per_fac_DRC*annual_outage_dur_DRC #kW per year per facility

Tot_DG_kW_demand_NGA <-  DG_kW_demand_NGA*Health_facilities_NGA#total kW per year Nigeria
Tot_DG_kW_demand_MWI <-  DG_kW_demand_MWI*Health_facilities_MWI#total kW per year Malawi
Tot_DG_kW_demand_DRC <-  DG_kW_demand_DRC*Health_facilities_DRC#total kW per year DRC

DG_upfront_cost_NGA <- (DG_upfront_cost_per_kW/power_factor)*Tot_DG_kW_demand_NGA/10^6
DG_upfront_cost_MWI <- (DG_upfront_cost_per_kW/power_factor)*Tot_DG_kW_demand_MWI/10^6
DG_upfront_cost_DRC <- (DG_upfront_cost_per_kW/power_factor)*Tot_DG_kW_demand_DRC/10^6

DG_life_NGA <- min(DG_lifespan/annual_outage_dur_NGA,20) #limited to 20 hours source:https://duthiepower.com/the-general-life-span-of-a-generator/
DG_life_MWI <- min(DG_lifespan/annual_outage_dur_MWI,20) #limited to 20 hours source:https://duthiepower.com/the-general-life-span-of-a-generator/
DG_life_DRC <- min(DG_lifespan/annual_outage_dur_DRC,20) #limited to 20 hours source:https://duthiepower.com/the-general-life-span-of-a-generator/

Diesel_cons_NGA <- diesel_consumption*Tot_DG_kW_demand_NGA/0.8 #liters per year
Diesel_cons_MWI <- diesel_consumption*Tot_DG_kW_demand_MWI/0.8 #liters per year
Diesel_cons_DRC <- diesel_consumption*Tot_DG_kW_demand_DRC/0.8 #liters per year

Diesel_cost_NGA <- diesel_cost*Diesel_cons_NGA/10^6
Diesel_cost_MWI <- diesel_cost*Diesel_cons_MWI/10^6
Diesel_cost_DRC <- diesel_cost*Diesel_cons_DRC/10^6

DG_OM_cost_NGA <- dg_maintenance_cost*Tot_DG_kW_demand_NGA/0.8/10^6
DG_OM_cost_MWI <- dg_maintenance_cost*Tot_DG_kW_demand_MWI/0.8/10^6
DG_OM_cost_DRC <- dg_maintenance_cost*Tot_DG_kW_demand_DRC/0.8/10^6

DG_Tot_Opex_NGA <- Diesel_cost_NGA+DG_OM_cost_NGA
DG_Tot_Opex_MWI <- Diesel_cost_MWI+DG_OM_cost_MWI
DG_Tot_Opex_DRC <- Diesel_cost_DRC+DG_OM_cost_DRC

NPV_DG_Opex_NGA <- 0
NPV_DG_Opex_MWI <- 0
NPV_DG_Opex_DRC <- 0

for(i in 1:DG_life_NGA){
  NPV_DG_Opex_NGA <- NPV_DG_Opex_NGA + DG_Tot_Opex_NGA/((1+discount_rate)^i)
}

for(i in 1:DG_life_MWI){
  NPV_DG_Opex_MWI <- NPV_DG_Opex_MWI + DG_Tot_Opex_MWI/((1+discount_rate)^i)
}

for(i in 1:DG_life_DRC){
  NPV_DG_Opex_DRC <- NPV_DG_Opex_DRC + DG_Tot_Opex_DRC/((1+discount_rate)^i)
}

Tot_DG_direct_cost_NGA <- NPV_DG_Opex_NGA + DG_upfront_cost_NGA
Tot_DG_direct_cost_MWI <- NPV_DG_Opex_MWI + DG_upfront_cost_MWI
Tot_DG_direct_cost_DRC <- NPV_DG_Opex_DRC + DG_upfront_cost_DRC

DG_annuity_factor_NGA <- (1-(1/((1+discount_rate)^(DG_life_NGA))))/discount_rate
DG_annuity_factor_MWI <- (1-(1/((1+discount_rate)^(DG_life_MWI))))/discount_rate
DG_annuity_factor_DRC <- (1-(1/((1+discount_rate)^(DG_life_DRC))))/discount_rate

Annualized_DG_direct_cost_NGA <- Tot_DG_direct_cost_NGA/DG_annuity_factor_NGA
Annualized_DG_direct_cost_MWI <- Tot_DG_direct_cost_MWI/DG_annuity_factor_MWI
Annualized_DG_direct_cost_DRC <- Tot_DG_direct_cost_DRC/DG_annuity_factor_DRC
Annualized_DG_direct_cost_overall <- Annualized_DG_direct_cost_NGA + Annualized_DG_direct_cost_MWI + Annualized_DG_direct_cost_DRC

Annualized_DG_capex_NGA <- DG_upfront_cost_NGA/DG_annuity_factor_NGA
Annualized_DG_capex_MWI <- DG_upfront_cost_MWI/DG_annuity_factor_MWI
Annualized_DG_capex_DRC <- DG_upfront_cost_DRC/DG_annuity_factor_DRC
Annualized_DG_capex_overall <- Annualized_DG_capex_NGA + Annualized_DG_capex_MWI + Annualized_DG_capex_DRC

Annualized_DG_opex_NGA <- NPV_DG_Opex_NGA/DG_annuity_factor_NGA
Annualized_DG_opex_MWI <- NPV_DG_Opex_MWI/DG_annuity_factor_MWI
Annualized_DG_opex_DRC <- NPV_DG_Opex_DRC/DG_annuity_factor_DRC
Annualized_DG_opex_overall <- Annualized_DG_opex_NGA + Annualized_DG_opex_MWI + Annualized_DG_opex_DRC

################################ Emission Cost calculations for DG sets ##########################

dg_CO2_emission_NGA <- diesel_emission_factor*Diesel_cons_NGA/1000 #ton CO2 per year
dg_CO2_emission_MWI <- diesel_emission_factor*Diesel_cons_MWI/1000 #ton CO2 per year
dg_CO2_emission_DRC <- diesel_emission_factor*Diesel_cons_DRC/1000 #ton CO2 per year

dg_emission_cost_NGA <- dg_CO2_emission_NGA*global_social_cost_carbon/10^6 #$ million per year
dg_emission_cost_MWI <- dg_CO2_emission_MWI*global_social_cost_carbon/10^6 #$ million per year
dg_emission_cost_DRC <- dg_CO2_emission_DRC*global_social_cost_carbon/10^6 #$ million per year

NPV_DG_emission_cost_NGA <- 0
NPV_DG_emission_cost_MWI <- 0
NPV_DG_emission_cost_DRC <- 0

for(i in 1:DG_life_NGA){
  NPV_DG_emission_cost_NGA <- NPV_DG_emission_cost_NGA + dg_emission_cost_NGA/((1+discount_rate)^i)
}

for(i in 1:DG_life_MWI){
  NPV_DG_emission_cost_MWI <- NPV_DG_emission_cost_MWI + dg_emission_cost_MWI/((1+discount_rate)^i)
}

for(i in 1:DG_life_DRC){
  NPV_DG_emission_cost_DRC <- NPV_DG_emission_cost_DRC + dg_emission_cost_DRC/((1+discount_rate)^i)
}

Annualized_DG_emission_cost_NGA <- NPV_DG_emission_cost_NGA/DG_annuity_factor_NGA
Annualized_DG_emission_cost_MWI <- NPV_DG_emission_cost_MWI/DG_annuity_factor_MWI
Annualized_DG_emission_cost_DRC <- NPV_DG_emission_cost_DRC/DG_annuity_factor_DRC
Annualized_DG_emission_cost_overall <- Annualized_DG_emission_cost_NGA + Annualized_DG_emission_cost_MWI + Annualized_DG_emission_cost_DRC


################################ Existing refrigeration system replacement cost ##########################

# Typical age of vaccine refrigeration system : around 8 to 10 years (Sicuri et al. doi: 10.1177/2381468319896280)
# we can thus carry out Monte carlo for refrigerator age from 1 to 10 years using a normal distribution of age instead of uniform distribution

max_life_regular_fridge = 10 # years of total lifespan
existing_refrigerator_age <- rnorm(1, mean = 5, sd = 1)
existing_refrigerator_age <- pmax(1, pmin(max_life_regular_fridge, existing_refrigerator_age))
remaining_life_existing_fridge <- floor(max_life_regular_fridge - existing_refrigerator_age)
new_fridge_cost <- runif(1, 410, 820) #(WHO-CHOICE One Health Tool)

remaining_yrs_energy_sys_NGA <- max((DG_life_NGA - remaining_life_existing_fridge),0)
remaining_yrs_energy_sys_MWI <- max((DG_life_MWI - remaining_life_existing_fridge),0)
remaining_yrs_energy_sys_DRC <- max((DG_life_DRC - remaining_life_existing_fridge),0)

new_fridge_requirement_NGA <- ceiling(remaining_yrs_energy_sys_NGA/max_life_regular_fridge)
new_fridge_requirement_MWI <- ceiling(remaining_yrs_energy_sys_MWI/max_life_regular_fridge)
new_fridge_requirement_DRC <- ceiling(remaining_yrs_energy_sys_DRC/max_life_regular_fridge)

NPV_new_fridge_cost_NGA <- 0
NPV_new_fridge_cost_MWI <- 0
NPV_new_fridge_cost_DRC <- 0

for(i in 0:new_fridge_requirement_NGA){
   if (i == 0) {
    NPV_new_fridge_cost_NGA = 0
  } else if (i > 0) {
    time_of_fridge_purchase <- max_life_regular_fridge*(i-1)+(existing_refrigerator_age+1)
    NPV_new_fridge_cost_NGA = NPV_new_fridge_cost_NGA + new_fridge_cost/((1+discount_rate)^time_of_fridge_purchase)
  }
}

for(i in 0:new_fridge_requirement_MWI){
   if (i == 0) {
    NPV_new_fridge_cost_MWI = 0
  } else if (i > 0) {
    time_of_fridge_purchase <- max_life_regular_fridge*(i-1)+(existing_refrigerator_age+1)
    NPV_new_fridge_cost_MWI = NPV_new_fridge_cost_MWI + new_fridge_cost/((1+discount_rate)^time_of_fridge_purchase)
  }
}

for(i in 0:new_fridge_requirement_DRC){
   if (i == 0) {
    NPV_new_fridge_cost_DRC = 0
  } else if (i > 0) {
    time_of_fridge_purchase <- max_life_regular_fridge*(i-1)+(existing_refrigerator_age+1)
    NPV_new_fridge_cost_DRC = NPV_new_fridge_cost_DRC + new_fridge_cost/((1+discount_rate)^time_of_fridge_purchase)
  }
}

Annualized_cost_new_fridge_NGA <- (NPV_new_fridge_cost_NGA*Health_facilities_NGA)/DG_annuity_factor_NGA/10^6
Annualized_cost_new_fridge_MWI <- (NPV_new_fridge_cost_MWI*Health_facilities_MWI)/DG_annuity_factor_MWI/10^6
Annualized_cost_new_fridge_DRC <- (NPV_new_fridge_cost_DRC*Health_facilities_DRC)/DG_annuity_factor_DRC/10^6
Annualized_cost_new_fridge_overall <- Annualized_cost_new_fridge_NGA + Annualized_cost_new_fridge_MWI + Annualized_cost_new_fridge_DRC


####################### Vaccine Costs inputs ###################################################################################
#Costs are average between PAHO 2023 quotes, GAVI and UNICEF 2021 quotes

vac_cost_NGA_HepA_HiB <- runif(1, 1.1875, 1.24) #$/dose
vac_cost_MWI_HepA_HiB <- runif(1, 1.1875, 1.24) #$/dose
vac_cost_DRC_HepA_HiB <- runif(1, 1.1875, 1.24) #$/dose

vac_cost_NGA_HPV <- runif(1, 4.04, 10.48) #$/dose
vac_cost_MWI_HPV <- runif(1, 4.04, 10.48) #$/dose
vac_cost_DRC_HPV <- runif(1, 4.04, 10.48) #$/dose

vac_cost_NGA_MR <- runif(1, 0.94, 1.9041) #$/dose
vac_cost_MWI_MR <- runif(1, 0.94, 1.9041) #$/dose
vac_cost_DRC_MR <- runif(1, 0.94, 1.9041) #$/dose

vac_cost_NGA_PCV <- runif(1, 2.9, 13.5) #$/dose
vac_cost_MWI_PCV <- runif(1, 2.9, 13.5) #$/dose
vac_cost_DRC_PCV <- runif(1, 2.9, 13.5) #$/dose

vac_cost_NGA_MenA <- runif(1, 0.67, 20.3) #$/dose
vac_cost_MWI_MenA <- runif(1, 0.67, 20.3) #$/dose
vac_cost_DRC_MenA <- runif(1, 0.67, 20.3) #$/dose

vac_cost_NGA_Rota <- runif(1, 1.48, 4.925) #$/dose
vac_cost_MWI_Rota <- runif(1, 1.48, 4.925) #$/dose
vac_cost_DRC_Rota <- runif(1, 1.48, 4.925) #$/dose

vac_cost_NGA_YF <- runif(1, 1.235, 1.41) #$/dose
vac_cost_MWI_YF <- runif(1, 1.235, 1.41) #$/dose
vac_cost_DRC_YF <- runif(1, 1.235, 1.41) #$/dose



################### Vaccine Delivery Costs inputs ############################################################################
#Portnoy et al. (2019)

vac_del_cost_NGA_HepA_HiB <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_HepA_HiB <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_HepA_HiB <- runif(1, 0.6374, 3.7016) #$/dose

vac_del_cost_NGA_HPV <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_HPV <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_HPV <- runif(1, 0.6374, 3.7016) #$/dose

vac_del_cost_NGA_MR <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_MR <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_MR <- runif(1, 0.6374, 3.7016) #$/dose

vac_del_cost_NGA_PCV <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_PCV <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_PCV <- runif(1, 0.6374, 3.7016) #$/dose

vac_del_cost_NGA_MenA <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_MenA <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_MenA <- runif(1, 0.6374, 3.7016) #$/dose

vac_del_cost_NGA_Rota <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_Rota <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_Rota <- runif(1, 0.6374, 3.7016) #$/dose

vac_del_cost_NGA_YF <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_YF <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_YF <- runif(1, 0.6374, 3.7016) #$/dose


#################################################################################################################################

############### Calculations for Vaccine Cost  ####################################################################################

## Vaccine Cost calculation ##

Nigeria_DG_vac_cost <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Nigeria_DG_vac_cost) <- c("NGA_HepA&HiB", "NGA_HPV","NGA_MR","NGA_PCV","NGA_Meningitis","NGA_Rotavirus","NGA_YF")

Malawi_DG_vac_cost <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(Malawi_DG_vac_cost) <- c("MWI_HepA&HiB", "MWI_HPV","MWI_MR","MWI_PCV","MWI_Meningitis","MWI_Rotavirus","MWI_YF")

DRC_DG_vac_cost <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(DRC_DG_vac_cost) <- c("DRC_HepA&HiB", "DRC_HPV","DRC_MR","DRC_PCV","DRC_Meningitis","DRC_Rotavirus","DRC_YF")

Total_DG_vac_cost <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(Total_DG_vac_cost) <- c("Total_HepA&HiB", "Total_HPV","Total_MR","Total_PCV","Total_Meningitis","Total_Rotavirus","Total_YF")

for (i in 1:vac_estimation_length){
Nigeria_DG_vac_cost[i,1] <- Nigeria_DG_vac_doses$`NGA_HepA&HiB`[i]*vac_cost_NGA_HepA_HiB
Malawi_DG_vac_cost[i,1] <- Malawi_DG_vac_doses$`MWI_HepA&HiB`[i]*vac_cost_MWI_HepA_HiB
DRC_DG_vac_cost[i,1] <- DRC_DG_vac_doses$`DRC_HepA&HiB`[i]*vac_cost_DRC_HepA_HiB
Total_DG_vac_cost [i,1] <- Nigeria_DG_vac_cost[i,1] + Malawi_DG_vac_cost[i,1] + DRC_DG_vac_cost[i,1]
 
Nigeria_DG_vac_cost[i,2] <- Nigeria_DG_vac_doses$`NGA_HPV`[i]*vac_cost_NGA_HPV
Malawi_DG_vac_cost[i,2] <- Malawi_DG_vac_doses$`MWI_HPV`[i]*vac_cost_MWI_HPV
DRC_DG_vac_cost[i,2] <- DRC_DG_vac_doses$`DRC_HPV`[i]*vac_cost_DRC_HPV
Total_DG_vac_cost [i,2] <- Nigeria_DG_vac_cost[i,2] + Malawi_DG_vac_cost[i,2] + DRC_DG_vac_cost[i,2]

Nigeria_DG_vac_cost[i,3] <- Nigeria_DG_vac_doses$`NGA_MR`[i]*vac_cost_NGA_MR
Malawi_DG_vac_cost[i,3] <- Malawi_DG_vac_doses$`MWI_MR`[i]*vac_cost_MWI_MR
DRC_DG_vac_cost[i,3] <- DRC_DG_vac_doses$`DRC_MR`[i]*vac_cost_DRC_MR
Total_DG_vac_cost [i,3] <- Nigeria_DG_vac_cost[i,3] + Malawi_DG_vac_cost[i,3] + DRC_DG_vac_cost[i,3]

Nigeria_DG_vac_cost[i,4] <- Nigeria_DG_vac_doses$`NGA_PCV`[i]*vac_cost_NGA_PCV
Malawi_DG_vac_cost[i,4] <- Malawi_DG_vac_doses$`MWI_PCV`[i]*vac_cost_MWI_PCV
DRC_DG_vac_cost[i,4] <- DRC_DG_vac_doses$`DRC_PCV`[i]*vac_cost_DRC_PCV
Total_DG_vac_cost [i,4] <- Nigeria_DG_vac_cost[i,4] + Malawi_DG_vac_cost[i,4] + DRC_DG_vac_cost[i,4]

Nigeria_DG_vac_cost[i,5] <- Nigeria_DG_vac_doses$`NGA_Meningitis`[i]*vac_cost_NGA_MenA
Malawi_DG_vac_cost[i,5] <- Malawi_DG_vac_doses$`MWI_Meningitis`[i]*vac_cost_MWI_MenA
DRC_DG_vac_cost[i,5] <- DRC_DG_vac_doses$`DRC_Meningitis`[i]*vac_cost_DRC_MenA
Total_DG_vac_cost [i,5] <- Nigeria_DG_vac_cost[i,5] + Malawi_DG_vac_cost[i,5] + DRC_DG_vac_cost[i,5]

Nigeria_DG_vac_cost[i,6] <- Nigeria_DG_vac_doses$`NGA_Rota`[i]*vac_cost_NGA_Rota
Malawi_DG_vac_cost[i,6] <- Malawi_DG_vac_doses$`MWI_Rota`[i]*vac_cost_MWI_Rota
DRC_DG_vac_cost[i,6] <- DRC_DG_vac_doses$`DRC_Rota`[i]*vac_cost_DRC_Rota
Total_DG_vac_cost [i,6] <- Nigeria_DG_vac_cost[i,6] + Malawi_DG_vac_cost[i,6] + DRC_DG_vac_cost[i,6]

Nigeria_DG_vac_cost[i,7] <- Nigeria_DG_vac_doses$`NGA_YF`[i]*vac_cost_NGA_YF
Malawi_DG_vac_cost[i,7] <- Malawi_DG_vac_doses$`MWI_YF`[i]*vac_cost_MWI_YF
DRC_DG_vac_cost[i,7] <- DRC_DG_vac_doses$`DRC_YF`[i]*vac_cost_DRC_YF 
Total_DG_vac_cost [i,7] <- Nigeria_DG_vac_cost[i,7] + Malawi_DG_vac_cost[i,7] + DRC_DG_vac_cost[i,7]

}

Nigeria_DG_vac_cost <- as.data.frame(Nigeria_DG_vac_cost)
Malawi_DG_vac_cost <- as.data.frame(Malawi_DG_vac_cost)
DRC_DG_vac_cost <- as.data.frame(DRC_DG_vac_cost)
Total_DG_vac_cost <- as.data.frame(Total_DG_vac_cost)

##NPV calculations
#Nigeria
NPV_NGA_DG_vac_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_NGA_DG_vac_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_NGA_DG_vac_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_NGA_DG_vac_cost [1,1] <- NPV_NGA_DG_vac_cost [1,1]+Nigeria_DG_vac_cost$`NGA_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_NGA_DG_vac_cost [1,2] <- NPV_NGA_DG_vac_cost [1,2]+Nigeria_DG_vac_cost$`NGA_HPV`[i]/((1+discount_rate)^(i)) 
NPV_NGA_DG_vac_cost [1,3] <- NPV_NGA_DG_vac_cost [1,3]+Nigeria_DG_vac_cost$`NGA_MR`[i]/((1+discount_rate)^(i)) 
NPV_NGA_DG_vac_cost [1,4] <- NPV_NGA_DG_vac_cost [1,4]+Nigeria_DG_vac_cost$`NGA_PCV`[i]/((1+discount_rate)^(i))   
NPV_NGA_DG_vac_cost [1,5] <- NPV_NGA_DG_vac_cost [1,5]+Nigeria_DG_vac_cost$`NGA_Meningitis`[i]/((1+discount_rate)^(i))
NPV_NGA_DG_vac_cost [1,6] <- NPV_NGA_DG_vac_cost [1,6]+Nigeria_DG_vac_cost$`NGA_Rota`[i]/((1+discount_rate)^(i))
NPV_NGA_DG_vac_cost [1,7] <- NPV_NGA_DG_vac_cost [1,7]+Nigeria_DG_vac_cost$`NGA_YF`[i]/((1+discount_rate)^(i))
}
NPV_NGA_DG_vac_cost [1,8] <- NPV_NGA_DG_vac_cost[1,1] + NPV_NGA_DG_vac_cost[1,2] + NPV_NGA_DG_vac_cost[1,3] + NPV_NGA_DG_vac_cost[1,4] + NPV_NGA_DG_vac_cost[1,5] + NPV_NGA_DG_vac_cost[1,6] + NPV_NGA_DG_vac_cost[1,7]

NPV_NGA_DG_vac_cost <- as.data.frame (NPV_NGA_DG_vac_cost)

#Malawi
NPV_MWI_DG_vac_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_MWI_DG_vac_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_MWI_DG_vac_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_MWI_DG_vac_cost [1,1] <- NPV_MWI_DG_vac_cost [1,1]+Malawi_DG_vac_cost$`MWI_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_MWI_DG_vac_cost [1,2] <- NPV_MWI_DG_vac_cost [1,2]+Malawi_DG_vac_cost$`MWI_HPV`[i]/((1+discount_rate)^(i)) 
NPV_MWI_DG_vac_cost [1,3] <- NPV_MWI_DG_vac_cost [1,3]+Malawi_DG_vac_cost$`MWI_MR`[i]/((1+discount_rate)^(i)) 
NPV_MWI_DG_vac_cost [1,4] <- NPV_MWI_DG_vac_cost [1,4]+Malawi_DG_vac_cost$`MWI_PCV`[i]/((1+discount_rate)^(i))   
NPV_MWI_DG_vac_cost [1,5] <- NPV_MWI_DG_vac_cost [1,5]+Malawi_DG_vac_cost$`MWI_Meningitis`[i]/((1+discount_rate)^(i))
NPV_MWI_DG_vac_cost [1,6] <- NPV_MWI_DG_vac_cost [1,6]+Malawi_DG_vac_cost$`MWI_Rota`[i]/((1+discount_rate)^(i))
NPV_MWI_DG_vac_cost [1,7] <- NPV_MWI_DG_vac_cost [1,7]+Malawi_DG_vac_cost$`MWI_YF`[i]/((1+discount_rate)^(i))
}
NPV_MWI_DG_vac_cost [1,8] <- NPV_MWI_DG_vac_cost[1,1] + NPV_MWI_DG_vac_cost[1,2] + NPV_MWI_DG_vac_cost[1,3] + NPV_MWI_DG_vac_cost[1,4] + NPV_MWI_DG_vac_cost[1,5] + NPV_MWI_DG_vac_cost[1,6] + NPV_MWI_DG_vac_cost[1,7]

NPV_MWI_DG_vac_cost <- as.data.frame (NPV_MWI_DG_vac_cost)


#DRC
NPV_DRC_DG_vac_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_DRC_DG_vac_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_DRC_DG_vac_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_DRC_DG_vac_cost [1,1] <- NPV_DRC_DG_vac_cost [1,1]+DRC_DG_vac_cost$`DRC_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_DRC_DG_vac_cost [1,2] <- NPV_DRC_DG_vac_cost [1,2]+DRC_DG_vac_cost$`DRC_HPV`[i]/((1+discount_rate)^(i)) 
NPV_DRC_DG_vac_cost [1,3] <- NPV_DRC_DG_vac_cost [1,3]+DRC_DG_vac_cost$`DRC_MR`[i]/((1+discount_rate)^(i)) 
NPV_DRC_DG_vac_cost [1,4] <- NPV_DRC_DG_vac_cost [1,4]+DRC_DG_vac_cost$`DRC_PCV`[i]/((1+discount_rate)^(i))   
NPV_DRC_DG_vac_cost [1,5] <- NPV_DRC_DG_vac_cost [1,5]+DRC_DG_vac_cost$`DRC_Meningitis`[i]/((1+discount_rate)^(i))
NPV_DRC_DG_vac_cost [1,6] <- NPV_DRC_DG_vac_cost [1,6]+DRC_DG_vac_cost$`DRC_Rota`[i]/((1+discount_rate)^(i))
NPV_DRC_DG_vac_cost [1,7] <- NPV_DRC_DG_vac_cost [1,7]+DRC_DG_vac_cost$`DRC_YF`[i]/((1+discount_rate)^(i))
}
NPV_DRC_DG_vac_cost [1,8] <- NPV_DRC_DG_vac_cost[1,1] + NPV_DRC_DG_vac_cost[1,2] + NPV_DRC_DG_vac_cost[1,3] + NPV_DRC_DG_vac_cost[1,4] + NPV_DRC_DG_vac_cost[1,5] + NPV_DRC_DG_vac_cost[1,6] + NPV_DRC_DG_vac_cost[1,7]

NPV_DRC_DG_vac_cost <- as.data.frame (NPV_DRC_DG_vac_cost)


#Total
NPV_Tot_DG_vac_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_Tot_DG_vac_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_Tot_DG_vac_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_Tot_DG_vac_cost [1,1] <- NPV_Tot_DG_vac_cost [1,1]+Total_DG_vac_cost$`Total_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_Tot_DG_vac_cost [1,2] <- NPV_Tot_DG_vac_cost [1,2]+Total_DG_vac_cost$`Total_HPV`[i]/((1+discount_rate)^(i)) 
NPV_Tot_DG_vac_cost [1,3] <- NPV_Tot_DG_vac_cost [1,3]+Total_DG_vac_cost$`Total_MR`[i]/((1+discount_rate)^(i)) 
NPV_Tot_DG_vac_cost [1,4] <- NPV_Tot_DG_vac_cost [1,4]+Total_DG_vac_cost$`Total_PCV`[i]/((1+discount_rate)^(i))   
NPV_Tot_DG_vac_cost [1,5] <- NPV_Tot_DG_vac_cost [1,5]+Total_DG_vac_cost$`Total_Meningitis`[i]/((1+discount_rate)^(i))
NPV_Tot_DG_vac_cost [1,6] <- NPV_Tot_DG_vac_cost [1,6]+Total_DG_vac_cost$`Total_Rota`[i]/((1+discount_rate)^(i))
NPV_Tot_DG_vac_cost [1,7] <- NPV_Tot_DG_vac_cost [1,7]+Total_DG_vac_cost$`Total_YF`[i]/((1+discount_rate)^(i))
}
NPV_Tot_DG_vac_cost [1,8] <- NPV_Tot_DG_vac_cost[1,1] + NPV_Tot_DG_vac_cost[1,2] + NPV_Tot_DG_vac_cost[1,3] + NPV_Tot_DG_vac_cost[1,4] + NPV_Tot_DG_vac_cost[1,5] + NPV_Tot_DG_vac_cost[1,6] + NPV_Tot_DG_vac_cost[1,7]

NPV_Tot_DG_vac_cost <- as.data.frame (NPV_Tot_DG_vac_cost)


############### Calculations for Vaccine delivery cost ###########################################################################
## Vaccine delivery cost calculation

Nigeria_DG_vac_del_cost <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Nigeria_DG_vac_del_cost) <- c("NGA_HepA&HiB", "NGA_HPV","NGA_MR","NGA_PCV","NGA_Meningitis","NGA_Rotavirus","NGA_YF")

Malawi_DG_vac_del_cost <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(Malawi_DG_vac_del_cost) <- c("MWI_HepA&HiB", "MWI_HPV","MWI_MR","MWI_PCV","MWI_Meningitis","MWI_Rotavirus","MWI_YF")

DRC_DG_vac_del_cost <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(DRC_DG_vac_del_cost) <- c("DRC_HepA&HiB", "DRC_HPV","DRC_MR","DRC_PCV","DRC_Meningitis","DRC_Rotavirus","DRC_YF")

Total_DG_vac_del_cost <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(Total_DG_vac_del_cost) <- c("Total_HepA&HiB", "Total_HPV","Total_MR","Total_PCV","Total_Meningitis","Total_Rotavirus","Total_YF")

for (i in 1:vac_estimation_length){
Nigeria_DG_vac_del_cost[i,1] <- Nigeria_DG_vac_doses$`NGA_HepA&HiB`[i]*vac_del_cost_NGA_HepA_HiB
Malawi_DG_vac_del_cost[i,1] <- Malawi_DG_vac_doses$`MWI_HepA&HiB`[i]*vac_del_cost_MWI_HepA_HiB
DRC_DG_vac_del_cost[i,1] <- DRC_DG_vac_doses$`DRC_HepA&HiB`[i]*vac_del_cost_DRC_HepA_HiB
Total_DG_vac_del_cost [i,1] <- Nigeria_DG_vac_del_cost[i,1] + Malawi_DG_vac_del_cost[i,1] + DRC_DG_vac_del_cost[i,1]
 
Nigeria_DG_vac_del_cost[i,2] <- Nigeria_DG_vac_doses$`NGA_HPV`[i]*vac_del_cost_NGA_HPV
Malawi_DG_vac_del_cost[i,2] <- Malawi_DG_vac_doses$`MWI_HPV`[i]*vac_del_cost_MWI_HPV
DRC_DG_vac_del_cost[i,2] <- DRC_DG_vac_doses$`DRC_HPV`[i]*vac_del_cost_DRC_HPV
Total_DG_vac_del_cost [i,2] <- Nigeria_DG_vac_del_cost[i,2] + Malawi_DG_vac_del_cost[i,2] + DRC_DG_vac_del_cost[i,2]

Nigeria_DG_vac_del_cost[i,3] <- Nigeria_DG_vac_doses$`NGA_MR`[i]*vac_del_cost_NGA_MR
Malawi_DG_vac_del_cost[i,3] <- Malawi_DG_vac_doses$`MWI_MR`[i]*vac_del_cost_MWI_MR
DRC_DG_vac_del_cost[i,3] <- DRC_DG_vac_doses$`DRC_MR`[i]*vac_del_cost_DRC_MR
Total_DG_vac_del_cost [i,3] <- Nigeria_DG_vac_del_cost[i,3] + Malawi_DG_vac_del_cost[i,3] + DRC_DG_vac_del_cost[i,3]

Nigeria_DG_vac_del_cost[i,4] <- Nigeria_DG_vac_doses$`NGA_PCV`[i]*vac_del_cost_NGA_PCV
Malawi_DG_vac_del_cost[i,4] <- Malawi_DG_vac_doses$`MWI_PCV`[i]*vac_del_cost_MWI_PCV
DRC_DG_vac_del_cost[i,4] <- DRC_DG_vac_doses$`DRC_PCV`[i]*vac_del_cost_DRC_PCV
Total_DG_vac_del_cost [i,4] <- Nigeria_DG_vac_del_cost[i,4] + Malawi_DG_vac_del_cost[i,4] + DRC_DG_vac_del_cost[i,4]

Nigeria_DG_vac_del_cost[i,5] <- Nigeria_DG_vac_doses$`NGA_Meningitis`[i]*vac_del_cost_NGA_MenA
Malawi_DG_vac_del_cost[i,5] <- Malawi_DG_vac_doses$`MWI_Meningitis`[i]*vac_del_cost_MWI_MenA
DRC_DG_vac_del_cost[i,5] <- DRC_DG_vac_doses$`DRC_Meningitis`[i]*vac_del_cost_DRC_MenA
Total_DG_vac_del_cost [i,5] <- Nigeria_DG_vac_del_cost[i,5] + Malawi_DG_vac_del_cost[i,5] + DRC_DG_vac_del_cost[i,5]

Nigeria_DG_vac_del_cost[i,6] <- Nigeria_DG_vac_doses$`NGA_Rota`[i]*vac_del_cost_NGA_Rota
Malawi_DG_vac_del_cost[i,6] <- Malawi_DG_vac_doses$`MWI_Rota`[i]*vac_del_cost_MWI_Rota
DRC_DG_vac_del_cost[i,6] <- DRC_DG_vac_doses$`DRC_Rota`[i]*vac_del_cost_DRC_Rota
Total_DG_vac_del_cost [i,6] <- Nigeria_DG_vac_del_cost[i,6] + Malawi_DG_vac_del_cost[i,6] + DRC_DG_vac_del_cost[i,6]

Nigeria_DG_vac_del_cost[i,7] <- Nigeria_DG_vac_doses$`NGA_YF`[i]*vac_del_cost_NGA_YF
Malawi_DG_vac_del_cost[i,7] <- Malawi_DG_vac_doses$`MWI_YF`[i]*vac_del_cost_MWI_YF
DRC_DG_vac_del_cost[i,7] <- DRC_DG_vac_doses$`DRC_YF`[i]*vac_del_cost_DRC_YF 
Total_DG_vac_del_cost [i,7] <- Nigeria_DG_vac_del_cost[i,7] + Malawi_DG_vac_del_cost[i,7] + DRC_DG_vac_del_cost[i,7]

}

Nigeria_DG_vac_del_cost <- as.data.frame(Nigeria_DG_vac_del_cost)
Malawi_DG_vac_del_cost <- as.data.frame(Malawi_DG_vac_del_cost)
DRC_DG_vac_del_cost <- as.data.frame(DRC_DG_vac_del_cost)
Total_DG_vac_del_cost <- as.data.frame(Total_DG_vac_del_cost)

##NPV calculations
#Nigeria
NPV_NGA_DG_vac_del_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_NGA_DG_vac_del_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_NGA_DG_vac_del_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_NGA_DG_vac_del_cost [1,1] <- NPV_NGA_DG_vac_del_cost [1,1]+Nigeria_DG_vac_del_cost$`NGA_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_NGA_DG_vac_del_cost [1,2] <- NPV_NGA_DG_vac_del_cost [1,2]+Nigeria_DG_vac_del_cost$`NGA_HPV`[i]/((1+discount_rate)^(i)) 
NPV_NGA_DG_vac_del_cost [1,3] <- NPV_NGA_DG_vac_del_cost [1,3]+Nigeria_DG_vac_del_cost$`NGA_MR`[i]/((1+discount_rate)^(i)) 
NPV_NGA_DG_vac_del_cost [1,4] <- NPV_NGA_DG_vac_del_cost [1,4]+Nigeria_DG_vac_del_cost$`NGA_PCV`[i]/((1+discount_rate)^(i))   
NPV_NGA_DG_vac_del_cost [1,5] <- NPV_NGA_DG_vac_del_cost [1,5]+Nigeria_DG_vac_del_cost$`NGA_Meningitis`[i]/((1+discount_rate)^(i))
NPV_NGA_DG_vac_del_cost [1,6] <- NPV_NGA_DG_vac_del_cost [1,6]+Nigeria_DG_vac_del_cost$`NGA_Rota`[i]/((1+discount_rate)^(i))
NPV_NGA_DG_vac_del_cost [1,7] <- NPV_NGA_DG_vac_del_cost [1,7]+Nigeria_DG_vac_del_cost$`NGA_YF`[i]/((1+discount_rate)^(i))
}
NPV_NGA_DG_vac_del_cost [1,8] <- NPV_NGA_DG_vac_del_cost[1,1] + NPV_NGA_DG_vac_del_cost[1,2] + NPV_NGA_DG_vac_del_cost[1,3] + NPV_NGA_DG_vac_del_cost[1,4] + NPV_NGA_DG_vac_del_cost[1,5] + NPV_NGA_DG_vac_del_cost[1,6] + NPV_NGA_DG_vac_del_cost[1,7]

NPV_NGA_DG_vac_del_cost <- as.data.frame (NPV_NGA_DG_vac_del_cost)

#Malawi
NPV_MWI_DG_vac_del_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_MWI_DG_vac_del_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_MWI_DG_vac_del_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_MWI_DG_vac_del_cost [1,1] <- NPV_MWI_DG_vac_del_cost [1,1]+Malawi_DG_vac_del_cost$`MWI_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_MWI_DG_vac_del_cost [1,2] <- NPV_MWI_DG_vac_del_cost [1,2]+Malawi_DG_vac_del_cost$`MWI_HPV`[i]/((1+discount_rate)^(i)) 
NPV_MWI_DG_vac_del_cost [1,3] <- NPV_MWI_DG_vac_del_cost [1,3]+Malawi_DG_vac_del_cost$`MWI_MR`[i]/((1+discount_rate)^(i)) 
NPV_MWI_DG_vac_del_cost [1,4] <- NPV_MWI_DG_vac_del_cost [1,4]+Malawi_DG_vac_del_cost$`MWI_PCV`[i]/((1+discount_rate)^(i))   
NPV_MWI_DG_vac_del_cost [1,5] <- NPV_MWI_DG_vac_del_cost [1,5]+Malawi_DG_vac_del_cost$`MWI_Meningitis`[i]/((1+discount_rate)^(i))
NPV_MWI_DG_vac_del_cost [1,6] <- NPV_MWI_DG_vac_del_cost [1,6]+Malawi_DG_vac_del_cost$`MWI_Rota`[i]/((1+discount_rate)^(i))
NPV_MWI_DG_vac_del_cost [1,7] <- NPV_MWI_DG_vac_del_cost [1,7]+Malawi_DG_vac_del_cost$`MWI_YF`[i]/((1+discount_rate)^(i))
}
NPV_MWI_DG_vac_del_cost [1,8] <- NPV_MWI_DG_vac_del_cost[1,1] + NPV_MWI_DG_vac_del_cost[1,2] + NPV_MWI_DG_vac_del_cost[1,3] + NPV_MWI_DG_vac_del_cost[1,4] + NPV_MWI_DG_vac_del_cost[1,5] + NPV_MWI_DG_vac_del_cost[1,6] + NPV_MWI_DG_vac_del_cost[1,7]

NPV_MWI_DG_vac_del_cost <- as.data.frame (NPV_MWI_DG_vac_del_cost)

#DRC
NPV_DRC_DG_vac_del_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_DRC_DG_vac_del_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_DRC_DG_vac_del_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_DRC_DG_vac_del_cost [1,1] <- NPV_DRC_DG_vac_del_cost [1,1]+DRC_DG_vac_del_cost$`DRC_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_DRC_DG_vac_del_cost [1,2] <- NPV_DRC_DG_vac_del_cost [1,2]+DRC_DG_vac_del_cost$`DRC_HPV`[i]/((1+discount_rate)^(i)) 
NPV_DRC_DG_vac_del_cost [1,3] <- NPV_DRC_DG_vac_del_cost [1,3]+DRC_DG_vac_del_cost$`DRC_MR`[i]/((1+discount_rate)^(i)) 
NPV_DRC_DG_vac_del_cost [1,4] <- NPV_DRC_DG_vac_del_cost [1,4]+DRC_DG_vac_del_cost$`DRC_PCV`[i]/((1+discount_rate)^(i))   
NPV_DRC_DG_vac_del_cost [1,5] <- NPV_DRC_DG_vac_del_cost [1,5]+DRC_DG_vac_del_cost$`DRC_Meningitis`[i]/((1+discount_rate)^(i))
NPV_DRC_DG_vac_del_cost [1,6] <- NPV_DRC_DG_vac_del_cost [1,6]+DRC_DG_vac_del_cost$`DRC_Rota`[i]/((1+discount_rate)^(i))
NPV_DRC_DG_vac_del_cost [1,7] <- NPV_DRC_DG_vac_del_cost [1,7]+DRC_DG_vac_del_cost$`DRC_YF`[i]/((1+discount_rate)^(i))
}
NPV_DRC_DG_vac_del_cost [1,8] <- NPV_DRC_DG_vac_del_cost[1,1] + NPV_DRC_DG_vac_del_cost[1,2] + NPV_DRC_DG_vac_del_cost[1,3] + NPV_DRC_DG_vac_del_cost[1,4] + NPV_DRC_DG_vac_del_cost[1,5] + NPV_DRC_DG_vac_del_cost[1,6] + NPV_DRC_DG_vac_del_cost[1,7]

NPV_DRC_DG_vac_del_cost <- as.data.frame (NPV_DRC_DG_vac_del_cost)


#Total

NPV_Tot_DG_vac_del_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_Tot_DG_vac_del_cost) <- c("NPV_VacDelCost_HepA&HiB", "NPV_VacDelCost_HPV","NPV_VacDelCost_MR","NPV_VacDelCost_PCV","NPV_VacDelCost_Meningitis","NPV_VacDelCost_Rotavirus","NPV_VacDelCost_YF","NPV_VacDelCost_Overall")

NPV_Tot_DG_vac_del_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_Tot_DG_vac_del_cost [1,1] <- NPV_Tot_DG_vac_del_cost [1,1]+Total_DG_vac_del_cost$`Total_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_Tot_DG_vac_del_cost [1,2] <- NPV_Tot_DG_vac_del_cost [1,2]+Total_DG_vac_del_cost$`Total_HPV`[i]/((1+discount_rate)^(i)) 
NPV_Tot_DG_vac_del_cost [1,3] <- NPV_Tot_DG_vac_del_cost [1,3]+Total_DG_vac_del_cost$`Total_MR`[i]/((1+discount_rate)^(i)) 
NPV_Tot_DG_vac_del_cost [1,4] <- NPV_Tot_DG_vac_del_cost [1,4]+Total_DG_vac_del_cost$`Total_PCV`[i]/((1+discount_rate)^(i))   
NPV_Tot_DG_vac_del_cost [1,5] <- NPV_Tot_DG_vac_del_cost [1,5]+Total_DG_vac_del_cost$`Total_Meningitis`[i]/((1+discount_rate)^(i))
NPV_Tot_DG_vac_del_cost [1,6] <- NPV_Tot_DG_vac_del_cost [1,6]+Total_DG_vac_del_cost$`Total_Rota`[i]/((1+discount_rate)^(i))
NPV_Tot_DG_vac_del_cost [1,7] <- NPV_Tot_DG_vac_del_cost [1,7]+Total_DG_vac_del_cost$`Total_YF`[i]/((1+discount_rate)^(i))
}
NPV_Tot_DG_vac_del_cost [1,8] <- NPV_Tot_DG_vac_del_cost[1,1] + NPV_Tot_DG_vac_del_cost[1,2] + NPV_Tot_DG_vac_del_cost[1,3] + NPV_Tot_DG_vac_del_cost[1,4] + NPV_Tot_DG_vac_del_cost[1,5] + NPV_Tot_DG_vac_del_cost[1,6] + NPV_Tot_DG_vac_del_cost[1,7]

NPV_Tot_DG_vac_del_cost <- as.data.frame (NPV_Tot_DG_vac_del_cost)


############### Calculations for Total Vaccine costs ###########################################################################
#Nigeria
NPV_NGA_DG_vac_total_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_NGA_DG_vac_total_cost) <- c("NPV_VacTotCost_HepA&HiB", "NPV_VacTotCost_HPV","NPV_VacTotCost_MR","NPV_VacTotCost_PCV","NPV_VacTotCost_Meningitis","NPV_VacTotCost_Rotavirus","NPV_VacTotCost_YF","NPV_VacTotCost_Overall")

for (i in 1: ncol(NPV_NGA_DG_vac_total_cost)){
  NPV_NGA_DG_vac_total_cost[1,i] <- NPV_NGA_DG_vac_cost [1,i] + NPV_NGA_DG_vac_del_cost [1,i]
  
}
NPV_NGA_DG_vac_total_cost <- as.data.frame(NPV_NGA_DG_vac_total_cost)

#Malawi
NPV_MWI_DG_vac_total_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_MWI_DG_vac_total_cost) <- c("NPV_VacTotCost_HepA&HiB", "NPV_VacTotCost_HPV","NPV_VacTotCost_MR","NPV_VacTotCost_PCV","NPV_VacTotCost_Meningitis","NPV_VacTotCost_Rotavirus","NPV_VacTotCost_YF","NPV_VacTotCost_Overall")

for (i in 1: ncol(NPV_MWI_DG_vac_total_cost)){
  NPV_MWI_DG_vac_total_cost[1,i] <- NPV_MWI_DG_vac_cost [1,i] + NPV_MWI_DG_vac_del_cost [1,i]
  
}
NPV_MWI_DG_vac_total_cost <- as.data.frame(NPV_MWI_DG_vac_total_cost)

#DRC
NPV_DRC_DG_vac_total_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_DRC_DG_vac_total_cost) <- c("NPV_VacTotCost_HepA&HiB", "NPV_VacTotCost_HPV","NPV_VacTotCost_MR","NPV_VacTotCost_PCV","NPV_VacTotCost_Meningitis","NPV_VacTotCost_Rotavirus","NPV_VacTotCost_YF","NPV_VacTotCost_Overall")

for (i in 1: ncol(NPV_DRC_DG_vac_total_cost)){
  NPV_DRC_DG_vac_total_cost[1,i] <- NPV_DRC_DG_vac_cost [1,i] + NPV_DRC_DG_vac_del_cost [1,i]
  
}
NPV_DRC_DG_vac_total_cost <- as.data.frame(NPV_DRC_DG_vac_total_cost)


#Total
NPV_DG_vac_total_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_DG_vac_total_cost) <- c("NPV_VacTotCost_HepA&HiB", "NPV_VacTotCost_HPV","NPV_VacTotCost_MR","NPV_VacTotCost_PCV","NPV_VacTotCost_Meningitis","NPV_VacTotCost_Rotavirus","NPV_VacTotCost_YF","NPV_VacTotCost_Overall")

for (i in 1: ncol(NPV_DG_vac_total_cost)){
  NPV_DG_vac_total_cost[1,i] <- NPV_Tot_DG_vac_cost [1,i] + NPV_Tot_DG_vac_del_cost [1,i]
  
}
NPV_DG_vac_total_cost <- as.data.frame(NPV_DG_vac_total_cost)


### Annualized Costs ###
#Nigeria
Annualized_NGA_DG_vac_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_NGA_DG_vac_cost) <- c("Annualized_VacCost_HepA&HiB", "Annualized_VacCost_HPV","Annualized_VacCost_MR","Annualized_VacCost_PCV","Annualized_VacCost_Meningitis","Annualized_VacCost_Rotavirus","Annualized_VacCost_YF","Annualized_VacCost_Overall")
for (i in 1: ncol(Annualized_NGA_DG_vac_cost)){
  Annualized_NGA_DG_vac_cost[1,i] <- NPV_NGA_DG_vac_cost [1,i]/vaccine_annuity_factor
}

Annualized_NGA_DG_vac_cost <- as.data.frame(Annualized_NGA_DG_vac_cost)

Annualized_NGA_DG_vac_del_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_NGA_DG_vac_del_cost) <- c("Annualized_VacdelCost_HepA&HiB", "Annualized_VacdelCost_HPV","Annualized_VacdelCost_MR","Annualized_VacdelCost_PCV","Annualized_VacdelCost_Meningitis","Annualized_VacdelCost_Rotavirus","Annualized_VacdelCost_YF","Annualized_VacdelCost_Overall")
for (i in 1: ncol(Annualized_NGA_DG_vac_del_cost)){
  Annualized_NGA_DG_vac_del_cost[1,i] <- NPV_NGA_DG_vac_del_cost [1,i]/vaccine_annuity_factor
}
Annualized_NGA_DG_vac_del_cost <- as.data.frame(Annualized_NGA_DG_vac_del_cost)


Annualized_NGA_DG_vac_total_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_NGA_DG_vac_total_cost) <- c("Annualized_VacTotCost_HepA&HiB", "Annualized_VacTotCost_HPV","Annualized_VacTotCost_MR","Annualized_VacTotCost_PCV","Annualized_VacTotCost_Meningitis","Annualized_VacTotCost_Rotavirus","Annualized_VacTotCost_YF","Annualized_VacTotCost_Overall")
for (i in 1: ncol(Annualized_NGA_DG_vac_total_cost)){
  Annualized_NGA_DG_vac_total_cost[1,i] <- NPV_NGA_DG_vac_total_cost [1,i]/vaccine_annuity_factor

}
Annualized_NGA_DG_vac_total_cost <- as.data.frame(Annualized_NGA_DG_vac_total_cost)

#Malawi
Annualized_MWI_DG_vac_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_MWI_DG_vac_cost) <- c("Annualized_VacCost_HepA&HiB", "Annualized_VacCost_HPV","Annualized_VacCost_MR","Annualized_VacCost_PCV","Annualized_VacCost_Meningitis","Annualized_VacCost_Rotavirus","Annualized_VacCost_YF","Annualized_VacCost_Overall")
for (i in 1: ncol(Annualized_MWI_DG_vac_cost)){
  Annualized_MWI_DG_vac_cost[1,i] <- NPV_MWI_DG_vac_cost [1,i]/vaccine_annuity_factor
}

Annualized_MWI_DG_vac_cost <- as.data.frame(Annualized_MWI_DG_vac_cost)

Annualized_MWI_DG_vac_del_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_MWI_DG_vac_del_cost) <- c("Annualized_VacdelCost_HepA&HiB", "Annualized_VacdelCost_HPV","Annualized_VacdelCost_MR","Annualized_VacdelCost_PCV","Annualized_VacdelCost_Meningitis","Annualized_VacdelCost_Rotavirus","Annualized_VacdelCost_YF","Annualized_VacdelCost_Overall")
for (i in 1: ncol(Annualized_MWI_DG_vac_del_cost)){
  Annualized_MWI_DG_vac_del_cost[1,i] <- NPV_MWI_DG_vac_del_cost [1,i]/vaccine_annuity_factor
}
Annualized_MWI_DG_vac_del_cost <- as.data.frame(Annualized_MWI_DG_vac_del_cost)


Annualized_MWI_DG_vac_total_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_MWI_DG_vac_total_cost) <- c("Annualized_VacTotCost_HepA&HiB", "Annualized_VacTotCost_HPV","Annualized_VacTotCost_MR","Annualized_VacTotCost_PCV","Annualized_VacTotCost_Meningitis","Annualized_VacTotCost_Rotavirus","Annualized_VacTotCost_YF","Annualized_VacTotCost_Overall")
for (i in 1: ncol(Annualized_MWI_DG_vac_total_cost)){
  Annualized_MWI_DG_vac_total_cost[1,i] <- NPV_MWI_DG_vac_total_cost [1,i]/vaccine_annuity_factor

}
Annualized_MWI_DG_vac_total_cost <- as.data.frame(Annualized_MWI_DG_vac_total_cost)

#DRC
Annualized_DRC_DG_vac_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DRC_DG_vac_cost) <- c("Annualized_VacCost_HepA&HiB", "Annualized_VacCost_HPV","Annualized_VacCost_MR","Annualized_VacCost_PCV","Annualized_VacCost_Meningitis","Annualized_VacCost_Rotavirus","Annualized_VacCost_YF","Annualized_VacCost_Overall")
for (i in 1: ncol(Annualized_DRC_DG_vac_cost)){
  Annualized_DRC_DG_vac_cost[1,i] <- NPV_DRC_DG_vac_cost [1,i]/vaccine_annuity_factor
}

Annualized_DRC_DG_vac_cost <- as.data.frame(Annualized_DRC_DG_vac_cost)

Annualized_DRC_DG_vac_del_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DRC_DG_vac_del_cost) <- c("Annualized_VacdelCost_HepA&HiB", "Annualized_VacdelCost_HPV","Annualized_VacdelCost_MR","Annualized_VacdelCost_PCV","Annualized_VacdelCost_Meningitis","Annualized_VacdelCost_Rotavirus","Annualized_VacdelCost_YF","Annualized_VacdelCost_Overall")
for (i in 1: ncol(Annualized_DRC_DG_vac_del_cost)){
  Annualized_DRC_DG_vac_del_cost[1,i] <- NPV_DRC_DG_vac_del_cost [1,i]/vaccine_annuity_factor
}
Annualized_DRC_DG_vac_del_cost <- as.data.frame(Annualized_DRC_DG_vac_del_cost)


Annualized_DRC_DG_vac_total_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DRC_DG_vac_total_cost) <- c("Annualized_VacTotCost_HepA&HiB", "Annualized_VacTotCost_HPV","Annualized_VacTotCost_MR","Annualized_VacTotCost_PCV","Annualized_VacTotCost_Meningitis","Annualized_VacTotCost_Rotavirus","Annualized_VacTotCost_YF","Annualized_VacTotCost_Overall")
for (i in 1: ncol(Annualized_DRC_DG_vac_total_cost)){
  Annualized_DRC_DG_vac_total_cost[1,i] <- NPV_DRC_DG_vac_total_cost [1,i]/vaccine_annuity_factor

}
Annualized_DRC_DG_vac_total_cost <- as.data.frame(Annualized_DRC_DG_vac_total_cost)

#Overall
Annualized_DG_vac_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DG_vac_cost) <- c("Annualized_VacCost_HepA&HiB", "Annualized_VacCost_HPV","Annualized_VacCost_MR","Annualized_VacCost_PCV","Annualized_VacCost_Meningitis","Annualized_VacCost_Rotavirus","Annualized_VacCost_YF","Annualized_VacCost_Overall")
for (i in 1: ncol(Annualized_DG_vac_cost)){
  Annualized_DG_vac_cost[1,i] <- NPV_Tot_DG_vac_cost [1,i]/vaccine_annuity_factor
}

Annualized_DG_vac_cost <- as.data.frame(Annualized_DG_vac_cost)

Annualized_DG_vac_del_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DG_vac_del_cost) <- c("Annualized_VacdelCost_HepA&HiB", "Annualized_VacdelCost_HPV","Annualized_VacdelCost_MR","Annualized_VacdelCost_PCV","Annualized_VacdelCost_Meningitis","Annualized_VacdelCost_Rotavirus","Annualized_VacdelCost_YF","Annualized_VacdelCost_Overall")
for (i in 1: ncol(Annualized_DG_vac_del_cost)){
  Annualized_DG_vac_del_cost[1,i] <- NPV_Tot_DG_vac_del_cost [1,i]/vaccine_annuity_factor
}
Annualized_DG_vac_del_cost <- as.data.frame(Annualized_DG_vac_del_cost)


Annualized_DG_vac_total_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DG_vac_total_cost) <- c("Annualized_VacTotCost_HepA&HiB", "Annualized_VacTotCost_HPV","Annualized_VacTotCost_MR","Annualized_VacTotCost_PCV","Annualized_VacTotCost_Meningitis","Annualized_VacTotCost_Rotavirus","Annualized_VacTotCost_YF","Annualized_VacTotCost_Overall")
for (i in 1: ncol(Annualized_DG_vac_total_cost)){
  Annualized_DG_vac_total_cost[1,i] <- NPV_DG_vac_total_cost [1,i]/vaccine_annuity_factor
}
Annualized_DG_vac_total_cost <- as.data.frame(Annualized_DG_vac_total_cost)
#################################################################################################################################

#################################################################################################################################
######################## BENEFIT CALCULATIONS ###################################################################################
#################################################################################################################################

######################## COI Method inputs ######################################################################################
# Cost of illness (COI) Averted ($, 2023; per dose)
# (Ozawa et al., 2017)

vac_COI_NGA_HepA_HiB <- runif(1, 24.45341, 72.95934) #$/dose
vac_COI_MWI_HepA_HiB <- runif(1, 24.45341, 72.95934) #$/dose
vac_COI_DRC_HepA_HiB <- runif(1, 24.45341, 72.95934) #$/dose

vac_COI_NGA_HPV <- runif(1, 61.33395, 106.31218) #$/dose
vac_COI_MWI_HPV <- runif(1, 61.33395, 106.31218) #$/dose
vac_COI_DRC_HPV <- runif(1, 61.33395, 106.31218) #$/dose

vac_COI_NGA_MR <- runif(1, 3.0066, 88.5935) #$/dose
vac_COI_MWI_MR <- runif(1, 3.0066, 88.5935) #$/dose
vac_COI_DRC_MR <- runif(1, 3.0066, 88.5935) #$/dose

vac_COI_NGA_PCV <- runif(1, 48.90681, 84.77181) #$/dose
vac_COI_MWI_PCV <- runif(1, 48.90681, 84.77181) #$/dose
vac_COI_DRC_PCV <- runif(1, 48.90681, 84.77181) #$/dose

vac_COI_NGA_MenA <- runif(1, 30.0657, 52.1138) #$/dose
vac_COI_MWI_MenA <- runif(1, 30.0657, 52.1138) #$/dose
vac_COI_DRC_MenA <- runif(1, 30.0657, 52.1138) #$/dose

vac_COI_NGA_Rota <- runif(1, 14.8324, 25.7095) #$/dose
vac_COI_MWI_Rota <- runif(1, 14.8324, 25.7095) #$/dose
vac_COI_DRC_Rota <- runif(1, 14.8324, 25.7095) #$/dose

vac_COI_NGA_YF <- runif(1, 86.5891, 150.0878) #$/dose
vac_COI_MWI_YF <- runif(1, 86.5891, 150.0878) #$/dose
vac_COI_DRC_YF <- runif(1, 86.5891, 150.0878) #$/dose

######################### VSL Method Inputs #####################################################################################

# Value of Statistical Life (VSL) method (based on Death averted)

USA_VSL <- 22.75595 # $ million, USA VSL 2022 for adult ($11377977.3824) x 2   
USA_GDP <- 76398.5917 #GDP per capita (PPP) current US$, 2022
NGA_GDP <- 5860.2937 #GDP per capita (PPP) current US$, 2022
MWI_GDP <- 1732.0303 #GDP per capita (PPP) current US$, 2022
DRC_GDP <- 1337.3911 #GDP per capita (PPP) current US$, 2022

income_elasticity <- runif(1, 1.1, 2.6) # Robsinson et al. 2019

NGA_VSL <- USA_VSL*((NGA_GDP/USA_GDP)^income_elasticity)
MWI_VSL <- USA_VSL*((MWI_GDP/USA_GDP)^income_elasticity)
DRC_VSL <- USA_VSL*((DRC_GDP/USA_GDP)^income_elasticity)


######################### VSLY Method Inputs ####################################################################################

VSLY_data <- matrix (ncol = 7, nrow = 3)
colnames(VSLY_data) <- c("HepA&HiB", "HPV","MR","PCV","Meningitis","Rotavirus","YF")
rownames(VSLY_data) <- c("NGA", "MWI", "DRC")

HepA_Lifeyears <- 42 #average number of remaining life years for the average person impacted by HepA
HiB_Lifeyears <- 67 #average number of remaining life years for the average person impacted by HiB
HPV_Lifeyears <- 16 #average number of remaining life years for the average person impacted by HPV
Measles_Lifeyears <- 58.5 #average number of remaining life years for the average person impacted by Measles
Rubella_Lifeyears <- 65.5 #average number of remaining life years for the average person impacted by Rubella
PCV_Lifeyears <- 67 #average number of remaining life years for the average person impacted by PCV
Meningitis_Lifeyears <- 61 #average number of remaining life years for the average person impacted by Meningitis
Rota_Lifeyears <- 67 #average number of remaining life years for the average person impacted by Rota virus
YF_Lifeyears <- 48.5 #average number of remaining life years for the average person impacted by Yellow fever

NGA_VSLY_numerator <- discount_rate*NGA_VSL
MWI_VSLY_numerator <- discount_rate*MWI_VSL
DRC_VSLY_numerator <- discount_rate*DRC_VSL


VSLY_data [1,] <- c(mean(NGA_VSLY_numerator/(1-((1+discount_rate)^-HepA_Lifeyears)),NGA_VSLY_numerator/(1-((1+discount_rate)^-HiB_Lifeyears))), NGA_VSLY_numerator/(1-((1+discount_rate)^-HPV_Lifeyears)), mean(NGA_VSLY_numerator/(1-((1+discount_rate)^-Measles_Lifeyears)),NGA_VSLY_numerator/(1-((1+discount_rate)^-Rubella_Lifeyears))), NGA_VSLY_numerator/(1-((1+discount_rate)^-PCV_Lifeyears)), NGA_VSLY_numerator/(1-((1+discount_rate)^-Meningitis_Lifeyears)), NGA_VSLY_numerator/(1-((1+discount_rate)^-Rota_Lifeyears)), NGA_VSLY_numerator/(1-((1+discount_rate)^-YF_Lifeyears)))

VSLY_data [2,] <- c(mean(MWI_VSLY_numerator/(1-((1+discount_rate)^-HepA_Lifeyears)),MWI_VSLY_numerator/(1-((1+discount_rate)^-HiB_Lifeyears))), MWI_VSLY_numerator/(1-((1+discount_rate)^-HPV_Lifeyears)), mean(MWI_VSLY_numerator/(1-((1+discount_rate)^-Measles_Lifeyears)),MWI_VSLY_numerator/(1-((1+discount_rate)^-Rubella_Lifeyears))), MWI_VSLY_numerator/(1-((1+discount_rate)^-PCV_Lifeyears)), MWI_VSLY_numerator/(1-((1+discount_rate)^-Meningitis_Lifeyears)), MWI_VSLY_numerator/(1-((1+discount_rate)^-Rota_Lifeyears)), MWI_VSLY_numerator/(1-((1+discount_rate)^-YF_Lifeyears)))

VSLY_data [3,] <- c(mean(DRC_VSLY_numerator/(1-((1+discount_rate)^-HepA_Lifeyears)),DRC_VSLY_numerator/(1-((1+discount_rate)^-HiB_Lifeyears))), DRC_VSLY_numerator/(1-((1+discount_rate)^-HPV_Lifeyears)), mean(DRC_VSLY_numerator/(1-((1+discount_rate)^-Measles_Lifeyears)),DRC_VSLY_numerator/(1-((1+discount_rate)^-Rubella_Lifeyears))), DRC_VSLY_numerator/(1-((1+discount_rate)^-PCV_Lifeyears)), DRC_VSLY_numerator/(1-((1+discount_rate)^-Meningitis_Lifeyears)), DRC_VSLY_numerator/(1-((1+discount_rate)^-Rota_Lifeyears)), DRC_VSLY_numerator/(1-((1+discount_rate)^-YF_Lifeyears)))

VSLY_data <- as.data.frame(VSLY_data)

############################# COI METHOD #####################################################################################

Nigeria_vac_COI <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Nigeria_vac_COI) <- c("NGA_HepA&HiB", "NGA_HPV","NGA_MR","NGA_PCV","NGA_Meningitis","NGA_Rotavirus","NGA_YF")

Malawi_vac_COI <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Malawi_vac_COI) <- c("MWI_HepA&HiB", "MWI_HPV","MWI_MR","MWI_PCV","MWI_Meningitis","MWI_Rotavirus","MWI_YF")

DRC_vac_COI <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(DRC_vac_COI) <- c("DRC_HepA&HiB", "DRC_HPV","DRC_MR","DRC_PCV","DRC_Meningitis","DRC_Rotavirus","DRC_YF")

Total_vac_COI <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Total_vac_COI) <- c("Total_HepA&HiB", "Total_HPV","Total_MR","Total_PCV","Total_Meningitis","Total_Rotavirus","Total_YF")


for (i in 1:vac_estimation_length){

#HepA_HiB#
  
  Nigeria_vac_COI[i,1] <- Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_HepA_Hib)* vac_recommended_dose_HepA_Hib *vac_COI_NGA_HepA_HiB
Malawi_vac_COI[i,1] <- Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_HepA_Hib)*  vac_recommended_dose_HepA_Hib *vac_COI_MWI_HepA_HiB
DRC_vac_COI[i,1] <- DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_HepA_Hib)* vac_recommended_dose_HepA_Hib *vac_COI_DRC_HepA_HiB
Total_vac_COI [i,1] <- Nigeria_vac_COI[i,1] + Malawi_vac_COI[i,1] + DRC_vac_COI[i,1]

#HPV#

  if (i %in% c(1, 2)) {
    vac_coverage_NGA_HPV_calc = 0
  } else if (i == 3) {
    vac_coverage_NGA_HPV_calc = 0.1407
  } else if (i == 4) {
    vac_coverage_NGA_HPV_calc = 0.1407 * 2
  } else if (i == 5) {
    vac_coverage_NGA_HPV_calc = 0.1407 * 3
  } else if (i > 5) {
    vac_coverage_NGA_HPV_calc = vac_coverage_NGA_HPV
  }

  Nigeria_vac_COI[i, 2] = Nigeria_pop$`Nigeria_Female_10to14(million)`[i] * vac_coverage_NGA_HPV_calc * vac_recommended_dose_HPV * vac_COI_NGA_HPV
  
  if (i ==1) {
    vac_coverage_MWI_HPV_calc = 0.12
  } else if (i == 2) {
    vac_coverage_MWI_HPV_calc = 0.1407
  } else if (i == 3) {
    vac_coverage_MWI_HPV_calc = 0.1407 * 2
  } else if (i == 4) {
    vac_coverage_MWI_HPV_calc = 0.1407 * 3
  } else if (i > 4) {
    vac_coverage_MWI_HPV_calc = vac_coverage_MWI_HPV
  }

  Malawi_vac_COI[i, 2] = Malawi_pop$`Malawi_Female_10to14(million)`[i] * vac_coverage_MWI_HPV_calc * vac_recommended_dose_HPV * vac_COI_MWI_HPV
  
  if (i %in% c(1, 2)) {
    vac_coverage_DRC_HPV_calc = 0
  } else if (i == 3) {
    vac_coverage_DRC_HPV_calc = 0.1407
  } else if (i == 4) {
    vac_coverage_DRC_HPV_calc = 0.1407 * 2
  } else if (i == 5) {
    vac_coverage_DRC_HPV_calc = 0.1407 * 3
  } else if (i > 5) {
    vac_coverage_DRC_HPV_calc = vac_coverage_DRC_HPV
  }

  DRC_vac_COI[i, 2] = DRC_pop$`DRC_Female_10to14(million)`[i] * vac_coverage_DRC_HPV_calc * vac_recommended_dose_HPV * vac_COI_DRC_HPV

  Total_vac_COI [i,2] <- Nigeria_vac_COI[i,2] + Malawi_vac_COI[i,2] + DRC_vac_COI[i,2]
  
#Measles and Rubella#

  Nigeria_vac_COI [i,3] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_MR)*vac_recommended_dose_MR*vac_COI_NGA_MR
  
  Malawi_vac_COI [i,3] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_MR)*vac_recommended_dose_MR*vac_COI_MWI_MR
  
  DRC_vac_COI [i,3] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_MR)*vac_recommended_dose_MR*vac_COI_DRC_MR
  
   Total_vac_COI [i,3] <- Nigeria_vac_COI[i,3] + Malawi_vac_COI[i,3] + DRC_vac_COI[i,3]

#PCV#

  Nigeria_vac_COI [i,4] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_PCV)*vac_recommended_dose_PCV*vac_COI_NGA_PCV
  
  Malawi_vac_COI [i,4] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_PCV)*vac_recommended_dose_PCV*vac_COI_MWI_PCV
  
  DRC_vac_COI [i,4] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_PCV)*vac_recommended_dose_PCV*vac_COI_DRC_PCV
  
  Total_vac_COI [i,4] <- Nigeria_vac_COI[i,4] + Malawi_vac_COI[i,4] + DRC_vac_COI[i,4]

#Menningitis A#

  if (i == 1) {
    vac_coverage_NGA_MenA_calc = 0.5
  } else if (i > 1) {
    vac_coverage_NGA_MenA_calc = vac_coverage_NGA_MenA
  }

  Nigeria_vac_COI[i, 5] = Nigeria_pop$`Nigeria_New_born(million)`[i] * vac_coverage_NGA_MenA_calc * vac_recommended_dose_MenA * vac_COI_NGA_MenA
  
  Malawi_vac_COI[i, 5] = Malawi_pop$`Malawi_New_born(million)`[i] * vac_coverage_MWI_MenA * vac_recommended_dose_MenA * vac_COI_MWI_MenA
  
DRC_vac_COI[i, 5] = DRC_pop$`DRC_New_born(million)`[i] * vac_coverage_DRC_MenA * vac_recommended_dose_MenA * vac_COI_DRC_MenA

Total_vac_COI [i,5] <- Nigeria_vac_COI[i,5] + Malawi_vac_COI[i,5] + DRC_vac_COI[i,5]
    
#Rota#

  if (i == 1) {
    vac_coverage_NGA_Rota_calc = 0
  } else if (i == 2) {
    vac_coverage_NGA_Rota_calc = 0.12
  } else if (i == 3) {
    vac_coverage_NGA_Rota_calc = 0.12*2
  } else if (i == 4) {
    vac_coverage_NGA_Rota_calc = 0.12*4
  } else if (i > 4) {
    vac_coverage_NGA_Rota_calc = vac_coverage_NGA_Rota
  }

  Nigeria_vac_COI[i, 6] = Nigeria_pop$`Nigeria_New_born(million)`[i] * vac_coverage_NGA_Rota_calc * vac_recommended_dose_Rota * vac_COI_NGA_Rota
  
  Malawi_vac_COI[i, 6] = Malawi_pop$`Malawi_New_born(million)`[i] * vac_coverage_MWI_Rota * vac_recommended_dose_Rota_MWI * vac_COI_MWI_Rota
  
  DRC_vac_COI[i, 6] = DRC_pop$`DRC_New_born(million)`[i] * vac_coverage_DRC_Rota * vac_recommended_dose_Rota * vac_COI_DRC_Rota
  
  Total_vac_COI [i,6] <- Nigeria_vac_COI[i,6] + Malawi_vac_COI[i,6] + DRC_vac_COI[i,6]

#Yellow Fever#

  Nigeria_vac_COI [i,7] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_YF)*vac_recommended_dose_YF*vac_COI_NGA_YF
  
  Malawi_vac_COI [i,7] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_YF)*vac_recommended_dose_YF*vac_COI_MWI_YF
  
  DRC_vac_COI [i,7] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_YF)*vac_recommended_dose_YF*vac_COI_DRC_YF 

Total_vac_COI [i,7] <- Nigeria_vac_COI[i,7] + Malawi_vac_COI[i,7] + DRC_vac_COI[i,7]
  
  }

Nigeria_vac_COI <- as.data.frame(Nigeria_vac_COI)
Malawi_vac_COI <- as.data.frame(Malawi_vac_COI)
DRC_vac_COI <- as.data.frame(DRC_vac_COI)
Total_vac_COI <- as.data.frame(Total_vac_COI)

###NPV Calculations
#Nigeria
NPV_NGA_vac_COI <- matrix(ncol = 8, nrow = 1)

colnames(NPV_NGA_vac_COI) <- c("NPV_VacCOI_HepA&HiB", "NPV_VacCOI_HPV","NPV_VacCOI_MR","NPV_VacCOI_PCV","NPV_VacCOI_Meningitis","NPV_VacCOI_Rotavirus","NPV_VacCOI_YF","NPV_VacCOI_Overall")

NPV_NGA_vac_COI[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_NGA_vac_COI [1,1] <- NPV_NGA_vac_COI [1,1]+Nigeria_vac_COI$`NGA_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_COI [1,2] <- NPV_NGA_vac_COI [1,2]+Nigeria_vac_COI$`NGA_HPV`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_COI [1,3] <- NPV_NGA_vac_COI [1,3]+Nigeria_vac_COI$`NGA_MR`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_COI [1,4] <- NPV_NGA_vac_COI [1,4]+Nigeria_vac_COI$`NGA_PCV`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_COI [1,5] <- NPV_NGA_vac_COI [1,5]+Nigeria_vac_COI$`NGA_Meningitis`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_COI [1,6] <- NPV_NGA_vac_COI [1,6]+Nigeria_vac_COI$`NGA_Rota`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_COI [1,7] <- NPV_NGA_vac_COI [1,7]+Nigeria_vac_COI$`NGA_YF`[i]/((1+discount_rate)^(i))
}
NPV_NGA_vac_COI [1,8] <- NPV_NGA_vac_COI[1,1] + NPV_NGA_vac_COI[1,2] + NPV_NGA_vac_COI[1,3] + NPV_NGA_vac_COI[1,4] + NPV_NGA_vac_COI[1,5] + NPV_NGA_vac_COI[1,6] + NPV_NGA_vac_COI[1,7]

NPV_NGA_vac_COI <- as.data.frame (NPV_NGA_vac_COI)

Annualized_NGA_vac_COI <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_NGA_vac_COI) <- c("Annualized_VacCOI_HepA&HiB", "Annualized_VacCOI_HPV","Annualized_VacCOI_MR","Annualized_VacCOI_PCV","Annualized_VacCOI_Meningitis","Annualized_VacCOI_Rotavirus","Annualized_VacCOI_YF","Annualized_VacCOI_Overall")
for (i in 1: ncol(Annualized_NGA_vac_COI)){
  Annualized_NGA_vac_COI[1,i] <- NPV_NGA_vac_COI [1,i]/vaccine_annuity_factor
}

Annualized_NGA_vac_COI <- as.data.frame(Annualized_NGA_vac_COI)

#Malawi
NPV_MWI_vac_COI <- matrix(ncol = 8, nrow = 1)

colnames(NPV_MWI_vac_COI) <- c("NPV_VacCOI_HepA&HiB", "NPV_VacCOI_HPV","NPV_VacCOI_MR","NPV_VacCOI_PCV","NPV_VacCOI_Meningitis","NPV_VacCOI_Rotavirus","NPV_VacCOI_YF","NPV_VacCOI_Overall")

NPV_MWI_vac_COI[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_MWI_vac_COI [1,1] <- NPV_MWI_vac_COI [1,1]+Malawi_vac_COI$`MWI_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_COI [1,2] <- NPV_MWI_vac_COI [1,2]+Malawi_vac_COI$`MWI_HPV`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_COI [1,3] <- NPV_MWI_vac_COI [1,3]+Malawi_vac_COI$`MWI_MR`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_COI [1,4] <- NPV_MWI_vac_COI [1,4]+Malawi_vac_COI$`MWI_PCV`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_COI [1,5] <- NPV_MWI_vac_COI [1,5]+Malawi_vac_COI$`MWI_Meningitis`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_COI [1,6] <- NPV_MWI_vac_COI [1,6]+Malawi_vac_COI$`MWI_Rota`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_COI [1,7] <- NPV_MWI_vac_COI [1,7]+Malawi_vac_COI$`MWI_YF`[i]/((1+discount_rate)^(i))
}
NPV_MWI_vac_COI [1,8] <- NPV_MWI_vac_COI[1,1] + NPV_MWI_vac_COI[1,2] + NPV_MWI_vac_COI[1,3] + NPV_MWI_vac_COI[1,4] + NPV_MWI_vac_COI[1,5] + NPV_MWI_vac_COI[1,6] + NPV_MWI_vac_COI[1,7]

NPV_MWI_vac_COI <- as.data.frame (NPV_MWI_vac_COI)

Annualized_MWI_vac_COI <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_MWI_vac_COI) <- c("Annualized_VacCOI_HepA&HiB", "Annualized_VacCOI_HPV","Annualized_VacCOI_MR","Annualized_VacCOI_PCV","Annualized_VacCOI_Meningitis","Annualized_VacCOI_Rotavirus","Annualized_VacCOI_YF","Annualized_VacCOI_Overall")
for (i in 1: ncol(Annualized_MWI_vac_COI)){
  Annualized_MWI_vac_COI[1,i] <- NPV_MWI_vac_COI [1,i]/vaccine_annuity_factor
}

Annualized_MWI_vac_COI <- as.data.frame(Annualized_MWI_vac_COI)


#DRC
NPV_DRC_vac_COI <- matrix(ncol = 8, nrow = 1)

colnames(NPV_DRC_vac_COI) <- c("NPV_VacCOI_HepA&HiB", "NPV_VacCOI_HPV","NPV_VacCOI_MR","NPV_VacCOI_PCV","NPV_VacCOI_Meningitis","NPV_VacCOI_Rotavirus","NPV_VacCOI_YF","NPV_VacCOI_Overall")

NPV_DRC_vac_COI[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_DRC_vac_COI [1,1] <- NPV_DRC_vac_COI [1,1]+DRC_vac_COI$`DRC_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_COI [1,2] <- NPV_DRC_vac_COI [1,2]+DRC_vac_COI$`DRC_HPV`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_COI [1,3] <- NPV_DRC_vac_COI [1,3]+DRC_vac_COI$`DRC_MR`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_COI [1,4] <- NPV_DRC_vac_COI [1,4]+DRC_vac_COI$`DRC_PCV`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_COI [1,5] <- NPV_DRC_vac_COI [1,5]+DRC_vac_COI$`DRC_Meningitis`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_COI [1,6] <- NPV_DRC_vac_COI [1,6]+DRC_vac_COI$`DRC_Rota`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_COI [1,7] <- NPV_DRC_vac_COI [1,7]+DRC_vac_COI$`DRC_YF`[i]/((1+discount_rate)^(i))
}
NPV_DRC_vac_COI [1,8] <- NPV_DRC_vac_COI[1,1] + NPV_DRC_vac_COI[1,2] + NPV_DRC_vac_COI[1,3] + NPV_DRC_vac_COI[1,4] + NPV_DRC_vac_COI[1,5] + NPV_DRC_vac_COI[1,6] + NPV_DRC_vac_COI[1,7]

NPV_DRC_vac_COI <- as.data.frame (NPV_DRC_vac_COI)

Annualized_DRC_vac_COI <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DRC_vac_COI) <- c("Annualized_VacCOI_HepA&HiB", "Annualized_VacCOI_HPV","Annualized_VacCOI_MR","Annualized_VacCOI_PCV","Annualized_VacCOI_Meningitis","Annualized_VacCOI_Rotavirus","Annualized_VacCOI_YF","Annualized_VacCOI_Overall")
for (i in 1: ncol(Annualized_DRC_vac_COI)){
  Annualized_DRC_vac_COI[1,i] <- NPV_DRC_vac_COI [1,i]/vaccine_annuity_factor
}

Annualized_DRC_vac_COI <- as.data.frame(Annualized_DRC_vac_COI)


#Overall

NPV_vac_COI <- matrix(ncol = 8, nrow = 1)

colnames(NPV_vac_COI) <- c("NPV_VacCOI_HepA&HiB", "NPV_VacCOI_HPV","NPV_VacCOI_MR","NPV_VacCOI_PCV","NPV_VacCOI_Meningitis","NPV_VacCOI_Rotavirus","NPV_VacCOI_YF","NPV_VacCOI_Overall")

NPV_vac_COI[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_vac_COI [1,1] <- NPV_vac_COI [1,1]+Total_vac_COI$`Total_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_vac_COI [1,2] <- NPV_vac_COI [1,2]+Total_vac_COI$`Total_HPV`[i]/((1+discount_rate)^(i)) 
NPV_vac_COI [1,3] <- NPV_vac_COI [1,3]+Total_vac_COI$`Total_MR`[i]/((1+discount_rate)^(i)) 
NPV_vac_COI [1,4] <- NPV_vac_COI [1,4]+Total_vac_COI$`Total_PCV`[i]/((1+discount_rate)^(i))   
NPV_vac_COI [1,5] <- NPV_vac_COI [1,5]+Total_vac_COI$`Total_Meningitis`[i]/((1+discount_rate)^(i))
NPV_vac_COI [1,6] <- NPV_vac_COI [1,6]+Total_vac_COI$`Total_Rota`[i]/((1+discount_rate)^(i))
NPV_vac_COI [1,7] <- NPV_vac_COI [1,7]+Total_vac_COI$`Total_YF`[i]/((1+discount_rate)^(i))
}
NPV_vac_COI [1,8] <- NPV_vac_COI[1,1] + NPV_vac_COI[1,2] + NPV_vac_COI[1,3] + NPV_vac_COI[1,4] + NPV_vac_COI[1,5] + NPV_vac_COI[1,6] + NPV_vac_COI[1,7]

NPV_vac_COI <- as.data.frame (NPV_vac_COI)

Annualized_vac_COI <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_vac_COI) <- c("Annualized_VacCOI_HepA&HiB", "Annualized_VacCOI_HPV","Annualized_VacCOI_MR","Annualized_VacCOI_PCV","Annualized_VacCOI_Meningitis","Annualized_VacCOI_Rotavirus","Annualized_VacCOI_YF","Annualized_VacCOI_Overall")
for (i in 1: ncol(Annualized_vac_COI)){
  Annualized_vac_COI[1,i] <- NPV_vac_COI [1,i]/vaccine_annuity_factor
}

Annualized_vac_COI <- as.data.frame(Annualized_vac_COI)


######################## VSL Method calculations ##################################################################################

NGA_col_names <- c("NGA_HepA&HiB", "NGA_HPV", "NGA_MR", "NGA_PCV", "NGA_Meningitis", "NGA_Rotavirus", "NGA_YF")

current_variation_NGA <- NGA_death_averted
for (i in 1:vac_estimation_length){
  for (k in 1:length(NGA_col_names)){
    disease_col <- NGA_col_names[k]
    disease_index <- which(colnames(current_variation_NGA) == disease_col)
    low_bound <- current_variation_NGA[i, (disease_index+1)]
    high_bound <- current_variation_NGA[i, (disease_index+2)]
    current_variation_NGA[i, disease_index] <- runif(1, low_bound, high_bound)
  }
}

Nigeria_vac_VSL <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Nigeria_vac_VSL) <- c("NGA_HepA&HiB", "NGA_HPV","NGA_MR","NGA_PCV","NGA_Meningitis","NGA_Rotavirus","NGA_YF")

for (i in 1:vac_estimation_length){
  
  Nigeria_vac_VSL[i,1] <- current_variation_NGA$`NGA_HepA&HiB`[i]*NGA_VSL
  Nigeria_vac_VSL[i,2] <- current_variation_NGA$NGA_HPV[i]*NGA_VSL
  Nigeria_vac_VSL[i,3] <- current_variation_NGA$NGA_MR[i]*NGA_VSL
  Nigeria_vac_VSL[i,4] <- current_variation_NGA$NGA_PCV[i]*NGA_VSL
  Nigeria_vac_VSL[i,5] <- current_variation_NGA$NGA_Meningitis[i]*NGA_VSL
  Nigeria_vac_VSL[i,6] <- current_variation_NGA$NGA_Rotavirus[i]*NGA_VSL
  Nigeria_vac_VSL[i,7] <- current_variation_NGA$NGA_YF[i]*NGA_VSL
}

Nigeria_vac_VSL <- as.data.frame(Nigeria_vac_VSL)
 

MWI_col_names <- c("MWI_HepA&HiB", "MWI_HPV", "MWI_MR", "MWI_PCV", "MWI_Meningitis", "MWI_Rotavirus", "MWI_YF")

current_variation_MWI <- MWI_death_averted
for (i in 1:vac_estimation_length){
  for (k in 1:length(MWI_col_names)){
    disease_col <- MWI_col_names[k]
    disease_index <- which(colnames(current_variation_MWI) == disease_col)
    low_bound <- current_variation_MWI[i, (disease_index+1)]
    high_bound <- current_variation_MWI[i, (disease_index+2)]
    current_variation_MWI[i, disease_index] <- runif(1, low_bound, high_bound)
  }
}

Malawi_vac_VSL <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Malawi_vac_VSL) <- c("MWI_HepA&HiB", "MWI_HPV","MWI_MR","MWI_PCV","MWI_Meningitis","MWI_Rotavirus","MWI_YF")

for (i in 1:vac_estimation_length){
  
  Malawi_vac_VSL[i,1] <- current_variation_MWI$`MWI_HepA&HiB`[i]*MWI_VSL
  Malawi_vac_VSL[i,2] <- current_variation_MWI$MWI_HPV[i]*MWI_VSL
  Malawi_vac_VSL[i,3] <- current_variation_MWI$MWI_MR[i]*MWI_VSL
  Malawi_vac_VSL[i,4] <- current_variation_MWI$MWI_PCV[i]*MWI_VSL
  Malawi_vac_VSL[i,5] <- current_variation_MWI$MWI_Meningitis[i]*MWI_VSL
  Malawi_vac_VSL[i,6] <- current_variation_MWI$MWI_Rotavirus[i]*MWI_VSL
  Malawi_vac_VSL[i,7] <- current_variation_MWI$MWI_YF[i]*MWI_VSL
}

Malawi_vac_VSL <- as.data.frame(Malawi_vac_VSL)


DRC_col_names <- c("DRC_HepA&HiB", "DRC_HPV", "DRC_MR", "DRC_PCV", "DRC_Meningitis", "DRC_Rotavirus", "DRC_YF")

current_variation_DRC <- DRC_death_averted
for (i in 1:vac_estimation_length){
  for (k in 1:length(DRC_col_names)){
    disease_col <- DRC_col_names[k]
    disease_index <- which(colnames(current_variation_DRC) == disease_col)
    low_bound <- current_variation_DRC[i, (disease_index+1)]
    high_bound <- current_variation_DRC[i, (disease_index+2)]
    current_variation_DRC[i, disease_index] <- runif(1, low_bound, high_bound)
  }
}

DRC_vac_VSL <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(DRC_vac_VSL) <- c("DRC_HepA&HiB", "DRC_HPV","DRC_MR","DRC_PCV","DRC_Meningitis","DRC_Rotavirus","DRC_YF")

for (i in 1:vac_estimation_length){
  
  DRC_vac_VSL[i,1] <- current_variation_DRC$`DRC_HepA&HiB`[i]*DRC_VSL
  DRC_vac_VSL[i,2] <- current_variation_DRC$DRC_HPV[i]*DRC_VSL
  DRC_vac_VSL[i,3] <- current_variation_DRC$DRC_MR[i]*DRC_VSL
  DRC_vac_VSL[i,4] <- current_variation_DRC$DRC_PCV[i]*DRC_VSL
  DRC_vac_VSL[i,5] <- current_variation_DRC$DRC_Meningitis[i]*DRC_VSL
  DRC_vac_VSL[i,6] <- current_variation_DRC$DRC_Rotavirus[i]*DRC_VSL
  DRC_vac_VSL[i,7] <- current_variation_DRC$DRC_YF[i]*DRC_VSL
}

DRC_vac_VSL <- as.data.frame(DRC_vac_VSL)

Total_vac_VSL <- Nigeria_vac_VSL + Malawi_vac_VSL + DRC_vac_VSL
colnames(Total_vac_VSL) <- c("Total_HepA&HiB", "Total_HPV","Total_MR","Total_PCV","Total_Meningitis","Total_Rotavirus","Total_YF")

###NPV calculations
#Nigeria
NPV_NGA_vac_VSL <- matrix(ncol = 8, nrow = 1)

colnames(NPV_NGA_vac_VSL) <- c("NPV_VacVSL_HepA&HiB", "NPV_VacVSL_HPV","NPV_VacVSL_MR","NPV_VacVSL_PCV","NPV_VacVSL_Meningitis","NPV_VacVSL_Rotavirus","NPV_VacVSL_YF","NPV_VacVSL_Overall")

NPV_NGA_vac_VSL[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_NGA_vac_VSL [1,1] <- NPV_NGA_vac_VSL [1,1]+Nigeria_vac_VSL$`NGA_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_VSL [1,2] <- NPV_NGA_vac_VSL [1,2]+Nigeria_vac_VSL$`NGA_HPV`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_VSL [1,3] <- NPV_NGA_vac_VSL [1,3]+Nigeria_vac_VSL$`NGA_MR`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_VSL [1,4] <- NPV_NGA_vac_VSL [1,4]+Nigeria_vac_VSL$`NGA_PCV`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_VSL [1,5] <- NPV_NGA_vac_VSL [1,5]+Nigeria_vac_VSL$`NGA_Meningitis`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_VSL [1,6] <- NPV_NGA_vac_VSL [1,6]+Nigeria_vac_VSL$`NGA_Rota`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_VSL [1,7] <- NPV_NGA_vac_VSL [1,7]+Nigeria_vac_VSL$`NGA_YF`[i]/((1+discount_rate)^(i))
}
NPV_NGA_vac_VSL [1,8] <- NPV_NGA_vac_VSL[1,1] + NPV_NGA_vac_VSL[1,2] + NPV_NGA_vac_VSL[1,3] + NPV_NGA_vac_VSL[1,4] + NPV_NGA_vac_VSL[1,5] + NPV_NGA_vac_VSL[1,6] + NPV_NGA_vac_VSL[1,7]

NPV_NGA_vac_VSL <- as.data.frame (NPV_NGA_vac_VSL)

Annualized_NGA_vac_VSL <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_NGA_vac_VSL) <- c("Annualized_VacVSL_HepA&HiB", "Annualized_VacVSL_HPV","Annualized_VacVSL_MR","Annualized_VacVSL_PCV","Annualized_VacVSL_Meningitis","Annualized_VacVSL_Rotavirus","Annualized_VacVSL_YF","Annualized_VacVSL_Overall")
for (i in 1: ncol(Annualized_NGA_vac_VSL)){
  Annualized_NGA_vac_VSL[1,i] <- NPV_NGA_vac_VSL [1,i]/vaccine_annuity_factor
}

Annualized_NGA_vac_VSL <- as.data.frame(Annualized_NGA_vac_VSL)

#Malawi
NPV_MWI_vac_VSL <- matrix(ncol = 8, nrow = 1)

colnames(NPV_MWI_vac_VSL) <- c("NPV_VacVSL_HepA&HiB", "NPV_VacVSL_HPV","NPV_VacVSL_MR","NPV_VacVSL_PCV","NPV_VacVSL_Meningitis","NPV_VacVSL_Rotavirus","NPV_VacVSL_YF","NPV_VacVSL_Overall")

NPV_MWI_vac_VSL[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_MWI_vac_VSL [1,1] <- NPV_MWI_vac_VSL [1,1]+Malawi_vac_VSL$`MWI_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_VSL [1,2] <- NPV_MWI_vac_VSL [1,2]+Malawi_vac_VSL$`MWI_HPV`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_VSL [1,3] <- NPV_MWI_vac_VSL [1,3]+Malawi_vac_VSL$`MWI_MR`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_VSL [1,4] <- NPV_MWI_vac_VSL [1,4]+Malawi_vac_VSL$`MWI_PCV`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_VSL [1,5] <- NPV_MWI_vac_VSL [1,5]+Malawi_vac_VSL$`MWI_Meningitis`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_VSL [1,6] <- NPV_MWI_vac_VSL [1,6]+Malawi_vac_VSL$`MWI_Rota`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_VSL [1,7] <- NPV_MWI_vac_VSL [1,7]+Malawi_vac_VSL$`MWI_YF`[i]/((1+discount_rate)^(i))
}
NPV_MWI_vac_VSL [1,8] <- NPV_MWI_vac_VSL[1,1] + NPV_MWI_vac_VSL[1,2] + NPV_MWI_vac_VSL[1,3] + NPV_MWI_vac_VSL[1,4] + NPV_MWI_vac_VSL[1,5] + NPV_MWI_vac_VSL[1,6] + NPV_MWI_vac_VSL[1,7]

NPV_MWI_vac_VSL <- as.data.frame (NPV_MWI_vac_VSL)

Annualized_MWI_vac_VSL <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_MWI_vac_VSL) <- c("Annualized_VacVSL_HepA&HiB", "Annualized_VacVSL_HPV","Annualized_VacVSL_MR","Annualized_VacVSL_PCV","Annualized_VacVSL_Meningitis","Annualized_VacVSL_Rotavirus","Annualized_VacVSL_YF","Annualized_VacVSL_Overall")
for (i in 1: ncol(Annualized_MWI_vac_VSL)){
  Annualized_MWI_vac_VSL[1,i] <- NPV_MWI_vac_VSL [1,i]/vaccine_annuity_factor
}

Annualized_MWI_vac_VSL <- as.data.frame(Annualized_MWI_vac_VSL)

#DRC
NPV_DRC_vac_VSL <- matrix(ncol = 8, nrow = 1)

colnames(NPV_DRC_vac_VSL) <- c("NPV_VacVSL_HepA&HiB", "NPV_VacVSL_HPV","NPV_VacVSL_MR","NPV_VacVSL_PCV","NPV_VacVSL_Meningitis","NPV_VacVSL_Rotavirus","NPV_VacVSL_YF","NPV_VacVSL_Overall")

NPV_DRC_vac_VSL[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_DRC_vac_VSL [1,1] <- NPV_DRC_vac_VSL [1,1]+DRC_vac_VSL$`DRC_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_VSL [1,2] <- NPV_DRC_vac_VSL [1,2]+DRC_vac_VSL$`DRC_HPV`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_VSL [1,3] <- NPV_DRC_vac_VSL [1,3]+DRC_vac_VSL$`DRC_MR`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_VSL [1,4] <- NPV_DRC_vac_VSL [1,4]+DRC_vac_VSL$`DRC_PCV`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_VSL [1,5] <- NPV_DRC_vac_VSL [1,5]+DRC_vac_VSL$`DRC_Meningitis`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_VSL [1,6] <- NPV_DRC_vac_VSL [1,6]+DRC_vac_VSL$`DRC_Rota`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_VSL [1,7] <- NPV_DRC_vac_VSL [1,7]+DRC_vac_VSL$`DRC_YF`[i]/((1+discount_rate)^(i))
}
NPV_DRC_vac_VSL [1,8] <- NPV_DRC_vac_VSL[1,1] + NPV_DRC_vac_VSL[1,2] + NPV_DRC_vac_VSL[1,3] + NPV_DRC_vac_VSL[1,4] + NPV_DRC_vac_VSL[1,5] + NPV_DRC_vac_VSL[1,6] + NPV_DRC_vac_VSL[1,7]

NPV_DRC_vac_VSL <- as.data.frame (NPV_DRC_vac_VSL)

Annualized_DRC_vac_VSL <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DRC_vac_VSL) <- c("Annualized_VacVSL_HepA&HiB", "Annualized_VacVSL_HPV","Annualized_VacVSL_MR","Annualized_VacVSL_PCV","Annualized_VacVSL_Meningitis","Annualized_VacVSL_Rotavirus","Annualized_VacVSL_YF","Annualized_VacVSL_Overall")
for (i in 1: ncol(Annualized_DRC_vac_VSL)){
  Annualized_DRC_vac_VSL[1,i] <- NPV_DRC_vac_VSL [1,i]/vaccine_annuity_factor
}

Annualized_DRC_vac_VSL <- as.data.frame(Annualized_DRC_vac_VSL)

#Overall
NPV_vac_VSL <- matrix(ncol = 8, nrow = 1)

colnames(NPV_vac_VSL) <- c("NPV_VacVSL_HepA&HiB", "NPV_VacVSL_HPV","NPV_VacVSL_MR","NPV_VacVSL_PCV","NPV_VacVSL_Meningitis","NPV_VacVSL_Rotavirus","NPV_VacVSL_YF","NPV_VacVSL_Overall")

NPV_vac_VSL[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_vac_VSL [1,1] <- NPV_vac_VSL [1,1]+Total_vac_VSL$`Total_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_vac_VSL [1,2] <- NPV_vac_VSL [1,2]+Total_vac_VSL$`Total_HPV`[i]/((1+discount_rate)^(i)) 
NPV_vac_VSL [1,3] <- NPV_vac_VSL [1,3]+Total_vac_VSL$`Total_MR`[i]/((1+discount_rate)^(i)) 
NPV_vac_VSL [1,4] <- NPV_vac_VSL [1,4]+Total_vac_VSL$`Total_PCV`[i]/((1+discount_rate)^(i))   
NPV_vac_VSL [1,5] <- NPV_vac_VSL [1,5]+Total_vac_VSL$`Total_Meningitis`[i]/((1+discount_rate)^(i))
NPV_vac_VSL [1,6] <- NPV_vac_VSL [1,6]+Total_vac_VSL$`Total_Rota`[i]/((1+discount_rate)^(i))
NPV_vac_VSL [1,7] <- NPV_vac_VSL [1,7]+Total_vac_VSL$`Total_YF`[i]/((1+discount_rate)^(i))
}
NPV_vac_VSL [1,8] <- NPV_vac_VSL[1,1] + NPV_vac_VSL[1,2] + NPV_vac_VSL[1,3] + NPV_vac_VSL[1,4] + NPV_vac_VSL[1,5] + NPV_vac_VSL[1,6] + NPV_vac_VSL[1,7]

NPV_vac_VSL <- as.data.frame (NPV_vac_VSL)

Annualized_vac_VSL <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_vac_VSL) <- c("Annualized_VacVSL_HepA&HiB", "Annualized_VacVSL_HPV","Annualized_VacVSL_MR","Annualized_VacVSL_PCV","Annualized_VacVSL_Meningitis","Annualized_VacVSL_Rotavirus","Annualized_VacVSL_YF","Annualized_VacVSL_Overall")
for (i in 1: ncol(Annualized_vac_VSL)){
  Annualized_vac_VSL[1,i] <- NPV_vac_VSL [1,i]/vaccine_annuity_factor
}

Annualized_vac_VSL <- as.data.frame(Annualized_vac_VSL)

######################## VSLY Method calculations #################################################################################

NGA_col_names <- c("NGA_HepA&HiB", "NGA_HPV", "NGA_MR", "NGA_PCV", "NGA_Meningitis", "NGA_Rotavirus", "NGA_YF")

current_DALY_var_NGA <- NGA_DALY_averted
for (i in 1:vac_estimation_length){
  for (k in 1:length(NGA_col_names)){
    disease_col <- NGA_col_names[k]
    disease_index <- which(colnames(current_DALY_var_NGA) == disease_col)
    low_bound <- current_DALY_var_NGA[i, (disease_index+1)]
    high_bound <- current_DALY_var_NGA[i, (disease_index+2)]
    current_DALY_var_NGA[i, disease_index] <- runif(1, low_bound, high_bound)
  }
}

Nigeria_vac_VSLY <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Nigeria_vac_VSLY) <- c("NGA_HepA&HiB", "NGA_HPV","NGA_MR","NGA_PCV","NGA_Meningitis","NGA_Rotavirus","NGA_YF")

for (i in 1:vac_estimation_length){
  
  Nigeria_vac_VSLY[i,1] <- current_DALY_var_NGA$`NGA_HepA&HiB`[i]*VSLY_data[1,1]
  Nigeria_vac_VSLY[i,2] <- current_DALY_var_NGA$NGA_HPV[i]*VSLY_data[1,2]
  Nigeria_vac_VSLY[i,3] <- current_DALY_var_NGA$NGA_MR[i]*VSLY_data[1,3]
  Nigeria_vac_VSLY[i,4] <- current_DALY_var_NGA$NGA_PCV[i]*VSLY_data[1,4]
  Nigeria_vac_VSLY[i,5] <- current_DALY_var_NGA$NGA_Meningitis[i]*VSLY_data[1,5]
  Nigeria_vac_VSLY[i,6] <- current_DALY_var_NGA$NGA_Rotavirus[i]*VSLY_data[1,6]
  Nigeria_vac_VSLY[i,7] <- current_DALY_var_NGA$NGA_YF[i]*VSLY_data[1,7]
}

Nigeria_vac_VSLY <- as.data.frame(Nigeria_vac_VSLY)


MWI_col_names <- c("MWI_HepA&HiB", "MWI_HPV", "MWI_MR", "MWI_PCV", "MWI_Meningitis", "MWI_Rotavirus", "MWI_YF")

current_DALY_var_MWI <- MWI_DALY_averted
for (i in 1:vac_estimation_length){
  for (k in 1:length(MWI_col_names)){
    disease_col <- MWI_col_names[k]
    disease_index <- which(colnames(current_DALY_var_MWI) == disease_col)
    low_bound <- current_DALY_var_MWI[i, (disease_index+1)]
    high_bound <- current_DALY_var_MWI[i, (disease_index+2)]
    current_DALY_var_MWI[i, disease_index] <- runif(1, low_bound, high_bound)
  }
}

Malawi_vac_VSLY <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Malawi_vac_VSLY) <- c("MWI_HepA&HiB", "MWI_HPV","MWI_MR","MWI_PCV","MWI_Meningitis","MWI_Rotavirus","MWI_YF")

for (i in 1:vac_estimation_length){
  
  Malawi_vac_VSLY[i,1] <- current_DALY_var_MWI$`MWI_HepA&HiB`[i]*VSLY_data[2,1]
  Malawi_vac_VSLY[i,2] <- current_DALY_var_MWI$MWI_HPV[i]*VSLY_data[2,2]
  Malawi_vac_VSLY[i,3] <- current_DALY_var_MWI$MWI_MR[i]*VSLY_data[2,3]
  Malawi_vac_VSLY[i,4] <- current_DALY_var_MWI$MWI_PCV[i]*VSLY_data[2,4]
  Malawi_vac_VSLY[i,5] <- current_DALY_var_MWI$MWI_Meningitis[i]*VSLY_data[2,5]
  Malawi_vac_VSLY[i,6] <- current_DALY_var_MWI$MWI_Rotavirus[i]*VSLY_data[2,6]
  Malawi_vac_VSLY[i,7] <- current_DALY_var_MWI$MWI_YF[i]*VSLY_data[2,7]
}

Malawi_vac_VSLY <- as.data.frame(Malawi_vac_VSLY)

current_DALY_var_DRC <- DRC_DALY_averted
for (i in 1:vac_estimation_length){
  for (k in 1:length(DRC_col_names)){
    disease_col <- DRC_col_names[k]
    disease_index <- which(colnames(current_DALY_var_DRC) == disease_col)
    low_bound <- current_DALY_var_DRC[i, (disease_index+1)]
    high_bound <- current_DALY_var_DRC[i, (disease_index+2)]
    current_DALY_var_DRC[i, disease_index] <- runif(1, low_bound, high_bound)
  }
}

DRC_vac_VSLY <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(DRC_vac_VSLY) <- c("DRC_HepA&HiB", "DRC_HPV","DRC_MR","DRC_PCV","DRC_Meningitis","DRC_Rotavirus","DRC_YF")

for (i in 1:vac_estimation_length){
  
  DRC_vac_VSLY[i,1] <- current_DALY_var_DRC$`DRC_HepA&HiB`[i]*VSLY_data[3,1]
  DRC_vac_VSLY[i,2] <- current_DALY_var_DRC$DRC_HPV[i]*VSLY_data[3,2]
  DRC_vac_VSLY[i,3] <- current_DALY_var_DRC$DRC_MR[i]*VSLY_data[3,3]
  DRC_vac_VSLY[i,4] <- current_DALY_var_DRC$DRC_PCV[i]*VSLY_data[3,4]
  DRC_vac_VSLY[i,5] <- current_DALY_var_DRC$DRC_Meningitis[i]*VSLY_data[3,5]
  DRC_vac_VSLY[i,6] <- current_DALY_var_DRC$DRC_Rotavirus[i]*VSLY_data[3,6]
  DRC_vac_VSLY[i,7] <- current_DALY_var_DRC$DRC_YF[i]*VSLY_data[3,7]
}

DRC_vac_VSLY <- as.data.frame(DRC_vac_VSLY)


Total_vac_VSLY <- Nigeria_vac_VSLY + Malawi_vac_VSLY + DRC_vac_VSLY
colnames(Total_vac_VSLY) <- c("Total_HepA&HiB", "Total_HPV","Total_MR","Total_PCV","Total_Meningitis","Total_Rotavirus","Total_YF")


###NPV calculations
#Nigeria
NPV_NGA_vac_VSLY <- matrix(ncol = 8, nrow = 1)

colnames(NPV_NGA_vac_VSLY) <- c("NPV_VacVSLY_HepA&HiB", "NPV_VacVSLY_HPV","NPV_VacVSLY_MR","NPV_VacVSLY_PCV","NPV_VacVSLY_Meningitis","NPV_VacVSLY_Rotavirus","NPV_VacVSLY_YF","NPV_VacVSLY_Overall")

NPV_NGA_vac_VSLY[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_NGA_vac_VSLY [1,1] <- NPV_NGA_vac_VSLY [1,1]+Nigeria_vac_VSLY$`NGA_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_VSLY [1,2] <- NPV_NGA_vac_VSLY [1,2]+Nigeria_vac_VSLY$`NGA_HPV`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_VSLY [1,3] <- NPV_NGA_vac_VSLY [1,3]+Nigeria_vac_VSLY$`NGA_MR`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_VSLY [1,4] <- NPV_NGA_vac_VSLY [1,4]+Nigeria_vac_VSLY$`NGA_PCV`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_VSLY [1,5] <- NPV_NGA_vac_VSLY [1,5]+Nigeria_vac_VSLY$`NGA_Meningitis`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_VSLY [1,6] <- NPV_NGA_vac_VSLY [1,6]+Nigeria_vac_VSLY$`NGA_Rota`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_VSLY [1,7] <- NPV_NGA_vac_VSLY [1,7]+Nigeria_vac_VSLY$`NGA_YF`[i]/((1+discount_rate)^(i))
}
NPV_NGA_vac_VSLY [1,8] <- NPV_NGA_vac_VSLY[1,1] + NPV_NGA_vac_VSLY[1,2] + NPV_NGA_vac_VSLY[1,3] + NPV_NGA_vac_VSLY[1,4] + NPV_NGA_vac_VSLY[1,5] + NPV_NGA_vac_VSLY[1,6] + NPV_NGA_vac_VSLY[1,7]

NPV_NGA_vac_VSLY <- as.data.frame (NPV_NGA_vac_VSLY)

Annualized_NGA_vac_VSLY <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_NGA_vac_VSLY) <- c("Annualized_VacVSLY_HepA&HiB", "Annualized_VacVSLY_HPV","Annualized_VacVSLY_MR","Annualized_VacVSLY_PCV","Annualized_VacVSLY_Meningitis","Annualized_VacVSLY_Rotavirus","Annualized_VacVSLY_YF","Annualized_VacVSLY_Overall")
for (i in 1: ncol(Annualized_NGA_vac_VSLY)){
  Annualized_NGA_vac_VSLY[1,i] <- NPV_NGA_vac_VSLY [1,i]/vaccine_annuity_factor
}

Annualized_NGA_vac_VSLY <- as.data.frame(Annualized_NGA_vac_VSLY)

#Malawi
NPV_MWI_vac_VSLY <- matrix(ncol = 8, nrow = 1)

colnames(NPV_MWI_vac_VSLY) <- c("NPV_VacVSLY_HepA&HiB", "NPV_VacVSLY_HPV","NPV_VacVSLY_MR","NPV_VacVSLY_PCV","NPV_VacVSLY_Meningitis","NPV_VacVSLY_Rotavirus","NPV_VacVSLY_YF","NPV_VacVSLY_Overall")

NPV_MWI_vac_VSLY[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_MWI_vac_VSLY [1,1] <- NPV_MWI_vac_VSLY [1,1]+Malawi_vac_VSLY$`MWI_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_VSLY [1,2] <- NPV_MWI_vac_VSLY [1,2]+Malawi_vac_VSLY$`MWI_HPV`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_VSLY [1,3] <- NPV_MWI_vac_VSLY [1,3]+Malawi_vac_VSLY$`MWI_MR`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_VSLY [1,4] <- NPV_MWI_vac_VSLY [1,4]+Malawi_vac_VSLY$`MWI_PCV`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_VSLY [1,5] <- NPV_MWI_vac_VSLY [1,5]+Malawi_vac_VSLY$`MWI_Meningitis`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_VSLY [1,6] <- NPV_MWI_vac_VSLY [1,6]+Malawi_vac_VSLY$`MWI_Rota`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_VSLY [1,7] <- NPV_MWI_vac_VSLY [1,7]+Malawi_vac_VSLY$`MWI_YF`[i]/((1+discount_rate)^(i))
}
NPV_MWI_vac_VSLY [1,8] <- NPV_MWI_vac_VSLY[1,1] + NPV_MWI_vac_VSLY[1,2] + NPV_MWI_vac_VSLY[1,3] + NPV_MWI_vac_VSLY[1,4] + NPV_MWI_vac_VSLY[1,5] + NPV_MWI_vac_VSLY[1,6] + NPV_MWI_vac_VSLY[1,7]

NPV_MWI_vac_VSLY <- as.data.frame (NPV_MWI_vac_VSLY)

Annualized_MWI_vac_VSLY <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_MWI_vac_VSLY) <- c("Annualized_VacVSLY_HepA&HiB", "Annualized_VacVSLY_HPV","Annualized_VacVSLY_MR","Annualized_VacVSLY_PCV","Annualized_VacVSLY_Meningitis","Annualized_VacVSLY_Rotavirus","Annualized_VacVSLY_YF","Annualized_VacVSLY_Overall")
for (i in 1: ncol(Annualized_MWI_vac_VSLY)){
  Annualized_MWI_vac_VSLY[1,i] <- NPV_MWI_vac_VSLY [1,i]/vaccine_annuity_factor
}

Annualized_MWI_vac_VSLY <- as.data.frame(Annualized_MWI_vac_VSLY)

#DRC
NPV_DRC_vac_VSLY <- matrix(ncol = 8, nrow = 1)

colnames(NPV_DRC_vac_VSLY) <- c("NPV_VacVSLY_HepA&HiB", "NPV_VacVSLY_HPV","NPV_VacVSLY_MR","NPV_VacVSLY_PCV","NPV_VacVSLY_Meningitis","NPV_VacVSLY_Rotavirus","NPV_VacVSLY_YF","NPV_VacVSLY_Overall")

NPV_DRC_vac_VSLY[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_DRC_vac_VSLY [1,1] <- NPV_DRC_vac_VSLY [1,1]+DRC_vac_VSLY$`DRC_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_VSLY [1,2] <- NPV_DRC_vac_VSLY [1,2]+DRC_vac_VSLY$`DRC_HPV`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_VSLY [1,3] <- NPV_DRC_vac_VSLY [1,3]+DRC_vac_VSLY$`DRC_MR`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_VSLY [1,4] <- NPV_DRC_vac_VSLY [1,4]+DRC_vac_VSLY$`DRC_PCV`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_VSLY [1,5] <- NPV_DRC_vac_VSLY [1,5]+DRC_vac_VSLY$`DRC_Meningitis`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_VSLY [1,6] <- NPV_DRC_vac_VSLY [1,6]+DRC_vac_VSLY$`DRC_Rota`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_VSLY [1,7] <- NPV_DRC_vac_VSLY [1,7]+DRC_vac_VSLY$`DRC_YF`[i]/((1+discount_rate)^(i))
}
NPV_DRC_vac_VSLY [1,8] <- NPV_DRC_vac_VSLY[1,1] + NPV_DRC_vac_VSLY[1,2] + NPV_DRC_vac_VSLY[1,3] + NPV_DRC_vac_VSLY[1,4] + NPV_DRC_vac_VSLY[1,5] + NPV_DRC_vac_VSLY[1,6] + NPV_DRC_vac_VSLY[1,7]

NPV_DRC_vac_VSLY <- as.data.frame (NPV_DRC_vac_VSLY)

Annualized_DRC_vac_VSLY <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DRC_vac_VSLY) <- c("Annualized_VacVSLY_HepA&HiB", "Annualized_VacVSLY_HPV","Annualized_VacVSLY_MR","Annualized_VacVSLY_PCV","Annualized_VacVSLY_Meningitis","Annualized_VacVSLY_Rotavirus","Annualized_VacVSLY_YF","Annualized_VacVSLY_Overall")
for (i in 1: ncol(Annualized_DRC_vac_VSLY)){
  Annualized_DRC_vac_VSLY[1,i] <- NPV_DRC_vac_VSLY [1,i]/vaccine_annuity_factor
}

Annualized_DRC_vac_VSLY <- as.data.frame(Annualized_DRC_vac_VSLY)

#Overall
NPV_vac_VSLY <- matrix(ncol = 8, nrow = 1)

colnames(NPV_vac_VSLY) <- c("NPV_VacVSLY_HepA&HiB", "NPV_VacVSLY_HPV","NPV_VacVSLY_MR","NPV_VacVSLY_PCV","NPV_VacVSLY_Meningitis","NPV_VacVSLY_Rotavirus","NPV_VacVSLY_YF","NPV_VacVSLY_Overall")

NPV_vac_VSLY[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_vac_VSLY [1,1] <- NPV_vac_VSLY [1,1]+Total_vac_VSLY$`Total_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_vac_VSLY [1,2] <- NPV_vac_VSLY [1,2]+Total_vac_VSLY$`Total_HPV`[i]/((1+discount_rate)^(i)) 
NPV_vac_VSLY [1,3] <- NPV_vac_VSLY [1,3]+Total_vac_VSLY$`Total_MR`[i]/((1+discount_rate)^(i)) 
NPV_vac_VSLY [1,4] <- NPV_vac_VSLY [1,4]+Total_vac_VSLY$`Total_PCV`[i]/((1+discount_rate)^(i))   
NPV_vac_VSLY [1,5] <- NPV_vac_VSLY [1,5]+Total_vac_VSLY$`Total_Meningitis`[i]/((1+discount_rate)^(i))
NPV_vac_VSLY [1,6] <- NPV_vac_VSLY [1,6]+Total_vac_VSLY$`Total_Rota`[i]/((1+discount_rate)^(i))
NPV_vac_VSLY [1,7] <- NPV_vac_VSLY [1,7]+Total_vac_VSLY$`Total_YF`[i]/((1+discount_rate)^(i))
}
NPV_vac_VSLY [1,8] <- NPV_vac_VSLY[1,1] + NPV_vac_VSLY[1,2] + NPV_vac_VSLY[1,3] + NPV_vac_VSLY[1,4] + NPV_vac_VSLY[1,5] + NPV_vac_VSLY[1,6] + NPV_vac_VSLY[1,7]

NPV_vac_VSLY <- as.data.frame (NPV_vac_VSLY)

Annualized_vac_VSLY <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_vac_VSLY) <- c("Annualized_VacVSLY_HepA&HiB", "Annualized_VacVSLY_HPV","Annualized_VacVSLY_MR","Annualized_VacVSLY_PCV","Annualized_VacVSLY_Meningitis","Annualized_VacVSLY_Rotavirus","Annualized_VacVSLY_YF","Annualized_VacVSLY_Overall")
for (i in 1: ncol(Annualized_vac_VSLY)){
  Annualized_vac_VSLY[1,i] <- NPV_vac_VSLY [1,i]/vaccine_annuity_factor
}

Annualized_vac_VSLY <- as.data.frame(Annualized_vac_VSLY)


# 2. Policy Alternative --> Solar fridges vs PV Systems


population_base_year <- 2021
vaccination_estimation_end_year <- 2030
vac_estimation_length <- vaccination_estimation_end_year - population_base_year + 1

vaccine_annuity_factor = (1-(1/((1+discount_rate)^(vac_estimation_length))))/discount_rate


##################### Vaccine Spoilage rates inputs ###########################################################################
#Vaccination spoilage rate; source : GAVI Detailed Product Profiles (DPPs) for WHO prequalified vaccines
wastage_rate_reduction_min <- 0.5 # wastage reduction varied between 50% to 100% of initial reduction rate
wastage_rate_reduction_max <- 1 # wastage reduction varied between 50% to 100% of initial reduction rate
vac_spoilage_NGA_HepA_Hib <- runif(1,(1-wastage_rate_reduction_max)*0.05,(1-wastage_rate_reduction_min)*0.05) 
vac_spoilage_MWI_HepA_Hib <- runif(1,(1-wastage_rate_reduction_max)*0.05,(1-wastage_rate_reduction_min)*0.05)
vac_spoilage_DRC_HepA_Hib <- runif(1,(1-wastage_rate_reduction_max)*0.05,(1-wastage_rate_reduction_min)*0.05)

vac_spoilage_NGA_HPV <- runif(1,(1-wastage_rate_reduction_max)*0.07,(1-wastage_rate_reduction_min)*0.07)
vac_spoilage_MWI_HPV <- runif(1,(1-wastage_rate_reduction_max)*0.07,(1-wastage_rate_reduction_min)*0.07)
vac_spoilage_DRC_HPV <- runif(1,(1-wastage_rate_reduction_max)*0.07,(1-wastage_rate_reduction_min)*0.07)

vac_spoilage_NGA_MR <- runif(1,(1-wastage_rate_reduction_max)*0.25,(1-wastage_rate_reduction_min)*0.25)
vac_spoilage_MWI_MR <- runif(1,(1-wastage_rate_reduction_max)*0.25,(1-wastage_rate_reduction_min)*0.25)
vac_spoilage_DRC_MR <- runif(1,(1-wastage_rate_reduction_max)*0.25,(1-wastage_rate_reduction_min)*0.25)

vac_spoilage_NGA_PCV <- runif(1,(1-wastage_rate_reduction_max)*0.08,(1-wastage_rate_reduction_min)*0.08)
vac_spoilage_MWI_PCV <- runif(1,(1-wastage_rate_reduction_max)*0.08,(1-wastage_rate_reduction_min)*0.08)
vac_spoilage_DRC_PCV <- runif(1,(1-wastage_rate_reduction_max)*0.08,(1-wastage_rate_reduction_min)*0.08)

vac_spoilage_NGA_MenA <- runif(1,(1-wastage_rate_reduction_max)*0.40,(1-wastage_rate_reduction_min)*0.40)
vac_spoilage_MWI_MenA <- runif(1,(1-wastage_rate_reduction_max)*0.40,(1-wastage_rate_reduction_min)*0.40)
vac_spoilage_DRC_MenA <- runif(1,(1-wastage_rate_reduction_max)*0.40,(1-wastage_rate_reduction_min)*0.40)

vac_spoilage_NGA_Rota <- runif(1,(1-wastage_rate_reduction_max)*0.06,(1-wastage_rate_reduction_min)*0.06)
vac_spoilage_MWI_Rota <- runif(1,(1-wastage_rate_reduction_max)*0.06,(1-wastage_rate_reduction_min)*0.06)
vac_spoilage_DRC_Rota <- runif(1,(1-wastage_rate_reduction_max)*0.06,(1-wastage_rate_reduction_min)*0.06)

vac_spoilage_NGA_YF <- runif(1,(1-wastage_rate_reduction_max)*0.25,(1-wastage_rate_reduction_min)*0.25)
vac_spoilage_MWI_YF <- runif(1,(1-wastage_rate_reduction_max)*0.25,(1-wastage_rate_reduction_min)*0.25)
vac_spoilage_DRC_YF <- runif(1,(1-wastage_rate_reduction_max)*0.25,(1-wastage_rate_reduction_min)*0.25)


#################### Population calculations #####################################################################################

#Nigeria#
Nigeria_pop <- matrix(ncol = 7, nrow = vac_estimation_length)

colnames(Nigeria_pop) <- c("Year", "Nigeria_Tot_Pop(million)", "Nigeria_CBR", "Nigeria_Pop_growth%", "Nigeria_New_born(million)","Nigeria_Female_10to14_growth%","Nigeria_Female_10to14(million)")
Nigeria_pop_baseyr <- 213.401322 #(in million) (sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Nigeria_pop_GR <- 0.0241 #(2021 % sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Nigeria_fem_age10to14_baseyr <- 13.2494365 #(in million) (sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Nigeria_fem_GR <- 0.0265883 #(2021 % sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Nigeria_CBR <- 37.117 #Crude Birth Rate per 1000 people sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

for (i in 1:vac_estimation_length){
  Nigeria_pop [i,1] = population_base_year + i - 1
  Nigeria_pop [i,3] = Nigeria_CBR
  Nigeria_pop [i,4] = Nigeria_pop_GR
  Nigeria_pop [i,2] = Nigeria_pop_baseyr*(1+Nigeria_pop[i,4])^(i-1)
  Nigeria_pop [i,5] = Nigeria_pop[i,3]/1000*Nigeria_pop[i,2]
  Nigeria_pop [i,6] = Nigeria_fem_GR
  Nigeria_pop [i,7] = Nigeria_fem_age10to14_baseyr*(1+Nigeria_pop[i,6])^(i-1)
}

Nigeria_pop <- as.data.frame(Nigeria_pop)

#Malawi#
Malawi_pop <- matrix(ncol = 7, nrow = vac_estimation_length)

colnames(Malawi_pop) <- c("Year", "Malawi_Tot_Pop(million)", "Malawi_CBR", "Malawi_Pop_growth%", "Malawi_New_born(million)","Malawi_Female_10to14_growth%","Malawi_Female_10to14(million)")
Malawi_pop_baseyr <- 19.889742 #(in million) (sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Malawi_pop_GR <- 0.026114 #(2021 % sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Malawi_fem_age10to14_baseyr <- 1.357462 #(in million) (sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Malawi_fem_GR <- 0.015728 #(2021 % sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

Malawi_CBR <- 32.859 #Crude Birth Rate per 1000 people sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

for (i in 1:vac_estimation_length){
  Malawi_pop [i,1] = population_base_year + i - 1
  Malawi_pop [i,3] = Malawi_CBR
  Malawi_pop [i,4] = Malawi_pop_GR
  Malawi_pop [i,2] = Malawi_pop_baseyr*(1+Malawi_pop[i,4])^(i-1)
  Malawi_pop [i,5] = Malawi_pop[i,3]/1000*Malawi_pop[i,2]
  Malawi_pop [i,6] = Malawi_fem_GR
  Malawi_pop [i,7] = Malawi_fem_age10to14_baseyr*(1+Malawi_pop[i,6])^(i-1)
}
Malawi_pop <- as.data.frame(Malawi_pop)

#DRC#
DRC_pop <- matrix(ncol = 7, nrow = vac_estimation_length)

colnames(DRC_pop) <- c("Year", "DRC_Tot_Pop(million)", "DRC_CBR", "DRC_Pop_growth%", "DRC_New_born(million)","DRC_Female_10to14_growth%","DRC_Female_10to14(million)")
DRC_pop_baseyr <- 95.894119 #(in million) (sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

DRC_pop_GR <- 0.032225 #(2021 % sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

DRC_fem_age10to14_baseyr <- 6.085013 #(in million) (sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

DRC_fem_GR <- 0.0400456 #(2021 % sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

DRC_CBR <- 42.049 #Crude Birth Rate per 1000 people sourced from Data from database: World Development Indicators; Last Updated: 10/26/2023)

for (i in 1:vac_estimation_length){
  DRC_pop [i,1] = population_base_year + i - 1
  DRC_pop [i,3] = DRC_CBR
  DRC_pop [i,4] = DRC_pop_GR
  DRC_pop [i,2] = DRC_pop_baseyr*(1+DRC_pop[i,4])^(i-1)
  DRC_pop [i,5] = DRC_pop[i,3]/1000*DRC_pop[i,2]
  DRC_pop [i,6] = DRC_fem_GR
  DRC_pop [i,7] = DRC_fem_age10to14_baseyr*(1+DRC_pop[i,6])^(i-1)
} 
DRC_pop <- as.data.frame(DRC_pop)


############### Calculations for Number of Vaccine doses #########################################################################
## Number of Vaccination doses ##

Nigeria_vac_doses <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(Nigeria_vac_doses) <- c("NGA_HepA&HiB", "NGA_HPV","NGA_MR","NGA_PCV","NGA_Meningitis","NGA_Rotavirus","NGA_YF")

Malawi_vac_doses <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(Malawi_vac_doses) <- c("MWI_HepA&HiB", "MWI_HPV","MWI_MR","MWI_PCV","MWI_Meningitis","MWI_Rotavirus","MWI_YF")

DRC_vac_doses <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(DRC_vac_doses) <- c("DRC_HepA&HiB", "DRC_HPV","DRC_MR","DRC_PCV","DRC_Meningitis","DRC_Rotavirus","DRC_YF")

for (i in 1:vac_estimation_length){

#HepA_HiB#

  Nigeria_vac_doses [i,1] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_HepA_Hib)*vac_recommended_dose_HepA_Hib*(1+vac_buffer_NGA_HepA_Hib)*(1+vac_spoilage_NGA_HepA_Hib)
  
  Malawi_vac_doses [i,1] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_HepA_Hib)*vac_recommended_dose_HepA_Hib*(1+vac_buffer_MWI_HepA_Hib)*(1+vac_spoilage_MWI_HepA_Hib)
  
  DRC_vac_doses [i,1] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_HepA_Hib)*vac_recommended_dose_HepA_Hib*(1+vac_buffer_DRC_HepA_Hib)*(1+vac_spoilage_DRC_HepA_Hib)
  
#HPV#

  if (i %in% c(1, 2)) {
    vac_coverage_NGA_HPV_calc = 0
  } else if (i == 3) {
    vac_coverage_NGA_HPV_calc = 0.1407
  } else if (i == 4) {
    vac_coverage_NGA_HPV_calc = 0.1407 * 2
  } else if (i == 5) {
    vac_coverage_NGA_HPV_calc = 0.1407 * 3
  } else if (i > 5) {
    vac_coverage_NGA_HPV_calc = vac_coverage_NGA_HPV
  }

  Nigeria_vac_doses[i, 2] = Nigeria_pop$`Nigeria_Female_10to14(million)`[i] * vac_coverage_NGA_HPV_calc * vac_recommended_dose_HPV * (1 + vac_buffer_NGA_HPV) * (1 + vac_spoilage_NGA_HPV)
  
  if (i ==1) {
    vac_coverage_MWI_HPV_calc = 0.12
  } else if (i == 2) {
    vac_coverage_MWI_HPV_calc = 0.1407
  } else if (i == 3) {
    vac_coverage_MWI_HPV_calc = 0.1407 * 2
  } else if (i == 4) {
    vac_coverage_MWI_HPV_calc = 0.1407 * 3
  } else if (i > 4) {
    vac_coverage_MWI_HPV_calc = vac_coverage_MWI_HPV
  }

  Malawi_vac_doses[i, 2] = Malawi_pop$`Malawi_Female_10to14(million)`[i] * vac_coverage_MWI_HPV_calc * vac_recommended_dose_HPV * (1 + vac_buffer_MWI_HPV) * (1 + vac_spoilage_MWI_HPV)
  
  if (i %in% c(1, 2)) {
    vac_coverage_DRC_HPV_calc = 0
  } else if (i == 3) {
    vac_coverage_DRC_HPV_calc = 0.1407
  } else if (i == 4) {
    vac_coverage_DRC_HPV_calc = 0.1407 * 2
  } else if (i == 5) {
    vac_coverage_DRC_HPV_calc = 0.1407 * 3
  } else if (i > 5) {
    vac_coverage_DRC_HPV_calc = vac_coverage_DRC_HPV
  }

  DRC_vac_doses[i, 2] = DRC_pop$`DRC_Female_10to14(million)`[i] * vac_coverage_DRC_HPV_calc * vac_recommended_dose_HPV * (1 + vac_buffer_DRC_HPV) * (1 + vac_spoilage_DRC_HPV)
  
#Measles and Rubella#

  Nigeria_vac_doses [i,3] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_MR)*vac_recommended_dose_MR*(1+vac_buffer_NGA_MR)*(1+vac_spoilage_NGA_MR)
  
  Malawi_vac_doses [i,3] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_MR)*vac_recommended_dose_MR*(1+vac_buffer_MWI_MR)*(1+vac_spoilage_MWI_MR)
  
  DRC_vac_doses [i,3] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_MR)*vac_recommended_dose_MR*(1+vac_buffer_DRC_MR)*(1+vac_spoilage_DRC_MR)

#PCV#

  Nigeria_vac_doses [i,4] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_PCV)*vac_recommended_dose_PCV*(1+vac_buffer_NGA_PCV)*(1+vac_spoilage_NGA_PCV)
  
  Malawi_vac_doses [i,4] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_PCV)*vac_recommended_dose_PCV*(1+vac_buffer_MWI_PCV)*(1+vac_spoilage_MWI_PCV)
  
  DRC_vac_doses [i,4] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_PCV)*vac_recommended_dose_PCV*(1+vac_buffer_DRC_PCV)*(1+vac_spoilage_DRC_PCV)


#Menningitis A#

  if (i == 1) {
    vac_coverage_NGA_MenA_calc = 0.5
  } else if (i > 1) {
    vac_coverage_NGA_MenA_calc = vac_coverage_NGA_MenA
  }

  Nigeria_vac_doses[i, 5] = Nigeria_pop$`Nigeria_New_born(million)`[i] * vac_coverage_NGA_MenA_calc * vac_recommended_dose_MenA * (1 + vac_buffer_NGA_MenA) * (1 + vac_spoilage_NGA_MenA)
  
  Malawi_vac_doses[i, 5] = Malawi_pop$`Malawi_New_born(million)`[i] * vac_coverage_MWI_MenA * vac_recommended_dose_MenA * (1 + vac_buffer_MWI_MenA) * (1 + vac_spoilage_MWI_MenA)
  
DRC_vac_doses[i, 5] = DRC_pop$`DRC_New_born(million)`[i] * vac_coverage_DRC_MenA * vac_recommended_dose_MenA * (1 + vac_buffer_DRC_MenA) * (1 + vac_spoilage_DRC_MenA)
    
#Rota#

  if (i == 1) {
    vac_coverage_NGA_Rota_calc = 0
  } else if (i == 2) {
    vac_coverage_NGA_Rota_calc = 0.12
  } else if (i == 3) {
    vac_coverage_NGA_Rota_calc = 0.12*2
  } else if (i == 4) {
    vac_coverage_NGA_Rota_calc = 0.12*4
  } else if (i > 4) {
    vac_coverage_NGA_Rota_calc = vac_coverage_NGA_Rota
  }

  Nigeria_vac_doses[i, 6] = Nigeria_pop$`Nigeria_New_born(million)`[i] * vac_coverage_NGA_Rota_calc * vac_recommended_dose_Rota * (1 + vac_buffer_NGA_Rota) * (1 + vac_spoilage_NGA_Rota)
  
  Malawi_vac_doses[i, 6] = Malawi_pop$`Malawi_New_born(million)`[i] * vac_coverage_MWI_Rota * vac_recommended_dose_Rota_MWI * (1 + vac_buffer_MWI_Rota) * (1 + vac_spoilage_MWI_Rota)
  
  DRC_vac_doses[i, 6] = DRC_pop$`DRC_New_born(million)`[i] * vac_coverage_DRC_Rota * vac_recommended_dose_Rota * (1 + vac_buffer_DRC_Rota) * (1 + vac_spoilage_DRC_Rota)

#Yellow Fever#

  Nigeria_vac_doses [i,7] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_YF)*vac_recommended_dose_YF*(1+vac_buffer_NGA_YF)*(1+vac_spoilage_NGA_YF)
  
  Malawi_vac_doses [i,7] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_YF)*vac_recommended_dose_YF*(1+vac_buffer_MWI_YF)*(1+vac_spoilage_MWI_YF)
  
  DRC_vac_doses [i,7] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_YF)*vac_recommended_dose_YF*(1+vac_buffer_DRC_YF)*(1+vac_spoilage_DRC_YF)
}

Nigeria_vac_doses <- as.data.frame(Nigeria_vac_doses)
Malawi_vac_doses <- as.data.frame(Malawi_vac_doses)
DRC_vac_doses <- as.data.frame(DRC_vac_doses)
#################################################################################################################################

#################################################################################################################################
########################## COST CALCULATIONS ####################################################################################
#################################################################################################################################

####################### VCRC Costs inputs ######################################################################################

Total_Health_facilities_NGA <- 36428 #Total number of health facilities in Nigeria (Moner et al. 2021)
Total_Health_facilities_MWI <- 700 #Total number of health facilities in Malawi (Moner et al. 2021)
Total_Health_facilities_DRC <- 14746 #Total number of health facilities in DRC (Moner et al. 2021)

NEA_Health_facilities_NGA <- 13060 #Total number of health facilities with No access to electricity in Nigeria (Moner et al. 2021)
NEA_Health_facilities_MWI <- 353 #Total number of health facilities with No access to electricity in Malawi (Moner et al. 2021)
NEA_Health_facilities_DRC <- 9790 #Total number of health facilities with No access to electricity in DRC (Moner et al. 2021)

Health_facilities_NGA <- Total_Health_facilities_NGA - NEA_Health_facilities_NGA
Health_facilities_MWI <- Total_Health_facilities_MWI - NEA_Health_facilities_MWI
Health_facilities_DRC <- Total_Health_facilities_DRC - NEA_Health_facilities_DRC

VCRC_per_fac_NGA <- 1 #Vapor Compression Refrigeration Cycle (VCRC) system requirement per facility in Nigeria # Heatpump
VCRC_per_fac_MWI <- 1 #Vapor Compression Refrigeration Cycle (VCRC) system requirement per facility in Malawi # Heatpump
VCRC_per_fac_DRC <- 1 #Vapor Compression Refrigeration Cycle (VCRC) system requirement per facility in DRC # Heatpump

VCRC_capex_cost_NGA <- runif(1,0.8*11052,1.2*11052) #Initial system cost for VCRC systems (2019 values inflated to 2022)(Alwardesh and Ammari,2019) 
VCRC_capex_cost_MWI <- runif(1,0.8*11052,1.2*11052) #Initial system cost for VCRC systems (2019 values inflated to 2022)(Alwardesh and Ammari,2019) 
VCRC_capex_cost_DRC <- runif(1,0.8*11052,1.2*11052) #Initial system cost for VCRC systems (2019 values inflated to 2022)(Alwardesh and Ammari,2019) 

VCRC_opex_cost_NGA <- runif(1,0.8*446,1.2*446) #Per year O&M cost for VCRC systems (Alwardesh and Ammari,2019) 
VCRC_opex_cost_MWI <- runif(1,0.8*446,1.2*446) #Per year O&M cost for VCRC systems (Alwardesh and Ammari,2019) 
VCRC_opex_cost_DRC <- runif(1,0.8*446,1.2*446) #Per year O&M cost for VCRC systems (Alwardesh and Ammari,2019) 


VCRC_lifespan <- 25 #lifespan of VCRC systems (Alwardesh and Ammari,2019)

VCRC_annuity_factor <- (1-(1/((1+discount_rate)^(VCRC_lifespan))))/discount_rate


################### VCRC Cost calculations ############################################################################

VCRC_tot_capex_NGA <- (VCRC_capex_cost_NGA*VCRC_per_fac_NGA*Health_facilities_NGA)/10^6 #$ million, Nigeria
VCRC_tot_capex_MWI <- (VCRC_capex_cost_MWI*VCRC_per_fac_MWI*Health_facilities_MWI)/10^6 #$ million, Malawi
VCRC_tot_capex_DRC <- (VCRC_capex_cost_DRC*VCRC_per_fac_DRC*Health_facilities_DRC)/10^6 #$ million, DRC

VCRC_NPV_opex_cost_NGA <- 0
VCRC_NPV_opex_cost_MWI <- 0
VCRC_NPV_opex_cost_DRC <- 0

for(i in 1:VCRC_lifespan){
  VCRC_NPV_opex_cost_NGA <- VCRC_NPV_opex_cost_NGA + ((VCRC_opex_cost_NGA*VCRC_per_fac_NGA*Health_facilities_NGA*VCRC_per_fac_NGA)/((1+discount_rate)^i)/10^6)
  
  VCRC_NPV_opex_cost_MWI <- VCRC_NPV_opex_cost_MWI + ((VCRC_opex_cost_MWI*VCRC_per_fac_MWI*Health_facilities_MWI*VCRC_per_fac_MWI)/((1+discount_rate)^i)/10^6)
  
  VCRC_NPV_opex_cost_DRC <- VCRC_NPV_opex_cost_DRC + ((VCRC_opex_cost_DRC*VCRC_per_fac_DRC*Health_facilities_DRC*VCRC_per_fac_DRC)/((1+discount_rate)^i)/10^6)
}

VCRC_replacement_costs_NGA <- (500/((1+discount_rate)^12) + 0/((1+discount_rate)^14) + 1540/((1+discount_rate)^15))*Health_facilities_NGA*VCRC_per_fac_NGA/10^6
VCRC_replacement_costs_MWI <- (500/((1+discount_rate)^12) + 0/((1+discount_rate)^14) + 1540/((1+discount_rate)^15))*Health_facilities_MWI*VCRC_per_fac_MWI/10^6
VCRC_replacement_costs_DRC <- (500/((1+discount_rate)^12) + 0/((1+discount_rate)^14) + 1540/((1+discount_rate)^15))*Health_facilities_DRC*VCRC_per_fac_DRC/10^6


VCRC_NPV_total_cost_NGA <- VCRC_tot_capex_NGA + VCRC_NPV_opex_cost_NGA + VCRC_replacement_costs_NGA
VCRC_NPV_total_cost_MWI <- VCRC_tot_capex_MWI + VCRC_NPV_opex_cost_MWI + VCRC_replacement_costs_MWI
VCRC_NPV_total_cost_DRC <- VCRC_tot_capex_DRC + VCRC_NPV_opex_cost_DRC + VCRC_replacement_costs_DRC

Annualized_VCRC_opex_cost_NGA <- VCRC_NPV_opex_cost_NGA/VCRC_annuity_factor
Annualized_VCRC_opex_cost_MWI <- VCRC_NPV_opex_cost_MWI/VCRC_annuity_factor
Annualized_VCRC_opex_cost_DRC <- VCRC_NPV_opex_cost_DRC/VCRC_annuity_factor
Annualized_VCRC_opex_cost_overall <- Annualized_VCRC_opex_cost_NGA + Annualized_VCRC_opex_cost_MWI + Annualized_VCRC_opex_cost_DRC

Annualized_VCRC_capex_cost_NGA <- VCRC_tot_capex_NGA/VCRC_annuity_factor
Annualized_VCRC_capex_cost_MWI <- VCRC_tot_capex_MWI/VCRC_annuity_factor
Annualized_VCRC_capex_cost_DRC <- VCRC_tot_capex_DRC/VCRC_annuity_factor
Annualized_VCRC_capex_cost_overall <- Annualized_VCRC_capex_cost_NGA + Annualized_VCRC_capex_cost_MWI + Annualized_VCRC_capex_cost_DRC

Annualized_VCRC_total_cost_NGA <- VCRC_NPV_total_cost_NGA/VCRC_annuity_factor
Annualized_VCRC_total_cost_MWI <- VCRC_NPV_total_cost_MWI/VCRC_annuity_factor
Annualized_VCRC_total_cost_DRC <- VCRC_NPV_total_cost_DRC/VCRC_annuity_factor
Annualized_VCRC_total_cost_overall <- Annualized_VCRC_opex_cost_overall + Annualized_VCRC_capex_cost_overall 

################### VCRC Reduced DG energy consumption ############################################################################

## Revised diesel consumption calculations ##

vac_refrigerator_energy_demand_NGA <- runif(1, 0.72, 1.44) #kWh per day per facility
vac_refrigerator_energy_demand_MWI <- runif(1, 0.72, 1.44) #kWh per day per facility
vac_refrigerator_energy_demand_DRC <- runif(1, 0.72, 1.44) #kWh per day per facility

annual_diesel_vac_refrigeration_NGA <- vac_refrigerator_energy_demand_NGA/24*diesel_consumption*Avg_dur_outage_NGA*Avg_num_outage_NGA*12/0.8 #per facility
annual_diesel_vac_refrigeration_MWI <- vac_refrigerator_energy_demand_MWI/24*diesel_consumption*Avg_dur_outage_NGA*Avg_num_outage_NGA*12/0.8 #per facility
annual_diesel_vac_refrigeration_DRC <- vac_refrigerator_energy_demand_DRC/24*diesel_consumption*Avg_dur_outage_NGA*Avg_num_outage_NGA*12/0.8 #per facility

total_diesel_vac_refrigeration_NGA <- annual_diesel_vac_refrigeration_NGA*Health_facilities_NGA
total_diesel_vac_refrigeration_MWI <- annual_diesel_vac_refrigeration_NGA*Health_facilities_MWI
total_diesel_vac_refrigeration_DRC <- annual_diesel_vac_refrigeration_NGA*Health_facilities_DRC

revised_diesel_cons_VCRC_NGA <- Diesel_cons_NGA - total_diesel_vac_refrigeration_NGA
revised_diesel_cons_VCRC_MWI <- Diesel_cons_MWI - total_diesel_vac_refrigeration_MWI
revised_diesel_cons_VCRC_DRC <- Diesel_cons_DRC - total_diesel_vac_refrigeration_DRC

revised_diesel_cost_VCRC_NGA <- diesel_cost * revised_diesel_cons_VCRC_NGA/10^6
revised_diesel_cost_VCRC_MWI <- diesel_cost * revised_diesel_cons_VCRC_MWI/10^6
revised_diesel_cost_VCRC_DRC <- diesel_cost * revised_diesel_cons_VCRC_DRC/10^6

revised_diesel_OMcost_VCRC_NGA <- dg_maintenance_cost*(Tot_DG_kW_demand_NGA - (vac_refrigerator_energy_demand_NGA/24*Avg_dur_outage_NGA*Avg_num_outage_NGA)*Health_facilities_NGA*12)/0.8/10^6
revised_diesel_OMcost_VCRC_MWI <- dg_maintenance_cost*(Tot_DG_kW_demand_MWI - (vac_refrigerator_energy_demand_MWI/24*Avg_dur_outage_MWI*Avg_num_outage_MWI)*Health_facilities_MWI*12)/0.8/10^6
revised_diesel_OMcost_VCRC_DRC <- dg_maintenance_cost*(Tot_DG_kW_demand_DRC - (vac_refrigerator_energy_demand_DRC/24*Avg_dur_outage_DRC*Avg_num_outage_DRC)*Health_facilities_DRC*12)/0.8/10^6

revised_DG_opex_VCRC_NGA <- revised_diesel_cost_VCRC_NGA + revised_diesel_OMcost_VCRC_NGA
revised_DG_opex_VCRC_MWI <- revised_diesel_cost_VCRC_MWI + revised_diesel_OMcost_VCRC_MWI
revised_DG_opex_VCRC_DRC <- revised_diesel_cost_VCRC_DRC + revised_diesel_OMcost_VCRC_DRC

NPV_revised_DG_opex_VCRC_NGA <- 0
NPV_revised_DG_opex_VCRC_MWI <- 0
NPV_revised_DG_opex_VCRC_DRC <- 0

for (i in 1:VCRC_lifespan){
NPV_revised_DG_opex_VCRC_NGA <- NPV_revised_DG_opex_VCRC_NGA + revised_DG_opex_VCRC_NGA/((1+discount_rate)^i)
NPV_revised_DG_opex_VCRC_MWI <- NPV_revised_DG_opex_VCRC_MWI + revised_DG_opex_VCRC_MWI/((1+discount_rate)^i)
NPV_revised_DG_opex_VCRC_DRC <- NPV_revised_DG_opex_VCRC_DRC + revised_DG_opex_VCRC_DRC/((1+discount_rate)^i)
}

Annualized_NGA_VCRC_revised_DG_opex <- NPV_revised_DG_opex_VCRC_NGA/VCRC_annuity_factor
Annualized_MWI_VCRC_revised_DG_opex <- NPV_revised_DG_opex_VCRC_MWI/VCRC_annuity_factor
Annualized_DRC_VCRC_revised_DG_opex <- NPV_revised_DG_opex_VCRC_DRC/VCRC_annuity_factor
Annualized_total_VCRC_revised_DG_opex <- Annualized_NGA_VCRC_revised_DG_opex + Annualized_MWI_VCRC_revised_DG_opex + Annualized_DRC_VCRC_revised_DG_opex

##############VCRC battery storage costs##############################################################################

VCRC_battery_size <- 7.5 #kWh
VCRC_battery_cost <- runif(1, 135, 200) #$/kWh https://about.bnef.com/blog/lithium-ion-battery-pack-prices-hit-record-low-of-139-kwh/#:~:text=New%20York%2C%20November%2027%2C%202023,research%20provider%20BloombergNEF%20(BNEF).
VCRC_numberofbatteries_NGA <- max(ceiling((DG_kW_demand_NGA/365)/VCRC_battery_size),1)
VCRC_numberofbatteries_MWI <- max(ceiling((DG_kW_demand_MWI/365)/VCRC_battery_size),1)
VCRC_numberofbatteries_DRC <- max(ceiling((DG_kW_demand_DRC/365)/VCRC_battery_size),1)

VCRC_battery_cost_NGA <- VCRC_battery_size*VCRC_battery_cost*VCRC_numberofbatteries_NGA*Health_facilities_NGA
VCRC_battery_cost_MWI <- VCRC_battery_size*VCRC_battery_cost*VCRC_numberofbatteries_MWI*Health_facilities_MWI
VCRC_battery_cost_DRC <- VCRC_battery_size*VCRC_battery_cost*VCRC_numberofbatteries_DRC*Health_facilities_DRC

battery_lifespan <- runif(1,12,15)
battery_replacement_times <- round(VCRC_lifespan/battery_lifespan)

NPV_battery_cost_NGA <- 0
NPV_battery_cost_MWI <- 0
NPV_battery_cost_DRC <- 0

for(i in 0:battery_replacement_times-1){
    NPV_battery_cost_NGA <- NPV_battery_cost_NGA + VCRC_battery_cost_NGA/((1+discount_rate)^(i*battery_lifespan))/10^6
    NPV_battery_cost_MWI <- NPV_battery_cost_MWI + VCRC_battery_cost_MWI/((1+discount_rate)^(i*battery_lifespan))/10^6
    NPV_battery_cost_DRC <- NPV_battery_cost_DRC + VCRC_battery_cost_DRC/((1+discount_rate)^(i*battery_lifespan))/10^6
}

annualized_VCRC_batterycost_NGA <- NPV_battery_cost_NGA/VCRC_annuity_factor
annualized_VCRC_batterycost_MWI <- NPV_battery_cost_MWI/VCRC_annuity_factor
annualized_VCRC_batterycost_DRC <- NPV_battery_cost_DRC/VCRC_annuity_factor
annualized_VCRC_batterycost_overall <- annualized_VCRC_batterycost_NGA + annualized_VCRC_batterycost_MWI + annualized_VCRC_batterycost_DRC

Annualized_totalVCRC_total_cost_NGA <- Annualized_VCRC_total_cost_NGA + annualized_VCRC_batterycost_NGA
Annualized_totalVCRC_total_cost_MWI <- Annualized_VCRC_total_cost_MWI + annualized_VCRC_batterycost_MWI
Annualized_totalVCRC_total_cost_DRC <- Annualized_VCRC_total_cost_DRC + annualized_VCRC_batterycost_DRC
Annualized_totalVCRC_total_cost_overall <- Annualized_totalVCRC_total_cost_NGA + Annualized_totalVCRC_total_cost_MWI + Annualized_totalVCRC_total_cost_DRC


##############Emissions from revised diesel consumption################################################################

revised_DG_emission_NGA <- diesel_emission_factor*revised_diesel_cons_VCRC_NGA/1000 #ton CO2
revised_DG_emission_MWI <- diesel_emission_factor*revised_diesel_cons_VCRC_MWI/1000 #ton CO2
revised_DG_emission_DRC <- diesel_emission_factor*revised_diesel_cons_VCRC_DRC/1000 #ton CO2

revised_cost_emission_NGA <- revised_DG_emission_NGA*global_social_cost_carbon/10^6
revised_cost_emission_MWI <- revised_DG_emission_MWI*global_social_cost_carbon/10^6
revised_cost_emission_DRC <- revised_DG_emission_DRC*global_social_cost_carbon/10^6

NPV_rev_emission_cost_NGA <- 0
NPV_rev_emission_cost_MWI <- 0
NPV_rev_emission_cost_DRC <- 0

for (i in 1:VCRC_lifespan) {
NPV_rev_emission_cost_NGA <- NPV_rev_emission_cost_NGA + revised_cost_emission_NGA/((1+discount_rate)^i)
NPV_rev_emission_cost_MWI <- NPV_rev_emission_cost_MWI + revised_cost_emission_MWI/((1+discount_rate)^i)
NPV_rev_emission_cost_DRC <- NPV_rev_emission_cost_DRC + revised_cost_emission_DRC/((1+discount_rate)^i)
}

annualized_rev_emission_cost_NGA <- NPV_rev_emission_cost_NGA/VCRC_annuity_factor
annualized_rev_emission_cost_MWI <- NPV_rev_emission_cost_MWI/VCRC_annuity_factor
annualized_rev_emission_cost_DRC <- NPV_rev_emission_cost_DRC/VCRC_annuity_factor
annualized_rev_emission_cost_overall <- annualized_rev_emission_cost_NGA + annualized_rev_emission_cost_MWI + annualized_rev_emission_cost_DRC

##############Benefits from reduced electricity for refrigerators################################################################

elec_tariff_NGA <- runif(1,0.055,0.08) #$/kWh 
elec_tariff_MWI <- runif(1,0.055,0.08) #$/kWh (0.055 to 0.08)
elec_tariff_DRC <- runif(1,0.055,0.08) #$/kWh (0.055 to 0.08)

annual_vac_refrigetator_grid_power_NGA <- (vac_refrigerator_energy_demand_NGA*365 -  vac_refrigerator_energy_demand_NGA/24*Avg_dur_outage_NGA*Avg_num_outage_NGA*12)*Health_facilities_NGA
annual_vac_refrigetator_grid_power_MWI <- (vac_refrigerator_energy_demand_MWI*365 -  vac_refrigerator_energy_demand_MWI/24*Avg_dur_outage_MWI*Avg_num_outage_MWI*12)*Health_facilities_MWI
annual_vac_refrigetator_grid_power_DRC <- (vac_refrigerator_energy_demand_DRC*365 -  vac_refrigerator_energy_demand_DRC/24*Avg_dur_outage_NGA*Avg_num_outage_DRC*12)*Health_facilities_DRC

annual_savings_grid_power_NGA <- annual_vac_refrigetator_grid_power_NGA*elec_tariff_NGA/10^6
annual_savings_grid_power_MWI <- annual_vac_refrigetator_grid_power_MWI*elec_tariff_MWI/10^6
annual_savings_grid_power_DRC <- annual_vac_refrigetator_grid_power_DRC*elec_tariff_DRC/10^6

NPV_benefit_VCRC_grid_power_NGA <- 0
NPV_benefit_VCRC_grid_power_MWI <- 0
NPV_benefit_VCRC_grid_power_DRC <- 0

for (i in 1: VCRC_lifespan) {
  NPV_benefit_VCRC_grid_power_NGA <- NPV_benefit_VCRC_grid_power_NGA + annual_savings_grid_power_NGA/((1+discount_rate)^i)
  NPV_benefit_VCRC_grid_power_MWI <- NPV_benefit_VCRC_grid_power_MWI + annual_savings_grid_power_MWI/((1+discount_rate)^i)
  NPV_benefit_VCRC_grid_power_DRC <- NPV_benefit_VCRC_grid_power_DRC + annual_savings_grid_power_DRC/((1+discount_rate)^i)
}

annualized_VCRC_gridpower_benefit_NGA <- NPV_benefit_VCRC_grid_power_NGA/VCRC_annuity_factor
annualized_VCRC_gridpower_benefit_MWI <- NPV_benefit_VCRC_grid_power_MWI/VCRC_annuity_factor
annualized_VCRC_gridpower_benefit_DRC <- NPV_benefit_VCRC_grid_power_DRC/VCRC_annuity_factor

####################### PVSYS Costs inputs ###################################################################################

elec_tariff_NGA <- runif(1,0.055,0.08) #$/kWh 
elec_tariff_MWI <- runif(1,0.055,0.08) #$/kWh (0.055 to 0.08)
elec_tariff_DRC <- runif(1,0.055,0.08) #$/kWh (0.055 to 0.08)

PVSYS_lifespan <- 20 

NGA_PV_upfrontcost <- 339*Health_facilities_NGA/Total_Health_facilities_NGA #EUR million per facility (Moner-Girona et al. 2021)
MWI_PV_upfrontcost <- 9*Health_facilities_MWI/Total_Health_facilities_MWI #EUR million per facility (Moner-Girona et al. 2021)
DRC_PV_upfrontcost <- 148*Health_facilities_DRC/Total_Health_facilities_DRC #EUR million per facility (Moner-Girona et al. 2021)

NGA_PV_OMcost <- 0.02*NGA_PV_upfrontcost #EUR million per year per facility (Moner-Girona et al. 2021)
MWI_PV_OMcost <- 0.02*MWI_PV_upfrontcost #EUR million per year per facility (Moner-Girona et al. 2021)
DRC_PV_OMcost <- 0.026*DRC_PV_upfrontcost #EUR million per year per facility (Moner-Girona et al. 2021) (O&M changed to 2.6% to reflect LCOE outputs in Moner-Girona et al. 2021 at discount rate of 3.55%)

################### PV System Cost calculations ################################################################################

PVSYS_annuity_factor <- (1-(1/((1+discount_rate)^(PVSYS_lifespan))))/discount_rate

NPV_NGA_PV_OMcost <- 0
NPV_MWI_PV_OMcost <- 0
NPV_DRC_PV_OMcost <- 0

for (i in 1: PVSYS_lifespan){
  NPV_NGA_PV_OMcost <- NPV_NGA_PV_OMcost + NGA_PV_OMcost/((1+discount_rate)^i)
  NPV_MWI_PV_OMcost <- NPV_MWI_PV_OMcost + MWI_PV_OMcost/((1+discount_rate)^i)
  NPV_DRC_PV_OMcost <- NPV_DRC_PV_OMcost + DRC_PV_OMcost/((1+discount_rate)^i)
}

NGA_PV_Totcost <- NGA_PV_upfrontcost + NPV_NGA_PV_OMcost
MWI_PV_Totcost <- MWI_PV_upfrontcost + NPV_MWI_PV_OMcost
DRC_PV_Totcost <- DRC_PV_upfrontcost + NPV_DRC_PV_OMcost

NPV_NGA_PV_kWh <- 0
NPV_MWI_PV_kWh <- 0
NPV_DRC_PV_kWh <- 0

for (i in 1: PVSYS_lifespan){
  NPV_NGA_PV_kWh <- NPV_NGA_PV_kWh + NGA_kWh_healthfac/((1+discount_rate)^i)
  NPV_MWI_PV_kWh <- NPV_MWI_PV_kWh + MWI_kWh_healthfac/((1+discount_rate)^i)
  NPV_DRC_PV_kWh <- NPV_DRC_PV_kWh + DRC_kWh_healthfac/((1+discount_rate)^i)
}

NGA_avg_elec_cost <- 1.09*NGA_PV_Totcost*10^6/NPV_NGA_PV_kWh #Average LCOE of PV system Nigeria in EUR/kWh, EURO to USD conversion = 1.09
MWI_avg_elec_cost <- 1.09*MWI_PV_Totcost*10^6/NPV_MWI_PV_kWh #Average LCOE of PV system Malawi in EUR/kWh, EURO to USD conversion = 1.09
DRC_avg_elec_cost <- 1.09*DRC_PV_Totcost*10^6/NPV_DRC_PV_kWh #Average LCOE of PV system DRC in EUR/kWh, EURO to USD conversion = 1.09

#Note: To replicate LCOE rates from Moner-Girona et al. 2021, replace discount rate with 4% and use energy demand for total number of health facilities instead of those with Energy Access

NPV_PVSYS_kWh_NGA <- 0
NPV_PVSYS_kWh_MWI <- 0
NPV_PVSYS_kWh_DRC <- 0

for (i in 1: PVSYS_lifespan){
  NPV_PVSYS_kWh_NGA <- NPV_PVSYS_kWh_NGA +  (NGA_kWh_healthfac/10^6)/((1+discount_rate)^i)
  NPV_PVSYS_kWh_MWI <- NPV_PVSYS_kWh_MWI +  (MWI_kWh_healthfac/10^6)/((1+discount_rate)^i)
  NPV_PVSYS_kWh_DRC <- NPV_PVSYS_kWh_DRC +  (DRC_kWh_healthfac/10^6)/((1+discount_rate)^i)
}

Annualized_PVSYS_kWh_NGA <- NPV_PVSYS_kWh_NGA/PVSYS_annuity_factor
Annualized_PVSYS_kWh_MWI <- NPV_PVSYS_kWh_MWI/PVSYS_annuity_factor
Annualized_PVSYS_kWh_DRC <- NPV_PVSYS_kWh_DRC/PVSYS_annuity_factor

PVSYS_LCOE_NGA <- NGA_avg_elec_cost/PVSYS_annuity_factor
PVSYS_LCOE_MWI <- MWI_avg_elec_cost/PVSYS_annuity_factor
PVSYS_LCOE_DRC <- DRC_avg_elec_cost/PVSYS_annuity_factor

Annualized_PVSYS_total_cost_NGA <- Annualized_PVSYS_kWh_NGA*PVSYS_LCOE_NGA
Annualized_PVSYS_total_cost_MWI <- Annualized_PVSYS_kWh_MWI*PVSYS_LCOE_MWI
Annualized_PVSYS_total_cost_DRC <- Annualized_PVSYS_kWh_DRC*PVSYS_LCOE_DRC
Annualized_PVSYS_total_cost_overall <- Annualized_PVSYS_total_cost_NGA+Annualized_PVSYS_total_cost_MWI+Annualized_PVSYS_total_cost_DRC


################################ Existing refrigeration system replacement cost ##########################

# Typical age of vaccine refrigeration system : around 8 to 10 years (Sicuri et al. doi: 10.1177/2381468319896280)
# we can thus carry out Monte carlo for refrigerator age from 1 to 10 years using a normal distribution of age instead of uniform distribution

max_life_regular_fridge = 10 # years of total lifespan
existing_refrigerator_age <- rnorm(1, mean = 5, sd = 1)
existing_refrigerator_age <- pmax(1, pmin(max_life_regular_fridge, existing_refrigerator_age))
remaining_life_existing_fridge <- floor(max_life_regular_fridge - existing_refrigerator_age)
new_fridge_cost <- runif(1, 410, 820) #(WHO-CHOICE One Health Tool)

remaining_yrs_energy_sys_NGA <- max((PVSYS_lifespan - remaining_life_existing_fridge),0)
remaining_yrs_energy_sys_MWI <- max((PVSYS_lifespan - remaining_life_existing_fridge),0)
remaining_yrs_energy_sys_DRC <- max((PVSYS_lifespan - remaining_life_existing_fridge),0)

new_fridge_requirement_NGA <- ceiling(remaining_yrs_energy_sys_NGA/max_life_regular_fridge)
new_fridge_requirement_MWI <- ceiling(remaining_yrs_energy_sys_MWI/max_life_regular_fridge)
new_fridge_requirement_DRC <- ceiling(remaining_yrs_energy_sys_DRC/max_life_regular_fridge)

NPV_new_fridge_cost_NGA <- 0
NPV_new_fridge_cost_MWI <- 0
NPV_new_fridge_cost_DRC <- 0

for(i in 0:new_fridge_requirement_NGA){
   if (i == 0) {
    NPV_new_fridge_cost_NGA = 0
  } else if (i > 0) {
    time_of_fridge_purchase <- max_life_regular_fridge*(i-1)+(existing_refrigerator_age+1)
    NPV_new_fridge_cost_NGA = NPV_new_fridge_cost_NGA + new_fridge_cost/((1+discount_rate)^time_of_fridge_purchase)
  }
}

for(i in 0:new_fridge_requirement_MWI){
   if (i == 0) {
    NPV_new_fridge_cost_MWI = 0
  } else if (i > 0) {
    time_of_fridge_purchase <- max_life_regular_fridge*(i-1)+(existing_refrigerator_age+1)
    NPV_new_fridge_cost_MWI = NPV_new_fridge_cost_MWI + new_fridge_cost/((1+discount_rate)^time_of_fridge_purchase)
  }
}

for(i in 0:new_fridge_requirement_DRC){
   if (i == 0) {
    NPV_new_fridge_cost_DRC = 0
  } else if (i > 0) {
    time_of_fridge_purchase <- max_life_regular_fridge*(i-1)+(existing_refrigerator_age+1)
    NPV_new_fridge_cost_DRC = NPV_new_fridge_cost_DRC + new_fridge_cost/((1+discount_rate)^time_of_fridge_purchase)
  }
}

Annualized_cost_new_fridge_NGA <- (NPV_new_fridge_cost_NGA*Health_facilities_NGA)/PVSYS_annuity_factor/10^6
Annualized_cost_new_fridge_MWI <- (NPV_new_fridge_cost_MWI*Health_facilities_MWI)/PVSYS_annuity_factor/10^6
Annualized_cost_new_fridge_DRC <- (NPV_new_fridge_cost_DRC*Health_facilities_DRC)/PVSYS_annuity_factor/10^6
Annualized_cost_new_fridge_overall <- Annualized_cost_new_fridge_NGA + Annualized_cost_new_fridge_MWI + Annualized_cost_new_fridge_DRC


####################### PV System Benefits ###################################################################################

## Cost Benefits of non-purchase of grid electricity
NGA_consumed_kWh_healthfac <- NGA_kWh_healthfac - Tot_DG_kW_demand_NGA
MWI_consumed_kWh_healthfac <- MWI_kWh_healthfac - Tot_DG_kW_demand_MWI
DRC_consumed_kWh_healthfac <- DRC_kWh_healthfac - Tot_DG_kW_demand_DRC

elec_cost_averted_NGA <- elec_tariff_NGA*NGA_consumed_kWh_healthfac
elec_cost_averted_MWI <- elec_tariff_MWI*MWI_consumed_kWh_healthfac
elec_cost_averted_DRC <- elec_tariff_DRC*DRC_consumed_kWh_healthfac


NPV_PVSYS_eleccostaverted_NGA <- 0
NPV_PVSYS_eleccostaverted_MWI <- 0
NPV_PVSYS_eleccostaverted_DRC <- 0 

for (i in 1: PVSYS_lifespan){
  NPV_PVSYS_eleccostaverted_NGA <- NPV_PVSYS_eleccostaverted_NGA +  (elec_cost_averted_NGA)/((1+discount_rate)^i)/10^6
  NPV_PVSYS_eleccostaverted_MWI <- NPV_PVSYS_eleccostaverted_MWI +  (elec_cost_averted_MWI)/((1+discount_rate)^i)/10^6
  NPV_PVSYS_eleccostaverted_DRC <- NPV_PVSYS_eleccostaverted_DRC +  (elec_cost_averted_DRC)/((1+discount_rate)^i)/10^6
}

Annualized_PVSYS_eleccostaverted_NGA <- NPV_PVSYS_eleccostaverted_NGA/PVSYS_annuity_factor
Annualized_PVSYS_eleccostaverted_MWI <- NPV_PVSYS_eleccostaverted_MWI/PVSYS_annuity_factor
Annualized_PVSYS_eleccostaverted_DRC <- NPV_PVSYS_eleccostaverted_DRC/PVSYS_annuity_factor
Annualized_PVSYS_eleccostaverted_overall <- Annualized_PVSYS_eleccostaverted_NGA + Annualized_PVSYS_eleccostaverted_MWI + Annualized_PVSYS_eleccostaverted_DRC

##Environmental benefits from non-purchase of grid electricity
grid_emission_factor_NGA <- runif(1, 0.556, 0.578) #Grid emission factor (kg CO2/kWh) sourced: Institute for Global environmental studies Oct 2022
grid_emission_factor_MWI <- runif(1, 0.243, 0.489) #Grid emission factor (kg CO2/kWh) sourced: Japan International Cooperation Agency Mar 2023
grid_emission_factor_DRC <- runif(1, 0.933, 0.9958) #Grid emission factor (kg CO2/kWh) sourced Institute for Global environmental studies Oct 2022

grid_emission_averted_NGA <- grid_emission_factor_NGA*NGA_consumed_kWh_healthfac
grid_emission_averted_MWI <- grid_emission_factor_MWI*MWI_consumed_kWh_healthfac
grid_emission_averted_DRC <- grid_emission_factor_DRC*DRC_consumed_kWh_healthfac

grid_emission_av_benefit_NGA <- grid_emission_averted_NGA*global_social_cost_carbon
grid_emission_av_benefit_MWI <- grid_emission_averted_MWI*global_social_cost_carbon
grid_emission_av_benefit_DRC <- grid_emission_averted_DRC*global_social_cost_carbon

NPV_grid_emission_av_NGA <- 0
NPV_grid_emission_av_MWI <- 0
NPV_grid_emission_av_DRC <- 0

for (i in 1:PVSYS_lifespan){
  NPV_grid_emission_av_NGA <- NPV_grid_emission_av_NGA + grid_emission_av_benefit_NGA/((1+discount_rate)^i)/10^6
  NPV_grid_emission_av_MWI <- NPV_grid_emission_av_MWI + grid_emission_av_benefit_MWI/((1+discount_rate)^i)/10^6
  NPV_grid_emission_av_DRC <- NPV_grid_emission_av_DRC + grid_emission_av_benefit_DRC/((1+discount_rate)^i)/10^6
}

Annualized_PVSYS_elec_envcostaverted_NGA <- NPV_PVSYS_eleccostaverted_NGA/PVSYS_annuity_factor
Annualized_PVSYS_elec_envcostaverted_MWI <- NPV_PVSYS_eleccostaverted_MWI/PVSYS_annuity_factor
Annualized_PVSYS_elec_envcostaverted_DRC <- NPV_PVSYS_eleccostaverted_DRC/PVSYS_annuity_factor
Annualized_PVSYS_elec_envcostaverted_overall <- Annualized_PVSYS_elec_envcostaverted_NGA + Annualized_PVSYS_elec_envcostaverted_MWI + Annualized_PVSYS_elec_envcostaverted_DRC


####################### Vaccine Costs inputs ###################################################################################
#Costs are average between PAHO 2023 quotes, GAVI and UNICEF 2021 quotes

vac_cost_NGA_HepA_HiB <- runif(1, 1.1875, 1.24) #$/dose
vac_cost_MWI_HepA_HiB <- runif(1, 1.1875, 1.24) #$/dose
vac_cost_DRC_HepA_HiB <- runif(1, 1.1875, 1.24) #$/dose

vac_cost_NGA_HPV <- runif(1, 4.04, 10.48) #$/dose
vac_cost_MWI_HPV <- runif(1, 4.04, 10.48) #$/dose
vac_cost_DRC_HPV <- runif(1, 4.04, 10.48) #$/dose

vac_cost_NGA_MR <- runif(1, 0.94, 1.9041) #$/dose
vac_cost_MWI_MR <- runif(1, 0.94, 1.9041) #$/dose
vac_cost_DRC_MR <- runif(1, 0.94, 1.9041) #$/dose

vac_cost_NGA_PCV <- runif(1, 2.9, 13.5) #$/dose
vac_cost_MWI_PCV <- runif(1, 2.9, 13.5) #$/dose
vac_cost_DRC_PCV <- runif(1, 2.9, 13.5) #$/dose

vac_cost_NGA_MenA <- runif(1, 0.67, 20.3) #$/dose
vac_cost_MWI_MenA <- runif(1, 0.67, 20.3) #$/dose
vac_cost_DRC_MenA <- runif(1, 0.67, 20.3) #$/dose

vac_cost_NGA_Rota <- runif(1, 1.48, 4.925) #$/dose
vac_cost_MWI_Rota <- runif(1, 1.48, 4.925) #$/dose
vac_cost_DRC_Rota <- runif(1, 1.48, 4.925) #$/dose

vac_cost_NGA_YF <- runif(1, 1.235, 1.41) #$/dose
vac_cost_MWI_YF <- runif(1, 1.235, 1.41) #$/dose
vac_cost_DRC_YF <- runif(1, 1.235, 1.41) #$/dose


################### Vaccine Delivery Costs inputs ############################################################################
#Portnoy et al. (2019)

vac_del_cost_NGA_HepA_HiB <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_HepA_HiB <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_HepA_HiB <- runif(1, 0.6374, 3.7016) #$/dose

vac_del_cost_NGA_HPV <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_HPV <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_HPV <- runif(1, 0.6374, 3.7016) #$/dose

vac_del_cost_NGA_MR <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_MR <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_MR <- runif(1, 0.6374, 3.7016) #$/dose

vac_del_cost_NGA_PCV <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_PCV <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_PCV <- runif(1, 0.6374, 3.7016) #$/dose

vac_del_cost_NGA_MenA <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_MenA <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_MenA <- runif(1, 0.6374, 3.7016) #$/dose

vac_del_cost_NGA_Rota <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_Rota <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_Rota <- runif(1, 0.6374, 3.7016) #$/dose

vac_del_cost_NGA_YF <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_MWI_YF <- runif(1, 0.6374, 3.7016) #$/dose
vac_del_cost_DRC_YF <- runif(1, 0.6374, 3.7016) #$/dose



#################################################################################################################################

############### Calculations for Vaccine Cost  ####################################################################################

## Vaccine Cost calculation ##

Nigeria_vac_cost <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Nigeria_vac_cost) <- c("NGA_HepA&HiB", "NGA_HPV","NGA_MR","NGA_PCV","NGA_Meningitis","NGA_Rotavirus","NGA_YF")

Malawi_vac_cost <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(Malawi_vac_cost) <- c("MWI_HepA&HiB", "MWI_HPV","MWI_MR","MWI_PCV","MWI_Meningitis","MWI_Rotavirus","MWI_YF")

DRC_vac_cost <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(DRC_vac_cost) <- c("DRC_HepA&HiB", "DRC_HPV","DRC_MR","DRC_PCV","DRC_Meningitis","DRC_Rotavirus","DRC_YF")

Total_vac_cost <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(Total_vac_cost) <- c("Total_HepA&HiB", "Total_HPV","Total_MR","Total_PCV","Total_Meningitis","Total_Rotavirus","Total_YF")

for (i in 1:vac_estimation_length){
Nigeria_vac_cost[i,1] <- Nigeria_vac_doses$`NGA_HepA&HiB`[i]*vac_cost_NGA_HepA_HiB
Malawi_vac_cost[i,1] <- Malawi_vac_doses$`MWI_HepA&HiB`[i]*vac_cost_MWI_HepA_HiB
DRC_vac_cost[i,1] <- DRC_vac_doses$`DRC_HepA&HiB`[i]*vac_cost_DRC_HepA_HiB
Total_vac_cost [i,1] <- Nigeria_vac_cost[i,1] + Malawi_vac_cost[i,1] + DRC_vac_cost[i,1]
 
Nigeria_vac_cost[i,2] <- Nigeria_vac_doses$`NGA_HPV`[i]*vac_cost_NGA_HPV
Malawi_vac_cost[i,2] <- Malawi_vac_doses$`MWI_HPV`[i]*vac_cost_MWI_HPV
DRC_vac_cost[i,2] <- DRC_vac_doses$`DRC_HPV`[i]*vac_cost_DRC_HPV
Total_vac_cost [i,2] <- Nigeria_vac_cost[i,2] + Malawi_vac_cost[i,2] + DRC_vac_cost[i,2]

Nigeria_vac_cost[i,3] <- Nigeria_vac_doses$`NGA_MR`[i]*vac_cost_NGA_MR
Malawi_vac_cost[i,3] <- Malawi_vac_doses$`MWI_MR`[i]*vac_cost_MWI_MR
DRC_vac_cost[i,3] <- DRC_vac_doses$`DRC_MR`[i]*vac_cost_DRC_MR
Total_vac_cost [i,3] <- Nigeria_vac_cost[i,3] + Malawi_vac_cost[i,3] + DRC_vac_cost[i,3]

Nigeria_vac_cost[i,4] <- Nigeria_vac_doses$`NGA_PCV`[i]*vac_cost_NGA_PCV
Malawi_vac_cost[i,4] <- Malawi_vac_doses$`MWI_PCV`[i]*vac_cost_MWI_PCV
DRC_vac_cost[i,4] <- DRC_vac_doses$`DRC_PCV`[i]*vac_cost_DRC_PCV
Total_vac_cost [i,4] <- Nigeria_vac_cost[i,4] + Malawi_vac_cost[i,4] + DRC_vac_cost[i,4]

Nigeria_vac_cost[i,5] <- Nigeria_vac_doses$`NGA_Meningitis`[i]*vac_cost_NGA_MenA
Malawi_vac_cost[i,5] <- Malawi_vac_doses$`MWI_Meningitis`[i]*vac_cost_MWI_MenA
DRC_vac_cost[i,5] <- DRC_vac_doses$`DRC_Meningitis`[i]*vac_cost_DRC_MenA
Total_vac_cost [i,5] <- Nigeria_vac_cost[i,5] + Malawi_vac_cost[i,5] + DRC_vac_cost[i,5]

Nigeria_vac_cost[i,6] <- Nigeria_vac_doses$`NGA_Rota`[i]*vac_cost_NGA_Rota
Malawi_vac_cost[i,6] <- Malawi_vac_doses$`MWI_Rota`[i]*vac_cost_MWI_Rota
DRC_vac_cost[i,6] <- DRC_vac_doses$`DRC_Rota`[i]*vac_cost_DRC_Rota
Total_vac_cost [i,6] <- Nigeria_vac_cost[i,6] + Malawi_vac_cost[i,6] + DRC_vac_cost[i,6]

Nigeria_vac_cost[i,7] <- Nigeria_vac_doses$`NGA_YF`[i]*vac_cost_NGA_YF
Malawi_vac_cost[i,7] <- Malawi_vac_doses$`MWI_YF`[i]*vac_cost_MWI_YF
DRC_vac_cost[i,7] <- DRC_vac_doses$`DRC_YF`[i]*vac_cost_DRC_YF 
Total_vac_cost [i,7] <- Nigeria_vac_cost[i,7] + Malawi_vac_cost[i,7] + DRC_vac_cost[i,7]

}

Nigeria_vac_cost <- as.data.frame(Nigeria_vac_cost)
Malawi_vac_cost <- as.data.frame(Malawi_vac_cost)
DRC_vac_cost <- as.data.frame(DRC_vac_cost)
Total_vac_cost <- as.data.frame(Total_vac_cost)

##NPV calculations
#Nigeria
NPV_NGA_vac_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_NGA_vac_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_NGA_vac_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_NGA_vac_cost [1,1] <- NPV_NGA_vac_cost [1,1]+Nigeria_vac_cost$`NGA_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_cost [1,2] <- NPV_NGA_vac_cost [1,2]+Nigeria_vac_cost$`NGA_HPV`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_cost [1,3] <- NPV_NGA_vac_cost [1,3]+Nigeria_vac_cost$`NGA_MR`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_cost [1,4] <- NPV_NGA_vac_cost [1,4]+Nigeria_vac_cost$`NGA_PCV`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_cost [1,5] <- NPV_NGA_vac_cost [1,5]+Nigeria_vac_cost$`NGA_Meningitis`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_cost [1,6] <- NPV_NGA_vac_cost [1,6]+Nigeria_vac_cost$`NGA_Rota`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_cost [1,7] <- NPV_NGA_vac_cost [1,7]+Nigeria_vac_cost$`NGA_YF`[i]/((1+discount_rate)^(i))
}
NPV_NGA_vac_cost [1,8] <- NPV_NGA_vac_cost[1,1] + NPV_NGA_vac_cost[1,2] + NPV_NGA_vac_cost[1,3] + NPV_NGA_vac_cost[1,4] + NPV_NGA_vac_cost[1,5] + NPV_NGA_vac_cost[1,6] + NPV_NGA_vac_cost[1,7]

NPV_NGA_vac_cost <- as.data.frame (NPV_NGA_vac_cost)

#Malawi
NPV_MWI_vac_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_MWI_vac_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_MWI_vac_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_MWI_vac_cost [1,1] <- NPV_MWI_vac_cost [1,1]+Malawi_vac_cost$`MWI_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_cost [1,2] <- NPV_MWI_vac_cost [1,2]+Malawi_vac_cost$`MWI_HPV`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_cost [1,3] <- NPV_MWI_vac_cost [1,3]+Malawi_vac_cost$`MWI_MR`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_cost [1,4] <- NPV_MWI_vac_cost [1,4]+Malawi_vac_cost$`MWI_PCV`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_cost [1,5] <- NPV_MWI_vac_cost [1,5]+Malawi_vac_cost$`MWI_Meningitis`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_cost [1,6] <- NPV_MWI_vac_cost [1,6]+Malawi_vac_cost$`MWI_Rota`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_cost [1,7] <- NPV_MWI_vac_cost [1,7]+Malawi_vac_cost$`MWI_YF`[i]/((1+discount_rate)^(i))
}
NPV_MWI_vac_cost [1,8] <- NPV_MWI_vac_cost[1,1] + NPV_MWI_vac_cost[1,2] + NPV_MWI_vac_cost[1,3] + NPV_MWI_vac_cost[1,4] + NPV_MWI_vac_cost[1,5] + NPV_MWI_vac_cost[1,6] + NPV_MWI_vac_cost[1,7]

NPV_MWI_vac_cost <- as.data.frame (NPV_MWI_vac_cost)


#DRC
NPV_DRC_vac_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_DRC_vac_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_DRC_vac_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_DRC_vac_cost [1,1] <- NPV_DRC_vac_cost [1,1]+DRC_vac_cost$`DRC_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_cost [1,2] <- NPV_DRC_vac_cost [1,2]+DRC_vac_cost$`DRC_HPV`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_cost [1,3] <- NPV_DRC_vac_cost [1,3]+DRC_vac_cost$`DRC_MR`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_cost [1,4] <- NPV_DRC_vac_cost [1,4]+DRC_vac_cost$`DRC_PCV`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_cost [1,5] <- NPV_DRC_vac_cost [1,5]+DRC_vac_cost$`DRC_Meningitis`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_cost [1,6] <- NPV_DRC_vac_cost [1,6]+DRC_vac_cost$`DRC_Rota`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_cost [1,7] <- NPV_DRC_vac_cost [1,7]+DRC_vac_cost$`DRC_YF`[i]/((1+discount_rate)^(i))
}
NPV_DRC_vac_cost [1,8] <- NPV_DRC_vac_cost[1,1] + NPV_DRC_vac_cost[1,2] + NPV_DRC_vac_cost[1,3] + NPV_DRC_vac_cost[1,4] + NPV_DRC_vac_cost[1,5] + NPV_DRC_vac_cost[1,6] + NPV_DRC_vac_cost[1,7]

NPV_DRC_vac_cost <- as.data.frame (NPV_DRC_vac_cost)


#Total
NPV_Tot_vac_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_Tot_vac_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_Tot_vac_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_Tot_vac_cost [1,1] <- NPV_Tot_vac_cost [1,1]+Total_vac_cost$`Total_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_Tot_vac_cost [1,2] <- NPV_Tot_vac_cost [1,2]+Total_vac_cost$`Total_HPV`[i]/((1+discount_rate)^(i)) 
NPV_Tot_vac_cost [1,3] <- NPV_Tot_vac_cost [1,3]+Total_vac_cost$`Total_MR`[i]/((1+discount_rate)^(i)) 
NPV_Tot_vac_cost [1,4] <- NPV_Tot_vac_cost [1,4]+Total_vac_cost$`Total_PCV`[i]/((1+discount_rate)^(i))   
NPV_Tot_vac_cost [1,5] <- NPV_Tot_vac_cost [1,5]+Total_vac_cost$`Total_Meningitis`[i]/((1+discount_rate)^(i))
NPV_Tot_vac_cost [1,6] <- NPV_Tot_vac_cost [1,6]+Total_vac_cost$`Total_Rota`[i]/((1+discount_rate)^(i))
NPV_Tot_vac_cost [1,7] <- NPV_Tot_vac_cost [1,7]+Total_vac_cost$`Total_YF`[i]/((1+discount_rate)^(i))
}
NPV_Tot_vac_cost [1,8] <- NPV_Tot_vac_cost[1,1] + NPV_Tot_vac_cost[1,2] + NPV_Tot_vac_cost[1,3] + NPV_Tot_vac_cost[1,4] + NPV_Tot_vac_cost[1,5] + NPV_Tot_vac_cost[1,6] + NPV_Tot_vac_cost[1,7]

NPV_Tot_vac_cost <- as.data.frame (NPV_Tot_vac_cost)


############### Calculations for Vaccine delivery cost ###########################################################################
## Vaccine delivery cost calculation

Nigeria_vac_del_cost <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Nigeria_vac_del_cost) <- c("NGA_HepA&HiB", "NGA_HPV","NGA_MR","NGA_PCV","NGA_Meningitis","NGA_Rotavirus","NGA_YF")

Malawi_vac_del_cost <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(Malawi_vac_del_cost) <- c("MWI_HepA&HiB", "MWI_HPV","MWI_MR","MWI_PCV","MWI_Meningitis","MWI_Rotavirus","MWI_YF")

DRC_vac_del_cost <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(DRC_vac_del_cost) <- c("DRC_HepA&HiB", "DRC_HPV","DRC_MR","DRC_PCV","DRC_Meningitis","DRC_Rotavirus","DRC_YF")

Total_vac_del_cost <- matrix (ncol = 7, nrow = vac_estimation_length)
colnames(Total_vac_del_cost) <- c("Total_HepA&HiB", "Total_HPV","Total_MR","Total_PCV","Total_Meningitis","Total_Rotavirus","Total_YF")

for (i in 1:vac_estimation_length){
Nigeria_vac_del_cost[i,1] <- Nigeria_vac_doses$`NGA_HepA&HiB`[i]*vac_del_cost_NGA_HepA_HiB
Malawi_vac_del_cost[i,1] <- Malawi_vac_doses$`MWI_HepA&HiB`[i]*vac_del_cost_MWI_HepA_HiB
DRC_vac_del_cost[i,1] <- DRC_vac_doses$`DRC_HepA&HiB`[i]*vac_del_cost_DRC_HepA_HiB
Total_vac_del_cost [i,1] <- Nigeria_vac_del_cost[i,1] + Malawi_vac_del_cost[i,1] + DRC_vac_del_cost[i,1]
 
Nigeria_vac_del_cost[i,2] <- Nigeria_vac_doses$`NGA_HPV`[i]*vac_del_cost_NGA_HPV
Malawi_vac_del_cost[i,2] <- Malawi_vac_doses$`MWI_HPV`[i]*vac_del_cost_MWI_HPV
DRC_vac_del_cost[i,2] <- DRC_vac_doses$`DRC_HPV`[i]*vac_del_cost_DRC_HPV
Total_vac_del_cost [i,2] <- Nigeria_vac_del_cost[i,2] + Malawi_vac_del_cost[i,2] + DRC_vac_del_cost[i,2]

Nigeria_vac_del_cost[i,3] <- Nigeria_vac_doses$`NGA_MR`[i]*vac_del_cost_NGA_MR
Malawi_vac_del_cost[i,3] <- Malawi_vac_doses$`MWI_MR`[i]*vac_del_cost_MWI_MR
DRC_vac_del_cost[i,3] <- DRC_vac_doses$`DRC_MR`[i]*vac_del_cost_DRC_MR
Total_vac_del_cost [i,3] <- Nigeria_vac_del_cost[i,3] + Malawi_vac_del_cost[i,3] + DRC_vac_del_cost[i,3]

Nigeria_vac_del_cost[i,4] <- Nigeria_vac_doses$`NGA_PCV`[i]*vac_del_cost_NGA_PCV
Malawi_vac_del_cost[i,4] <- Malawi_vac_doses$`MWI_PCV`[i]*vac_del_cost_MWI_PCV
DRC_vac_del_cost[i,4] <- DRC_vac_doses$`DRC_PCV`[i]*vac_del_cost_DRC_PCV
Total_vac_del_cost [i,4] <- Nigeria_vac_del_cost[i,4] + Malawi_vac_del_cost[i,4] + DRC_vac_del_cost[i,4]

Nigeria_vac_del_cost[i,5] <- Nigeria_vac_doses$`NGA_Meningitis`[i]*vac_del_cost_NGA_MenA
Malawi_vac_del_cost[i,5] <- Malawi_vac_doses$`MWI_Meningitis`[i]*vac_del_cost_MWI_MenA
DRC_vac_del_cost[i,5] <- DRC_vac_doses$`DRC_Meningitis`[i]*vac_del_cost_DRC_MenA
Total_vac_del_cost [i,5] <- Nigeria_vac_del_cost[i,5] + Malawi_vac_del_cost[i,5] + DRC_vac_del_cost[i,5]

Nigeria_vac_del_cost[i,6] <- Nigeria_vac_doses$`NGA_Rota`[i]*vac_del_cost_NGA_Rota
Malawi_vac_del_cost[i,6] <- Malawi_vac_doses$`MWI_Rota`[i]*vac_del_cost_MWI_Rota
DRC_vac_del_cost[i,6] <- DRC_vac_doses$`DRC_Rota`[i]*vac_del_cost_DRC_Rota
Total_vac_del_cost [i,6] <- Nigeria_vac_del_cost[i,6] + Malawi_vac_del_cost[i,6] + DRC_vac_del_cost[i,6]

Nigeria_vac_del_cost[i,7] <- Nigeria_vac_doses$`NGA_YF`[i]*vac_del_cost_NGA_YF
Malawi_vac_del_cost[i,7] <- Malawi_vac_doses$`MWI_YF`[i]*vac_del_cost_MWI_YF
DRC_vac_del_cost[i,7] <- DRC_vac_doses$`DRC_YF`[i]*vac_del_cost_DRC_YF 
Total_vac_del_cost [i,7] <- Nigeria_vac_del_cost[i,7] + Malawi_vac_del_cost[i,7] + DRC_vac_del_cost[i,7]

}

Nigeria_vac_del_cost <- as.data.frame(Nigeria_vac_del_cost)
Malawi_vac_del_cost <- as.data.frame(Malawi_vac_del_cost)
DRC_vac_del_cost <- as.data.frame(DRC_vac_del_cost)
Total_vac_del_cost <- as.data.frame(Total_vac_del_cost)

##NPV calculations
#Nigeria
NPV_NGA_vac_del_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_NGA_vac_del_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_NGA_vac_del_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_NGA_vac_del_cost [1,1] <- NPV_NGA_vac_del_cost [1,1]+Nigeria_vac_del_cost$`NGA_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_del_cost [1,2] <- NPV_NGA_vac_del_cost [1,2]+Nigeria_vac_del_cost$`NGA_HPV`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_del_cost [1,3] <- NPV_NGA_vac_del_cost [1,3]+Nigeria_vac_del_cost$`NGA_MR`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_del_cost [1,4] <- NPV_NGA_vac_del_cost [1,4]+Nigeria_vac_del_cost$`NGA_PCV`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_del_cost [1,5] <- NPV_NGA_vac_del_cost [1,5]+Nigeria_vac_del_cost$`NGA_Meningitis`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_del_cost [1,6] <- NPV_NGA_vac_del_cost [1,6]+Nigeria_vac_del_cost$`NGA_Rota`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_del_cost [1,7] <- NPV_NGA_vac_del_cost [1,7]+Nigeria_vac_del_cost$`NGA_YF`[i]/((1+discount_rate)^(i))
}
NPV_NGA_vac_del_cost [1,8] <- NPV_NGA_vac_del_cost[1,1] + NPV_NGA_vac_del_cost[1,2] + NPV_NGA_vac_del_cost[1,3] + NPV_NGA_vac_del_cost[1,4] + NPV_NGA_vac_del_cost[1,5] + NPV_NGA_vac_del_cost[1,6] + NPV_NGA_vac_del_cost[1,7]

NPV_NGA_vac_del_cost <- as.data.frame (NPV_NGA_vac_del_cost)

#Malawi
NPV_MWI_vac_del_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_MWI_vac_del_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_MWI_vac_del_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_MWI_vac_del_cost [1,1] <- NPV_MWI_vac_del_cost [1,1]+Malawi_vac_del_cost$`MWI_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_del_cost [1,2] <- NPV_MWI_vac_del_cost [1,2]+Malawi_vac_del_cost$`MWI_HPV`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_del_cost [1,3] <- NPV_MWI_vac_del_cost [1,3]+Malawi_vac_del_cost$`MWI_MR`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_del_cost [1,4] <- NPV_MWI_vac_del_cost [1,4]+Malawi_vac_del_cost$`MWI_PCV`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_del_cost [1,5] <- NPV_MWI_vac_del_cost [1,5]+Malawi_vac_del_cost$`MWI_Meningitis`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_del_cost [1,6] <- NPV_MWI_vac_del_cost [1,6]+Malawi_vac_del_cost$`MWI_Rota`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_del_cost [1,7] <- NPV_MWI_vac_del_cost [1,7]+Malawi_vac_del_cost$`MWI_YF`[i]/((1+discount_rate)^(i))
}
NPV_MWI_vac_del_cost [1,8] <- NPV_MWI_vac_del_cost[1,1] + NPV_MWI_vac_del_cost[1,2] + NPV_MWI_vac_del_cost[1,3] + NPV_MWI_vac_del_cost[1,4] + NPV_MWI_vac_del_cost[1,5] + NPV_MWI_vac_del_cost[1,6] + NPV_MWI_vac_del_cost[1,7]

NPV_MWI_vac_del_cost <- as.data.frame (NPV_MWI_vac_del_cost)


#DRC
NPV_DRC_vac_del_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_DRC_vac_del_cost) <- c("NPV_VacCost_HepA&HiB", "NPV_VacCost_HPV","NPV_VacCost_MR","NPV_VacCost_PCV","NPV_VacCost_Meningitis","NPV_VacCost_Rotavirus","NPV_VacCost_YF","NPV_VacCost_Overall")

NPV_DRC_vac_del_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_DRC_vac_del_cost [1,1] <- NPV_DRC_vac_del_cost [1,1]+DRC_vac_del_cost$`DRC_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_del_cost [1,2] <- NPV_DRC_vac_del_cost [1,2]+DRC_vac_del_cost$`DRC_HPV`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_del_cost [1,3] <- NPV_DRC_vac_del_cost [1,3]+DRC_vac_del_cost$`DRC_MR`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_del_cost [1,4] <- NPV_DRC_vac_del_cost [1,4]+DRC_vac_del_cost$`DRC_PCV`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_del_cost [1,5] <- NPV_DRC_vac_del_cost [1,5]+DRC_vac_del_cost$`DRC_Meningitis`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_del_cost [1,6] <- NPV_DRC_vac_del_cost [1,6]+DRC_vac_del_cost$`DRC_Rota`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_del_cost [1,7] <- NPV_DRC_vac_del_cost [1,7]+DRC_vac_del_cost$`DRC_YF`[i]/((1+discount_rate)^(i))
}
NPV_DRC_vac_del_cost [1,8] <- NPV_DRC_vac_del_cost[1,1] + NPV_DRC_vac_del_cost[1,2] + NPV_DRC_vac_del_cost[1,3] + NPV_DRC_vac_del_cost[1,4] + NPV_DRC_vac_del_cost[1,5] + NPV_DRC_vac_del_cost[1,6] + NPV_DRC_vac_del_cost[1,7]

NPV_DRC_vac_del_cost <- as.data.frame (NPV_DRC_vac_del_cost)


#Total

NPV_Tot_vac_del_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_Tot_vac_del_cost) <- c("NPV_VacDelCost_HepA&HiB", "NPV_VacDelCost_HPV","NPV_VacDelCost_MR","NPV_VacDelCost_PCV","NPV_VacDelCost_Meningitis","NPV_VacDelCost_Rotavirus","NPV_VacDelCost_YF","NPV_VacDelCost_Overall")

NPV_Tot_vac_del_cost[1,] <- 0

for (i in 1:vac_estimation_length){

NPV_Tot_vac_del_cost [1,1] <- NPV_Tot_vac_del_cost [1,1]+Total_vac_del_cost$`Total_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_Tot_vac_del_cost [1,2] <- NPV_Tot_vac_del_cost [1,2]+Total_vac_del_cost$`Total_HPV`[i]/((1+discount_rate)^(i)) 
NPV_Tot_vac_del_cost [1,3] <- NPV_Tot_vac_del_cost [1,3]+Total_vac_del_cost$`Total_MR`[i]/((1+discount_rate)^(i)) 
NPV_Tot_vac_del_cost [1,4] <- NPV_Tot_vac_del_cost [1,4]+Total_vac_del_cost$`Total_PCV`[i]/((1+discount_rate)^(i))   
NPV_Tot_vac_del_cost [1,5] <- NPV_Tot_vac_del_cost [1,5]+Total_vac_del_cost$`Total_Meningitis`[i]/((1+discount_rate)^(i))
NPV_Tot_vac_del_cost [1,6] <- NPV_Tot_vac_del_cost [1,6]+Total_vac_del_cost$`Total_Rota`[i]/((1+discount_rate)^(i))
NPV_Tot_vac_del_cost [1,7] <- NPV_Tot_vac_del_cost [1,7]+Total_vac_del_cost$`Total_YF`[i]/((1+discount_rate)^(i))
}
NPV_Tot_vac_del_cost [1,8] <- NPV_Tot_vac_del_cost[1,1] + NPV_Tot_vac_del_cost[1,2] + NPV_Tot_vac_del_cost[1,3] + NPV_Tot_vac_del_cost[1,4] + NPV_Tot_vac_del_cost[1,5] + NPV_Tot_vac_del_cost[1,6] + NPV_Tot_vac_del_cost[1,7]

NPV_Tot_vac_del_cost <- as.data.frame (NPV_Tot_vac_del_cost)


############### Calculations for Total Vaccine costs ###########################################################################
#Nigeria
NPV_NGA_vac_total_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_NGA_vac_total_cost) <- c("NPV_VacTotCost_HepA&HiB", "NPV_VacTotCost_HPV","NPV_VacTotCost_MR","NPV_VacTotCost_PCV","NPV_VacTotCost_Meningitis","NPV_VacTotCost_Rotavirus","NPV_VacTotCost_YF","NPV_VacTotCost_Overall")

for (i in 1: ncol(NPV_NGA_vac_total_cost)){
  NPV_NGA_vac_total_cost[1,i] <- NPV_NGA_vac_cost [1,i] + NPV_NGA_vac_del_cost [1,i]
  
}
NPV_NGA_vac_total_cost <- as.data.frame(NPV_NGA_vac_total_cost)

#Malawi
NPV_MWI_vac_total_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_MWI_vac_total_cost) <- c("NPV_VacTotCost_HepA&HiB", "NPV_VacTotCost_HPV","NPV_VacTotCost_MR","NPV_VacTotCost_PCV","NPV_VacTotCost_Meningitis","NPV_VacTotCost_Rotavirus","NPV_VacTotCost_YF","NPV_VacTotCost_Overall")

for (i in 1: ncol(NPV_MWI_vac_total_cost)){
  NPV_MWI_vac_total_cost[1,i] <- NPV_MWI_vac_cost [1,i] + NPV_MWI_vac_del_cost [1,i]
  
}
NPV_MWI_vac_total_cost <- as.data.frame(NPV_MWI_vac_total_cost)

#DRC
NPV_DRC_vac_total_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_DRC_vac_total_cost) <- c("NPV_VacTotCost_HepA&HiB", "NPV_VacTotCost_HPV","NPV_VacTotCost_MR","NPV_VacTotCost_PCV","NPV_VacTotCost_Meningitis","NPV_VacTotCost_Rotavirus","NPV_VacTotCost_YF","NPV_VacTotCost_Overall")

for (i in 1: ncol(NPV_DRC_vac_total_cost)){
  NPV_DRC_vac_total_cost[1,i] <- NPV_DRC_vac_cost [1,i] + NPV_DRC_vac_del_cost [1,i]
  
}
NPV_DRC_vac_total_cost <- as.data.frame(NPV_DRC_vac_total_cost)


#Total
NPV_vac_total_cost <- matrix(ncol = 8, nrow = 1)

colnames(NPV_vac_total_cost) <- c("NPV_VacTotCost_HepA&HiB", "NPV_VacTotCost_HPV","NPV_VacTotCost_MR","NPV_VacTotCost_PCV","NPV_VacTotCost_Meningitis","NPV_VacTotCost_Rotavirus","NPV_VacTotCost_YF","NPV_VacTotCost_Overall")

for (i in 1: ncol(NPV_vac_total_cost)){
  NPV_vac_total_cost[1,i] <- NPV_Tot_vac_cost [1,i] + NPV_Tot_vac_del_cost [1,i]
  
}
NPV_vac_total_cost <- as.data.frame(NPV_vac_total_cost)


### Annualized Costs ###
#Nigeria
Annualized_NGA_vac_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_NGA_vac_cost) <- c("Annualized_VacCost_HepA&HiB", "Annualized_VacCost_HPV","Annualized_VacCost_MR","Annualized_VacCost_PCV","Annualized_VacCost_Meningitis","Annualized_VacCost_Rotavirus","Annualized_VacCost_YF","Annualized_VacCost_Overall")
for (i in 1: ncol(Annualized_NGA_vac_cost)){
  Annualized_NGA_vac_cost[1,i] <- NPV_NGA_vac_cost [1,i]/vaccine_annuity_factor
}

Annualized_NGA_vac_cost <- as.data.frame(Annualized_NGA_vac_cost)

Annualized_NGA_vac_del_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_NGA_vac_del_cost) <- c("Annualized_VacdelCost_HepA&HiB", "Annualized_VacdelCost_HPV","Annualized_VacdelCost_MR","Annualized_VacdelCost_PCV","Annualized_VacdelCost_Meningitis","Annualized_VacdelCost_Rotavirus","Annualized_VacdelCost_YF","Annualized_VacdelCost_Overall")
for (i in 1: ncol(Annualized_NGA_vac_del_cost)){
  Annualized_NGA_vac_del_cost[1,i] <- NPV_NGA_vac_del_cost [1,i]/vaccine_annuity_factor
}
Annualized_NGA_vac_del_cost <- as.data.frame(Annualized_NGA_vac_del_cost)


Annualized_NGA_vac_total_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_NGA_vac_total_cost) <- c("Annualized_VacTotCost_HepA&HiB", "Annualized_VacTotCost_HPV","Annualized_VacTotCost_MR","Annualized_VacTotCost_PCV","Annualized_VacTotCost_Meningitis","Annualized_VacTotCost_Rotavirus","Annualized_VacTotCost_YF","Annualized_VacTotCost_Overall")
for (i in 1: ncol(Annualized_NGA_vac_total_cost)){
  Annualized_NGA_vac_total_cost[1,i] <- NPV_NGA_vac_total_cost [1,i]/vaccine_annuity_factor

}
Annualized_NGA_vac_total_cost <- as.data.frame(Annualized_NGA_vac_total_cost)

#Malawi

Annualized_MWI_vac_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_MWI_vac_cost) <- c("Annualized_VacCost_HepA&HiB", "Annualized_VacCost_HPV","Annualized_VacCost_MR","Annualized_VacCost_PCV","Annualized_VacCost_Meningitis","Annualized_VacCost_Rotavirus","Annualized_VacCost_YF","Annualized_VacCost_Overall")
for (i in 1: ncol(Annualized_MWI_vac_cost)){
  Annualized_MWI_vac_cost[1,i] <- NPV_MWI_vac_cost [1,i]/vaccine_annuity_factor
}

Annualized_MWI_vac_cost <- as.data.frame(Annualized_MWI_vac_cost)

Annualized_MWI_vac_del_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_MWI_vac_del_cost) <- c("Annualized_VacdelCost_HepA&HiB", "Annualized_VacdelCost_HPV","Annualized_VacdelCost_MR","Annualized_VacdelCost_PCV","Annualized_VacdelCost_Meningitis","Annualized_VacdelCost_Rotavirus","Annualized_VacdelCost_YF","Annualized_VacdelCost_Overall")
for (i in 1: ncol(Annualized_MWI_vac_del_cost)){
  Annualized_MWI_vac_del_cost[1,i] <- NPV_MWI_vac_del_cost [1,i]/vaccine_annuity_factor
}
Annualized_MWI_vac_del_cost <- as.data.frame(Annualized_MWI_vac_del_cost)


Annualized_MWI_vac_total_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_MWI_vac_total_cost) <- c("Annualized_VacTotCost_HepA&HiB", "Annualized_VacTotCost_HPV","Annualized_VacTotCost_MR","Annualized_VacTotCost_PCV","Annualized_VacTotCost_Meningitis","Annualized_VacTotCost_Rotavirus","Annualized_VacTotCost_YF","Annualized_VacTotCost_Overall")
for (i in 1: ncol(Annualized_MWI_vac_total_cost)){
  Annualized_MWI_vac_total_cost[1,i] <- NPV_MWI_vac_total_cost [1,i]/vaccine_annuity_factor

}
Annualized_MWI_vac_total_cost <- as.data.frame(Annualized_MWI_vac_total_cost)


#DRC

Annualized_DRC_vac_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DRC_vac_cost) <- c("Annualized_VacCost_HepA&HiB", "Annualized_VacCost_HPV","Annualized_VacCost_MR","Annualized_VacCost_PCV","Annualized_VacCost_Meningitis","Annualized_VacCost_Rotavirus","Annualized_VacCost_YF","Annualized_VacCost_Overall")
for (i in 1: ncol(Annualized_DRC_vac_cost)){
  Annualized_DRC_vac_cost[1,i] <- NPV_DRC_vac_cost [1,i]/vaccine_annuity_factor
}

Annualized_DRC_vac_cost <- as.data.frame(Annualized_DRC_vac_cost)

Annualized_DRC_vac_del_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DRC_vac_del_cost) <- c("Annualized_VacdelCost_HepA&HiB", "Annualized_VacdelCost_HPV","Annualized_VacdelCost_MR","Annualized_VacdelCost_PCV","Annualized_VacdelCost_Meningitis","Annualized_VacdelCost_Rotavirus","Annualized_VacdelCost_YF","Annualized_VacdelCost_Overall")
for (i in 1: ncol(Annualized_DRC_vac_del_cost)){
  Annualized_DRC_vac_del_cost[1,i] <- NPV_DRC_vac_del_cost [1,i]/vaccine_annuity_factor
}
Annualized_DRC_vac_del_cost <- as.data.frame(Annualized_DRC_vac_del_cost)


Annualized_DRC_vac_total_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DRC_vac_total_cost) <- c("Annualized_VacTotCost_HepA&HiB", "Annualized_VacTotCost_HPV","Annualized_VacTotCost_MR","Annualized_VacTotCost_PCV","Annualized_VacTotCost_Meningitis","Annualized_VacTotCost_Rotavirus","Annualized_VacTotCost_YF","Annualized_VacTotCost_Overall")
for (i in 1: ncol(Annualized_DRC_vac_total_cost)){
  Annualized_DRC_vac_total_cost[1,i] <- NPV_DRC_vac_total_cost [1,i]/vaccine_annuity_factor

}
Annualized_DRC_vac_total_cost <- as.data.frame(Annualized_DRC_vac_total_cost)

#Overall
Annualized_vac_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_vac_cost) <- c("Annualized_VacCost_HepA&HiB", "Annualized_VacCost_HPV","Annualized_VacCost_MR","Annualized_VacCost_PCV","Annualized_VacCost_Meningitis","Annualized_VacCost_Rotavirus","Annualized_VacCost_YF","Annualized_VacCost_Overall")
for (i in 1: ncol(Annualized_vac_cost)){
  Annualized_vac_cost[1,i] <- NPV_Tot_vac_cost [1,i]/vaccine_annuity_factor
}

Annualized_vac_cost <- as.data.frame(Annualized_vac_cost)

Annualized_vac_del_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_vac_del_cost) <- c("Annualized_VacdelCost_HepA&HiB", "Annualized_VacdelCost_HPV","Annualized_VacdelCost_MR","Annualized_VacdelCost_PCV","Annualized_VacdelCost_Meningitis","Annualized_VacdelCost_Rotavirus","Annualized_VacdelCost_YF","Annualized_VacdelCost_Overall")
for (i in 1: ncol(Annualized_vac_del_cost)){
  Annualized_vac_del_cost[1,i] <- NPV_Tot_vac_del_cost [1,i]/vaccine_annuity_factor
}
Annualized_vac_del_cost <- as.data.frame(Annualized_vac_del_cost)


Annualized_vac_total_cost <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_vac_total_cost) <- c("Annualized_VacTotCost_HepA&HiB", "Annualized_VacTotCost_HPV","Annualized_VacTotCost_MR","Annualized_VacTotCost_PCV","Annualized_VacTotCost_Meningitis","Annualized_VacTotCost_Rotavirus","Annualized_VacTotCost_YF","Annualized_VacTotCost_Overall")
for (i in 1: ncol(Annualized_vac_total_cost)){
  Annualized_vac_total_cost[1,i] <- NPV_vac_total_cost [1,i]/vaccine_annuity_factor
}
Annualized_vac_total_cost <- as.data.frame(Annualized_vac_total_cost)
#################################################################################################################################

#################################################################################################################################
######################## BENEFIT CALCULATIONS ###################################################################################
#################################################################################################################################

######################## COI Method inputs ######################################################################################
# Cost of illness (COI) Averted ($, 2023; per dose)
# (Ozawa et al., 2017)

vac_COI_NGA_HepA_HiB <- runif(1, 24.45341, 72.95934) #$/dose
vac_COI_MWI_HepA_HiB <- runif(1, 24.45341, 72.95934) #$/dose
vac_COI_DRC_HepA_HiB <- runif(1, 24.45341, 72.95934) #$/dose

vac_COI_NGA_HPV <- runif(1, 61.33395, 106.31218) #$/dose
vac_COI_MWI_HPV <- runif(1, 61.33395, 106.31218) #$/dose
vac_COI_DRC_HPV <- runif(1, 61.33395, 106.31218) #$/dose

vac_COI_NGA_MR <- runif(1, 3.0066, 88.5935) #$/dose
vac_COI_MWI_MR <- runif(1, 3.0066, 88.5935) #$/dose
vac_COI_DRC_MR <- runif(1, 3.0066, 88.5935) #$/dose

vac_COI_NGA_PCV <- runif(1, 48.90681, 84.77181) #$/dose
vac_COI_MWI_PCV <- runif(1, 48.90681, 84.77181) #$/dose
vac_COI_DRC_PCV <- runif(1, 48.90681, 84.77181) #$/dose

vac_COI_NGA_MenA <- runif(1, 30.0657, 52.1138) #$/dose
vac_COI_MWI_MenA <- runif(1, 30.0657, 52.1138) #$/dose
vac_COI_DRC_MenA <- runif(1, 30.0657, 52.1138) #$/dose

vac_COI_NGA_Rota <- runif(1, 14.8324, 25.7095) #$/dose
vac_COI_MWI_Rota <- runif(1, 14.8324, 25.7095) #$/dose
vac_COI_DRC_Rota <- runif(1, 14.8324, 25.7095) #$/dose

vac_COI_NGA_YF <- runif(1, 86.5891, 150.0878) #$/dose
vac_COI_MWI_YF <- runif(1, 86.5891, 150.0878) #$/dose
vac_COI_DRC_YF <- runif(1, 86.5891, 150.0878) #$/dose

######################### VSL Method Inputs #####################################################################################

# Value of Statistical Life (VSL) method (based on Death averted)

USA_VSL <- 22.75595 # $ million, USA VSL 2022 for adult ($11377977.3824) x 2   
USA_GDP <- 76398.5917 #GDP per capita (PPP) current US$, 2022
NGA_GDP <- 5860.2937 #GDP per capita (PPP) current US$, 2022
MWI_GDP <- 1732.0303 #GDP per capita (PPP) current US$, 2022
DRC_GDP <- 1337.3911 #GDP per capita (PPP) current US$, 2022

income_elasticity <- runif(1, 1.1, 2.6) # Robsinson et al. 2019 ##Chi sq distribution

NGA_VSL <- USA_VSL*((NGA_GDP/USA_GDP)^income_elasticity)
MWI_VSL <- USA_VSL*((MWI_GDP/USA_GDP)^income_elasticity)
DRC_VSL <- USA_VSL*((DRC_GDP/USA_GDP)^income_elasticity)


######################### VSLY Method Inputs ####################################################################################

VSLY_data <- matrix (ncol = 7, nrow = 3)
colnames(VSLY_data) <- c("HepA&HiB", "HPV","MR","PCV","Meningitis","Rotavirus","YF")
rownames(VSLY_data) <- c("NGA", "MWI", "DRC")

HepA_Lifeyears <- 42 #average number of remaining life years for the average person impacted by HepA
HiB_Lifeyears <- 67 #average number of remaining life years for the average person impacted by HiB
HPV_Lifeyears <- 16 #average number of remaining life years for the average person impacted by HPV
Measles_Lifeyears <- 58.5 #average number of remaining life years for the average person impacted by Measles
Rubella_Lifeyears <- 65.5 #average number of remaining life years for the average person impacted by Rubella
PCV_Lifeyears <- 67 #average number of remaining life years for the average person impacted by PCV
Meningitis_Lifeyears <- 61 #average number of remaining life years for the average person impacted by Meningitis
Rota_Lifeyears <- 67 #average number of remaining life years for the average person impacted by Rota virus
YF_Lifeyears <- 48.5 #average number of remaining life years for the average person impacted by Yellow fever

NGA_VSLY_numerator <- discount_rate*NGA_VSL
MWI_VSLY_numerator <- discount_rate*MWI_VSL
DRC_VSLY_numerator <- discount_rate*DRC_VSL


VSLY_data [1,] <- c(mean(NGA_VSLY_numerator/(1-((1+discount_rate)^-HepA_Lifeyears)),NGA_VSLY_numerator/(1-((1+discount_rate)^-HiB_Lifeyears))), NGA_VSLY_numerator/(1-((1+discount_rate)^-HPV_Lifeyears)), mean(NGA_VSLY_numerator/(1-((1+discount_rate)^-Measles_Lifeyears)),NGA_VSLY_numerator/(1-((1+discount_rate)^-Rubella_Lifeyears))), NGA_VSLY_numerator/(1-((1+discount_rate)^-PCV_Lifeyears)), NGA_VSLY_numerator/(1-((1+discount_rate)^-Meningitis_Lifeyears)), NGA_VSLY_numerator/(1-((1+discount_rate)^-Rota_Lifeyears)), NGA_VSLY_numerator/(1-((1+discount_rate)^-YF_Lifeyears)))

VSLY_data [2,] <- c(mean(MWI_VSLY_numerator/(1-((1+discount_rate)^-HepA_Lifeyears)),MWI_VSLY_numerator/(1-((1+discount_rate)^-HiB_Lifeyears))), MWI_VSLY_numerator/(1-((1+discount_rate)^-HPV_Lifeyears)), mean(MWI_VSLY_numerator/(1-((1+discount_rate)^-Measles_Lifeyears)),MWI_VSLY_numerator/(1-((1+discount_rate)^-Rubella_Lifeyears))), MWI_VSLY_numerator/(1-((1+discount_rate)^-PCV_Lifeyears)), MWI_VSLY_numerator/(1-((1+discount_rate)^-Meningitis_Lifeyears)), MWI_VSLY_numerator/(1-((1+discount_rate)^-Rota_Lifeyears)), MWI_VSLY_numerator/(1-((1+discount_rate)^-YF_Lifeyears)))

VSLY_data [3,] <- c(mean(DRC_VSLY_numerator/(1-((1+discount_rate)^-HepA_Lifeyears)),DRC_VSLY_numerator/(1-((1+discount_rate)^-HiB_Lifeyears))), DRC_VSLY_numerator/(1-((1+discount_rate)^-HPV_Lifeyears)), mean(DRC_VSLY_numerator/(1-((1+discount_rate)^-Measles_Lifeyears)),DRC_VSLY_numerator/(1-((1+discount_rate)^-Rubella_Lifeyears))), DRC_VSLY_numerator/(1-((1+discount_rate)^-PCV_Lifeyears)), DRC_VSLY_numerator/(1-((1+discount_rate)^-Meningitis_Lifeyears)), DRC_VSLY_numerator/(1-((1+discount_rate)^-Rota_Lifeyears)), DRC_VSLY_numerator/(1-((1+discount_rate)^-YF_Lifeyears)))

VSLY_data <- as.data.frame(VSLY_data)

############################# COI METHOD #####################################################################################

Nigeria_vac_COI <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Nigeria_vac_COI) <- c("NGA_HepA&HiB", "NGA_HPV","NGA_MR","NGA_PCV","NGA_Meningitis","NGA_Rotavirus","NGA_YF")

Malawi_vac_COI <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Malawi_vac_COI) <- c("MWI_HepA&HiB", "MWI_HPV","MWI_MR","MWI_PCV","MWI_Meningitis","MWI_Rotavirus","MWI_YF")

DRC_vac_COI <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(DRC_vac_COI) <- c("DRC_HepA&HiB", "DRC_HPV","DRC_MR","DRC_PCV","DRC_Meningitis","DRC_Rotavirus","DRC_YF")

Total_vac_COI <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Total_vac_COI) <- c("Total_HepA&HiB", "Total_HPV","Total_MR","Total_PCV","Total_Meningitis","Total_Rotavirus","Total_YF")


for (i in 1:vac_estimation_length){

#HepA_HiB#
  
  Nigeria_vac_COI[i,1] <- Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_HepA_Hib)* vac_recommended_dose_HepA_Hib *vac_COI_NGA_HepA_HiB
Malawi_vac_COI[i,1] <- Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_HepA_Hib)*  vac_recommended_dose_HepA_Hib *vac_COI_MWI_HepA_HiB
DRC_vac_COI[i,1] <- DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_HepA_Hib)* vac_recommended_dose_HepA_Hib *vac_COI_DRC_HepA_HiB
Total_vac_COI [i,1] <- Nigeria_vac_COI[i,1] + Malawi_vac_COI[i,1] + DRC_vac_COI[i,1]

#HPV#

  if (i %in% c(1, 2)) {
    vac_coverage_NGA_HPV_calc = 0
  } else if (i == 3) {
    vac_coverage_NGA_HPV_calc = 0.1407
  } else if (i == 4) {
    vac_coverage_NGA_HPV_calc = 0.1407 * 2
  } else if (i == 5) {
    vac_coverage_NGA_HPV_calc = 0.1407 * 3
  } else if (i > 5) {
    vac_coverage_NGA_HPV_calc = vac_coverage_NGA_HPV
  }

  Nigeria_vac_COI[i, 2] = Nigeria_pop$`Nigeria_Female_10to14(million)`[i] * vac_coverage_NGA_HPV_calc * vac_recommended_dose_HPV * vac_COI_NGA_HPV
  
  if (i ==1) {
    vac_coverage_MWI_HPV_calc = 0.12
  } else if (i == 2) {
    vac_coverage_MWI_HPV_calc = 0.1407
  } else if (i == 3) {
    vac_coverage_MWI_HPV_calc = 0.1407 * 2
  } else if (i == 4) {
    vac_coverage_MWI_HPV_calc = 0.1407 * 3
  } else if (i > 4) {
    vac_coverage_MWI_HPV_calc = vac_coverage_MWI_HPV
  }

  Malawi_vac_COI[i, 2] = Malawi_pop$`Malawi_Female_10to14(million)`[i] * vac_coverage_MWI_HPV_calc * vac_recommended_dose_HPV * vac_COI_MWI_HPV
  
  if (i %in% c(1, 2)) {
    vac_coverage_DRC_HPV_calc = 0
  } else if (i == 3) {
    vac_coverage_DRC_HPV_calc = 0.1407
  } else if (i == 4) {
    vac_coverage_DRC_HPV_calc = 0.1407 * 2
  } else if (i == 5) {
    vac_coverage_DRC_HPV_calc = 0.1407 * 3
  } else if (i > 5) {
    vac_coverage_DRC_HPV_calc = vac_coverage_DRC_HPV
  }

  DRC_vac_COI[i, 2] = DRC_pop$`DRC_Female_10to14(million)`[i] * vac_coverage_DRC_HPV_calc * vac_recommended_dose_HPV * vac_COI_DRC_HPV

  Total_vac_COI [i,2] <- Nigeria_vac_COI[i,2] + Malawi_vac_COI[i,2] + DRC_vac_COI[i,2]
  
#Measles and Rubella#

  Nigeria_vac_COI [i,3] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_MR)*vac_recommended_dose_MR*vac_COI_NGA_MR
  
  Malawi_vac_COI [i,3] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_MR)*vac_recommended_dose_MR*vac_COI_MWI_MR
  
  DRC_vac_COI [i,3] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_MR)*vac_recommended_dose_MR*vac_COI_DRC_MR
  
   Total_vac_COI [i,3] <- Nigeria_vac_COI[i,3] + Malawi_vac_COI[i,3] + DRC_vac_COI[i,3]

#PCV#

  Nigeria_vac_COI [i,4] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_PCV)*vac_recommended_dose_PCV*vac_COI_NGA_PCV
  
  Malawi_vac_COI [i,4] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_PCV)*vac_recommended_dose_PCV*vac_COI_MWI_PCV
  
  DRC_vac_COI [i,4] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_PCV)*vac_recommended_dose_PCV*vac_COI_DRC_PCV
  
  Total_vac_COI [i,4] <- Nigeria_vac_COI[i,4] + Malawi_vac_COI[i,4] + DRC_vac_COI[i,4]

#Menningitis A#

  if (i == 1) {
    vac_coverage_NGA_MenA_calc = 0.5
  } else if (i > 1) {
    vac_coverage_NGA_MenA_calc = vac_coverage_NGA_MenA
  }

  Nigeria_vac_COI[i, 5] = Nigeria_pop$`Nigeria_New_born(million)`[i] * vac_coverage_NGA_MenA_calc * vac_recommended_dose_MenA * vac_COI_NGA_MenA
  
  Malawi_vac_COI[i, 5] = Malawi_pop$`Malawi_New_born(million)`[i] * vac_coverage_MWI_MenA * vac_recommended_dose_MenA * vac_COI_MWI_MenA
  
DRC_vac_COI[i, 5] = DRC_pop$`DRC_New_born(million)`[i] * vac_coverage_DRC_MenA * vac_recommended_dose_MenA * vac_COI_DRC_MenA

Total_vac_COI [i,5] <- Nigeria_vac_COI[i,5] + Malawi_vac_COI[i,5] + DRC_vac_COI[i,5]
    
#Rota#

  if (i == 1) {
    vac_coverage_NGA_Rota_calc = 0
  } else if (i == 2) {
    vac_coverage_NGA_Rota_calc = 0.12
  } else if (i == 3) {
    vac_coverage_NGA_Rota_calc = 0.12*2
  } else if (i == 4) {
    vac_coverage_NGA_Rota_calc = 0.12*4
  } else if (i > 4) {
    vac_coverage_NGA_Rota_calc = vac_coverage_NGA_Rota
  }

  Nigeria_vac_COI[i, 6] = Nigeria_pop$`Nigeria_New_born(million)`[i] * vac_coverage_NGA_Rota_calc * vac_recommended_dose_Rota * vac_COI_NGA_Rota
  
  Malawi_vac_COI[i, 6] = Malawi_pop$`Malawi_New_born(million)`[i] * vac_coverage_MWI_Rota * vac_recommended_dose_Rota_MWI * vac_COI_MWI_Rota
  
  DRC_vac_COI[i, 6] = DRC_pop$`DRC_New_born(million)`[i] * vac_coverage_DRC_Rota * vac_recommended_dose_Rota * vac_COI_DRC_Rota
  
  Total_vac_COI [i,6] <- Nigeria_vac_COI[i,6] + Malawi_vac_COI[i,6] + DRC_vac_COI[i,6]

#Yellow Fever#

  Nigeria_vac_COI [i,7] = Nigeria_pop$`Nigeria_New_born(million)`[i]*(vac_coverage_NGA_YF)*vac_recommended_dose_YF*vac_COI_NGA_YF
  
  Malawi_vac_COI [i,7] = Malawi_pop$`Malawi_New_born(million)`[i]*(vac_coverage_MWI_YF)*vac_recommended_dose_YF*vac_COI_MWI_YF
  
  DRC_vac_COI [i,7] = DRC_pop$`DRC_New_born(million)`[i]*(vac_coverage_DRC_YF)*vac_recommended_dose_YF*vac_COI_DRC_YF 

Total_vac_COI [i,7] <- Nigeria_vac_COI[i,7] + Malawi_vac_COI[i,7] + DRC_vac_COI[i,7]
  
  }

Nigeria_vac_COI <- as.data.frame(Nigeria_vac_COI)
Malawi_vac_COI <- as.data.frame(Malawi_vac_COI)
DRC_vac_COI <- as.data.frame(DRC_vac_COI)
Total_vac_COI <- as.data.frame(Total_vac_COI)

###NPV Calculations
#Nigeria
NPV_NGA_vac_COI <- matrix(ncol = 8, nrow = 1)

colnames(NPV_NGA_vac_COI) <- c("NPV_VacCOI_HepA&HiB", "NPV_VacCOI_HPV","NPV_VacCOI_MR","NPV_VacCOI_PCV","NPV_VacCOI_Meningitis","NPV_VacCOI_Rotavirus","NPV_VacCOI_YF","NPV_VacCOI_Overall")

NPV_NGA_vac_COI[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_NGA_vac_COI [1,1] <- NPV_NGA_vac_COI [1,1]+Nigeria_vac_COI$`NGA_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_COI [1,2] <- NPV_NGA_vac_COI [1,2]+Nigeria_vac_COI$`NGA_HPV`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_COI [1,3] <- NPV_NGA_vac_COI [1,3]+Nigeria_vac_COI$`NGA_MR`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_COI [1,4] <- NPV_NGA_vac_COI [1,4]+Nigeria_vac_COI$`NGA_PCV`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_COI [1,5] <- NPV_NGA_vac_COI [1,5]+Nigeria_vac_COI$`NGA_Meningitis`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_COI [1,6] <- NPV_NGA_vac_COI [1,6]+Nigeria_vac_COI$`NGA_Rota`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_COI [1,7] <- NPV_NGA_vac_COI [1,7]+Nigeria_vac_COI$`NGA_YF`[i]/((1+discount_rate)^(i))
}
NPV_NGA_vac_COI [1,8] <- NPV_NGA_vac_COI[1,1] + NPV_NGA_vac_COI[1,2] + NPV_NGA_vac_COI[1,3] + NPV_NGA_vac_COI[1,4] + NPV_NGA_vac_COI[1,5] + NPV_NGA_vac_COI[1,6] + NPV_NGA_vac_COI[1,7]

NPV_NGA_vac_COI <- as.data.frame (NPV_NGA_vac_COI)

Annualized_NGA_vac_COI <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_NGA_vac_COI) <- c("Annualized_VacCOI_HepA&HiB", "Annualized_VacCOI_HPV","Annualized_VacCOI_MR","Annualized_VacCOI_PCV","Annualized_VacCOI_Meningitis","Annualized_VacCOI_Rotavirus","Annualized_VacCOI_YF","Annualized_VacCOI_Overall")
for (i in 1: ncol(Annualized_NGA_vac_COI)){
  Annualized_NGA_vac_COI[1,i] <- NPV_NGA_vac_COI [1,i]/vaccine_annuity_factor
}

Annualized_NGA_vac_COI <- as.data.frame(Annualized_NGA_vac_COI)


#Malawi
NPV_MWI_vac_COI <- matrix(ncol = 8, nrow = 1)

colnames(NPV_MWI_vac_COI) <- c("NPV_VacCOI_HepA&HiB", "NPV_VacCOI_HPV","NPV_VacCOI_MR","NPV_VacCOI_PCV","NPV_VacCOI_Meningitis","NPV_VacCOI_Rotavirus","NPV_VacCOI_YF","NPV_VacCOI_Overall")

NPV_MWI_vac_COI[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_MWI_vac_COI [1,1] <- NPV_MWI_vac_COI [1,1]+Malawi_vac_COI$`MWI_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_COI [1,2] <- NPV_MWI_vac_COI [1,2]+Malawi_vac_COI$`MWI_HPV`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_COI [1,3] <- NPV_MWI_vac_COI [1,3]+Malawi_vac_COI$`MWI_MR`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_COI [1,4] <- NPV_MWI_vac_COI [1,4]+Malawi_vac_COI$`MWI_PCV`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_COI [1,5] <- NPV_MWI_vac_COI [1,5]+Malawi_vac_COI$`MWI_Meningitis`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_COI [1,6] <- NPV_MWI_vac_COI [1,6]+Malawi_vac_COI$`MWI_Rota`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_COI [1,7] <- NPV_MWI_vac_COI [1,7]+Malawi_vac_COI$`MWI_YF`[i]/((1+discount_rate)^(i))
}
NPV_MWI_vac_COI [1,8] <- NPV_MWI_vac_COI[1,1] + NPV_MWI_vac_COI[1,2] + NPV_MWI_vac_COI[1,3] + NPV_MWI_vac_COI[1,4] + NPV_MWI_vac_COI[1,5] + NPV_MWI_vac_COI[1,6] + NPV_MWI_vac_COI[1,7]

NPV_MWI_vac_COI <- as.data.frame (NPV_MWI_vac_COI)

Annualized_MWI_vac_COI <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_MWI_vac_COI) <- c("Annualized_VacCOI_HepA&HiB", "Annualized_VacCOI_HPV","Annualized_VacCOI_MR","Annualized_VacCOI_PCV","Annualized_VacCOI_Meningitis","Annualized_VacCOI_Rotavirus","Annualized_VacCOI_YF","Annualized_VacCOI_Overall")
for (i in 1: ncol(Annualized_MWI_vac_COI)){
  Annualized_MWI_vac_COI[1,i] <- NPV_MWI_vac_COI [1,i]/vaccine_annuity_factor
}

Annualized_MWI_vac_COI <- as.data.frame(Annualized_MWI_vac_COI)


#DRC
NPV_DRC_vac_COI <- matrix(ncol = 8, nrow = 1)

colnames(NPV_DRC_vac_COI) <- c("NPV_VacCOI_HepA&HiB", "NPV_VacCOI_HPV","NPV_VacCOI_MR","NPV_VacCOI_PCV","NPV_VacCOI_Meningitis","NPV_VacCOI_Rotavirus","NPV_VacCOI_YF","NPV_VacCOI_Overall")

NPV_DRC_vac_COI[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_DRC_vac_COI [1,1] <- NPV_DRC_vac_COI [1,1]+DRC_vac_COI$`DRC_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_COI [1,2] <- NPV_DRC_vac_COI [1,2]+DRC_vac_COI$`DRC_HPV`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_COI [1,3] <- NPV_DRC_vac_COI [1,3]+DRC_vac_COI$`DRC_MR`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_COI [1,4] <- NPV_DRC_vac_COI [1,4]+DRC_vac_COI$`DRC_PCV`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_COI [1,5] <- NPV_DRC_vac_COI [1,5]+DRC_vac_COI$`DRC_Meningitis`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_COI [1,6] <- NPV_DRC_vac_COI [1,6]+DRC_vac_COI$`DRC_Rota`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_COI [1,7] <- NPV_DRC_vac_COI [1,7]+DRC_vac_COI$`DRC_YF`[i]/((1+discount_rate)^(i))
}
NPV_DRC_vac_COI [1,8] <- NPV_DRC_vac_COI[1,1] + NPV_DRC_vac_COI[1,2] + NPV_DRC_vac_COI[1,3] + NPV_DRC_vac_COI[1,4] + NPV_DRC_vac_COI[1,5] + NPV_DRC_vac_COI[1,6] + NPV_DRC_vac_COI[1,7]

NPV_DRC_vac_COI <- as.data.frame (NPV_DRC_vac_COI)

Annualized_DRC_vac_COI <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DRC_vac_COI) <- c("Annualized_VacCOI_HepA&HiB", "Annualized_VacCOI_HPV","Annualized_VacCOI_MR","Annualized_VacCOI_PCV","Annualized_VacCOI_Meningitis","Annualized_VacCOI_Rotavirus","Annualized_VacCOI_YF","Annualized_VacCOI_Overall")
for (i in 1: ncol(Annualized_DRC_vac_COI)){
  Annualized_DRC_vac_COI[1,i] <- NPV_DRC_vac_COI [1,i]/vaccine_annuity_factor
}

Annualized_DRC_vac_COI <- as.data.frame(Annualized_DRC_vac_COI)


#Overall

NPV_vac_COI <- matrix(ncol = 8, nrow = 1)

colnames(NPV_vac_COI) <- c("NPV_VacCOI_HepA&HiB", "NPV_VacCOI_HPV","NPV_VacCOI_MR","NPV_VacCOI_PCV","NPV_VacCOI_Meningitis","NPV_VacCOI_Rotavirus","NPV_VacCOI_YF","NPV_VacCOI_Overall")

NPV_vac_COI[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_vac_COI [1,1] <- NPV_vac_COI [1,1]+Total_vac_COI$`Total_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_vac_COI [1,2] <- NPV_vac_COI [1,2]+Total_vac_COI$`Total_HPV`[i]/((1+discount_rate)^(i)) 
NPV_vac_COI [1,3] <- NPV_vac_COI [1,3]+Total_vac_COI$`Total_MR`[i]/((1+discount_rate)^(i)) 
NPV_vac_COI [1,4] <- NPV_vac_COI [1,4]+Total_vac_COI$`Total_PCV`[i]/((1+discount_rate)^(i))   
NPV_vac_COI [1,5] <- NPV_vac_COI [1,5]+Total_vac_COI$`Total_Meningitis`[i]/((1+discount_rate)^(i))
NPV_vac_COI [1,6] <- NPV_vac_COI [1,6]+Total_vac_COI$`Total_Rota`[i]/((1+discount_rate)^(i))
NPV_vac_COI [1,7] <- NPV_vac_COI [1,7]+Total_vac_COI$`Total_YF`[i]/((1+discount_rate)^(i))
}
NPV_vac_COI [1,8] <- NPV_vac_COI[1,1] + NPV_vac_COI[1,2] + NPV_vac_COI[1,3] + NPV_vac_COI[1,4] + NPV_vac_COI[1,5] + NPV_vac_COI[1,6] + NPV_vac_COI[1,7]

NPV_vac_COI <- as.data.frame (NPV_vac_COI)

Annualized_vac_COI <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_vac_COI) <- c("Annualized_VacCOI_HepA&HiB", "Annualized_VacCOI_HPV","Annualized_VacCOI_MR","Annualized_VacCOI_PCV","Annualized_VacCOI_Meningitis","Annualized_VacCOI_Rotavirus","Annualized_VacCOI_YF","Annualized_VacCOI_Overall")
for (i in 1: ncol(Annualized_vac_COI)){
  Annualized_vac_COI[1,i] <- NPV_vac_COI [1,i]/vaccine_annuity_factor
}

Annualized_vac_COI <- as.data.frame(Annualized_vac_COI)


######################## VSL Method calculations ##################################################################################

NGA_col_names <- c("NGA_HepA&HiB", "NGA_HPV", "NGA_MR", "NGA_PCV", "NGA_Meningitis", "NGA_Rotavirus", "NGA_YF")

current_variation_NGA <- NGA_death_averted
for (i in 1:vac_estimation_length){
  for (k in 1:length(NGA_col_names)){
    disease_col <- NGA_col_names[k]
    disease_index <- which(colnames(current_variation_NGA) == disease_col)
    low_bound <- current_variation_NGA[i, (disease_index+1)]
    high_bound <- current_variation_NGA[i, (disease_index+2)]
    current_variation_NGA[i, disease_index] <- runif(1, low_bound, high_bound)
  }
}

Nigeria_vac_VSL <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Nigeria_vac_VSL) <- c("NGA_HepA&HiB", "NGA_HPV","NGA_MR","NGA_PCV","NGA_Meningitis","NGA_Rotavirus","NGA_YF")

for (i in 1:vac_estimation_length){
  
  Nigeria_vac_VSL[i,1] <- current_variation_NGA$`NGA_HepA&HiB`[i]*NGA_VSL
  Nigeria_vac_VSL[i,2] <- current_variation_NGA$NGA_HPV[i]*NGA_VSL
  Nigeria_vac_VSL[i,3] <- current_variation_NGA$NGA_MR[i]*NGA_VSL
  Nigeria_vac_VSL[i,4] <- current_variation_NGA$NGA_PCV[i]*NGA_VSL
  Nigeria_vac_VSL[i,5] <- current_variation_NGA$NGA_Meningitis[i]*NGA_VSL
  Nigeria_vac_VSL[i,6] <- current_variation_NGA$NGA_Rotavirus[i]*NGA_VSL
  Nigeria_vac_VSL[i,7] <- current_variation_NGA$NGA_YF[i]*NGA_VSL
}

Nigeria_vac_VSL <- as.data.frame(Nigeria_vac_VSL)
 

MWI_col_names <- c("MWI_HepA&HiB", "MWI_HPV", "MWI_MR", "MWI_PCV", "MWI_Meningitis", "MWI_Rotavirus", "MWI_YF")

current_variation_MWI <- MWI_death_averted
for (i in 1:vac_estimation_length){
  for (k in 1:length(MWI_col_names)){
    disease_col <- MWI_col_names[k]
    disease_index <- which(colnames(current_variation_MWI) == disease_col)
    low_bound <- current_variation_MWI[i, (disease_index+1)]
    high_bound <- current_variation_MWI[i, (disease_index+2)]
    current_variation_MWI[i, disease_index] <- runif(1, low_bound, high_bound)
  }
}

Malawi_vac_VSL <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Malawi_vac_VSL) <- c("MWI_HepA&HiB", "MWI_HPV","MWI_MR","MWI_PCV","MWI_Meningitis","MWI_Rotavirus","MWI_YF")

for (i in 1:vac_estimation_length){
  
  Malawi_vac_VSL[i,1] <- current_variation_MWI$`MWI_HepA&HiB`[i]*MWI_VSL
  Malawi_vac_VSL[i,2] <- current_variation_MWI$MWI_HPV[i]*MWI_VSL
  Malawi_vac_VSL[i,3] <- current_variation_MWI$MWI_MR[i]*MWI_VSL
  Malawi_vac_VSL[i,4] <- current_variation_MWI$MWI_PCV[i]*MWI_VSL
  Malawi_vac_VSL[i,5] <- current_variation_MWI$MWI_Meningitis[i]*MWI_VSL
  Malawi_vac_VSL[i,6] <- current_variation_MWI$MWI_Rotavirus[i]*MWI_VSL
  Malawi_vac_VSL[i,7] <- current_variation_MWI$MWI_YF[i]*MWI_VSL
}

Malawi_vac_VSL <- as.data.frame(Malawi_vac_VSL)


DRC_col_names <- c("DRC_HepA&HiB", "DRC_HPV", "DRC_MR", "DRC_PCV", "DRC_Meningitis", "DRC_Rotavirus", "DRC_YF")

current_variation_DRC <- DRC_death_averted
for (i in 1:vac_estimation_length){
  for (k in 1:length(DRC_col_names)){
    disease_col <- DRC_col_names[k]
    disease_index <- which(colnames(current_variation_DRC) == disease_col)
    low_bound <- current_variation_DRC[i, (disease_index+1)]
    high_bound <- current_variation_DRC[i, (disease_index+2)]
    current_variation_DRC[i, disease_index] <- runif(1, low_bound, high_bound)
  }
}

DRC_vac_VSL <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(DRC_vac_VSL) <- c("DRC_HepA&HiB", "DRC_HPV","DRC_MR","DRC_PCV","DRC_Meningitis","DRC_Rotavirus","DRC_YF")

for (i in 1:vac_estimation_length){
  
  DRC_vac_VSL[i,1] <- current_variation_DRC$`DRC_HepA&HiB`[i]*DRC_VSL
  DRC_vac_VSL[i,2] <- current_variation_DRC$DRC_HPV[i]*DRC_VSL
  DRC_vac_VSL[i,3] <- current_variation_DRC$DRC_MR[i]*DRC_VSL
  DRC_vac_VSL[i,4] <- current_variation_DRC$DRC_PCV[i]*DRC_VSL
  DRC_vac_VSL[i,5] <- current_variation_DRC$DRC_Meningitis[i]*DRC_VSL
  DRC_vac_VSL[i,6] <- current_variation_DRC$DRC_Rotavirus[i]*DRC_VSL
  DRC_vac_VSL[i,7] <- current_variation_DRC$DRC_YF[i]*DRC_VSL
}

DRC_vac_VSL <- as.data.frame(DRC_vac_VSL)

Total_vac_VSL <- Nigeria_vac_VSL + Malawi_vac_VSL + DRC_vac_VSL
colnames(Total_vac_VSL) <- c("Total_HepA&HiB", "Total_HPV","Total_MR","Total_PCV","Total_Meningitis","Total_Rotavirus","Total_YF")

###NPV calculations
#Nigeria
NPV_NGA_vac_VSL <- matrix(ncol = 8, nrow = 1)

colnames(NPV_NGA_vac_VSL) <- c("NPV_VacVSL_HepA&HiB", "NPV_VacVSL_HPV","NPV_VacVSL_MR","NPV_VacVSL_PCV","NPV_VacVSL_Meningitis","NPV_VacVSL_Rotavirus","NPV_VacVSL_YF","NPV_VacVSL_Overall")

NPV_NGA_vac_VSL[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_NGA_vac_VSL [1,1] <- NPV_NGA_vac_VSL [1,1]+Nigeria_vac_VSL$`NGA_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_VSL [1,2] <- NPV_NGA_vac_VSL [1,2]+Nigeria_vac_VSL$`NGA_HPV`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_VSL [1,3] <- NPV_NGA_vac_VSL [1,3]+Nigeria_vac_VSL$`NGA_MR`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_VSL [1,4] <- NPV_NGA_vac_VSL [1,4]+Nigeria_vac_VSL$`NGA_PCV`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_VSL [1,5] <- NPV_NGA_vac_VSL [1,5]+Nigeria_vac_VSL$`NGA_Meningitis`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_VSL [1,6] <- NPV_NGA_vac_VSL [1,6]+Nigeria_vac_VSL$`NGA_Rota`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_VSL [1,7] <- NPV_NGA_vac_VSL [1,7]+Nigeria_vac_VSL$`NGA_YF`[i]/((1+discount_rate)^(i))
}
NPV_NGA_vac_VSL [1,8] <- NPV_NGA_vac_VSL[1,1] + NPV_NGA_vac_VSL[1,2] + NPV_NGA_vac_VSL[1,3] + NPV_NGA_vac_VSL[1,4] + NPV_NGA_vac_VSL[1,5] + NPV_NGA_vac_VSL[1,6] + NPV_NGA_vac_VSL[1,7]

NPV_NGA_vac_VSL <- as.data.frame (NPV_NGA_vac_VSL)

Annualized_NGA_vac_VSL <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_NGA_vac_VSL) <- c("Annualized_VacVSL_HepA&HiB", "Annualized_VacVSL_HPV","Annualized_VacVSL_MR","Annualized_VacVSL_PCV","Annualized_VacVSL_Meningitis","Annualized_VacVSL_Rotavirus","Annualized_VacVSL_YF","Annualized_VacVSL_Overall")
for (i in 1: ncol(Annualized_NGA_vac_VSL)){
  Annualized_NGA_vac_VSL[1,i] <- NPV_NGA_vac_VSL [1,i]/vaccine_annuity_factor
}

Annualized_NGA_vac_VSL <- as.data.frame(Annualized_NGA_vac_VSL)

#Malawi
NPV_MWI_vac_VSL <- matrix(ncol = 8, nrow = 1)

colnames(NPV_MWI_vac_VSL) <- c("NPV_VacVSL_HepA&HiB", "NPV_VacVSL_HPV","NPV_VacVSL_MR","NPV_VacVSL_PCV","NPV_VacVSL_Meningitis","NPV_VacVSL_Rotavirus","NPV_VacVSL_YF","NPV_VacVSL_Overall")

NPV_MWI_vac_VSL[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_MWI_vac_VSL [1,1] <- NPV_MWI_vac_VSL [1,1]+Malawi_vac_VSL$`MWI_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_VSL [1,2] <- NPV_MWI_vac_VSL [1,2]+Malawi_vac_VSL$`MWI_HPV`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_VSL [1,3] <- NPV_MWI_vac_VSL [1,3]+Malawi_vac_VSL$`MWI_MR`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_VSL [1,4] <- NPV_MWI_vac_VSL [1,4]+Malawi_vac_VSL$`MWI_PCV`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_VSL [1,5] <- NPV_MWI_vac_VSL [1,5]+Malawi_vac_VSL$`MWI_Meningitis`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_VSL [1,6] <- NPV_MWI_vac_VSL [1,6]+Malawi_vac_VSL$`MWI_Rota`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_VSL [1,7] <- NPV_MWI_vac_VSL [1,7]+Malawi_vac_VSL$`MWI_YF`[i]/((1+discount_rate)^(i))
}
NPV_MWI_vac_VSL [1,8] <- NPV_MWI_vac_VSL[1,1] + NPV_MWI_vac_VSL[1,2] + NPV_MWI_vac_VSL[1,3] + NPV_MWI_vac_VSL[1,4] + NPV_MWI_vac_VSL[1,5] + NPV_MWI_vac_VSL[1,6] + NPV_MWI_vac_VSL[1,7]

NPV_MWI_vac_VSL <- as.data.frame (NPV_MWI_vac_VSL)

Annualized_MWI_vac_VSL <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_MWI_vac_VSL) <- c("Annualized_VacVSL_HepA&HiB", "Annualized_VacVSL_HPV","Annualized_VacVSL_MR","Annualized_VacVSL_PCV","Annualized_VacVSL_Meningitis","Annualized_VacVSL_Rotavirus","Annualized_VacVSL_YF","Annualized_VacVSL_Overall")
for (i in 1: ncol(Annualized_MWI_vac_VSL)){
  Annualized_MWI_vac_VSL[1,i] <- NPV_MWI_vac_VSL [1,i]/vaccine_annuity_factor
}

Annualized_MWI_vac_VSL <- as.data.frame(Annualized_MWI_vac_VSL)

#DRC
NPV_DRC_vac_VSL <- matrix(ncol = 8, nrow = 1)

colnames(NPV_DRC_vac_VSL) <- c("NPV_VacVSL_HepA&HiB", "NPV_VacVSL_HPV","NPV_VacVSL_MR","NPV_VacVSL_PCV","NPV_VacVSL_Meningitis","NPV_VacVSL_Rotavirus","NPV_VacVSL_YF","NPV_VacVSL_Overall")

NPV_DRC_vac_VSL[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_DRC_vac_VSL [1,1] <- NPV_DRC_vac_VSL [1,1]+DRC_vac_VSL$`DRC_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_VSL [1,2] <- NPV_DRC_vac_VSL [1,2]+DRC_vac_VSL$`DRC_HPV`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_VSL [1,3] <- NPV_DRC_vac_VSL [1,3]+DRC_vac_VSL$`DRC_MR`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_VSL [1,4] <- NPV_DRC_vac_VSL [1,4]+DRC_vac_VSL$`DRC_PCV`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_VSL [1,5] <- NPV_DRC_vac_VSL [1,5]+DRC_vac_VSL$`DRC_Meningitis`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_VSL [1,6] <- NPV_DRC_vac_VSL [1,6]+DRC_vac_VSL$`DRC_Rota`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_VSL [1,7] <- NPV_DRC_vac_VSL [1,7]+DRC_vac_VSL$`DRC_YF`[i]/((1+discount_rate)^(i))
}
NPV_DRC_vac_VSL [1,8] <- NPV_DRC_vac_VSL[1,1] + NPV_DRC_vac_VSL[1,2] + NPV_DRC_vac_VSL[1,3] + NPV_DRC_vac_VSL[1,4] + NPV_DRC_vac_VSL[1,5] + NPV_DRC_vac_VSL[1,6] + NPV_DRC_vac_VSL[1,7]

NPV_DRC_vac_VSL <- as.data.frame (NPV_DRC_vac_VSL)

Annualized_DRC_vac_VSL <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DRC_vac_VSL) <- c("Annualized_VacVSL_HepA&HiB", "Annualized_VacVSL_HPV","Annualized_VacVSL_MR","Annualized_VacVSL_PCV","Annualized_VacVSL_Meningitis","Annualized_VacVSL_Rotavirus","Annualized_VacVSL_YF","Annualized_VacVSL_Overall")
for (i in 1: ncol(Annualized_DRC_vac_VSL)){
  Annualized_DRC_vac_VSL[1,i] <- NPV_DRC_vac_VSL [1,i]/vaccine_annuity_factor
}

Annualized_DRC_vac_VSL <- as.data.frame(Annualized_DRC_vac_VSL)

#Overall
NPV_vac_VSL <- matrix(ncol = 8, nrow = 1)

colnames(NPV_vac_VSL) <- c("NPV_VacVSL_HepA&HiB", "NPV_VacVSL_HPV","NPV_VacVSL_MR","NPV_VacVSL_PCV","NPV_VacVSL_Meningitis","NPV_VacVSL_Rotavirus","NPV_VacVSL_YF","NPV_VacVSL_Overall")

NPV_vac_VSL[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_vac_VSL [1,1] <- NPV_vac_VSL [1,1]+Total_vac_VSL$`Total_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_vac_VSL [1,2] <- NPV_vac_VSL [1,2]+Total_vac_VSL$`Total_HPV`[i]/((1+discount_rate)^(i)) 
NPV_vac_VSL [1,3] <- NPV_vac_VSL [1,3]+Total_vac_VSL$`Total_MR`[i]/((1+discount_rate)^(i)) 
NPV_vac_VSL [1,4] <- NPV_vac_VSL [1,4]+Total_vac_VSL$`Total_PCV`[i]/((1+discount_rate)^(i))   
NPV_vac_VSL [1,5] <- NPV_vac_VSL [1,5]+Total_vac_VSL$`Total_Meningitis`[i]/((1+discount_rate)^(i))
NPV_vac_VSL [1,6] <- NPV_vac_VSL [1,6]+Total_vac_VSL$`Total_Rota`[i]/((1+discount_rate)^(i))
NPV_vac_VSL [1,7] <- NPV_vac_VSL [1,7]+Total_vac_VSL$`Total_YF`[i]/((1+discount_rate)^(i))
}
NPV_vac_VSL [1,8] <- NPV_vac_VSL[1,1] + NPV_vac_VSL[1,2] + NPV_vac_VSL[1,3] + NPV_vac_VSL[1,4] + NPV_vac_VSL[1,5] + NPV_vac_VSL[1,6] + NPV_vac_VSL[1,7]

NPV_vac_VSL <- as.data.frame (NPV_vac_VSL)

Annualized_vac_VSL <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_vac_VSL) <- c("Annualized_VacVSL_HepA&HiB", "Annualized_VacVSL_HPV","Annualized_VacVSL_MR","Annualized_VacVSL_PCV","Annualized_VacVSL_Meningitis","Annualized_VacVSL_Rotavirus","Annualized_VacVSL_YF","Annualized_VacVSL_Overall")
for (i in 1: ncol(Annualized_vac_VSL)){
  Annualized_vac_VSL[1,i] <- NPV_vac_VSL [1,i]/vaccine_annuity_factor
}

Annualized_vac_VSL <- as.data.frame(Annualized_vac_VSL)

######################## VSLY Method calculations #################################################################################

NGA_col_names <- c("NGA_HepA&HiB", "NGA_HPV", "NGA_MR", "NGA_PCV", "NGA_Meningitis", "NGA_Rotavirus", "NGA_YF")

current_DALY_var_NGA <- NGA_DALY_averted
for (i in 1:vac_estimation_length){
  for (k in 1:length(NGA_col_names)){
    disease_col <- NGA_col_names[k]
    disease_index <- which(colnames(current_DALY_var_NGA) == disease_col)
    low_bound <- current_DALY_var_NGA[i, (disease_index+1)]
    high_bound <- current_DALY_var_NGA[i, (disease_index+2)]
    current_DALY_var_NGA[i, disease_index] <- runif(1, low_bound, high_bound)
  }
}

Nigeria_vac_VSLY <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Nigeria_vac_VSLY) <- c("NGA_HepA&HiB", "NGA_HPV","NGA_MR","NGA_PCV","NGA_Meningitis","NGA_Rotavirus","NGA_YF")

for (i in 1:vac_estimation_length){
  
  Nigeria_vac_VSLY[i,1] <- current_DALY_var_NGA$`NGA_HepA&HiB`[i]*VSLY_data[1,1]
  Nigeria_vac_VSLY[i,2] <- current_DALY_var_NGA$NGA_HPV[i]*VSLY_data[1,2]
  Nigeria_vac_VSLY[i,3] <- current_DALY_var_NGA$NGA_MR[i]*VSLY_data[1,3]
  Nigeria_vac_VSLY[i,4] <- current_DALY_var_NGA$NGA_PCV[i]*VSLY_data[1,4]
  Nigeria_vac_VSLY[i,5] <- current_DALY_var_NGA$NGA_Meningitis[i]*VSLY_data[1,5]
  Nigeria_vac_VSLY[i,6] <- current_DALY_var_NGA$NGA_Rotavirus[i]*VSLY_data[1,6]
  Nigeria_vac_VSLY[i,7] <- current_DALY_var_NGA$NGA_YF[i]*VSLY_data[1,7]
}

Nigeria_vac_VSLY <- as.data.frame(Nigeria_vac_VSLY)


MWI_col_names <- c("MWI_HepA&HiB", "MWI_HPV", "MWI_MR", "MWI_PCV", "MWI_Meningitis", "MWI_Rotavirus", "MWI_YF")

current_DALY_var_MWI <- MWI_DALY_averted
for (i in 1:vac_estimation_length){
  for (k in 1:length(MWI_col_names)){
    disease_col <- MWI_col_names[k]
    disease_index <- which(colnames(current_DALY_var_MWI) == disease_col)
    low_bound <- current_DALY_var_MWI[i, (disease_index+1)]
    high_bound <- current_DALY_var_MWI[i, (disease_index+2)]
    current_DALY_var_MWI[i, disease_index] <- runif(1, low_bound, high_bound)
  }
}

Malawi_vac_VSLY <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(Malawi_vac_VSLY) <- c("MWI_HepA&HiB", "MWI_HPV","MWI_MR","MWI_PCV","MWI_Meningitis","MWI_Rotavirus","MWI_YF")

for (i in 1:vac_estimation_length){
  
  Malawi_vac_VSLY[i,1] <- current_DALY_var_MWI$`MWI_HepA&HiB`[i]*VSLY_data[2,1]
  Malawi_vac_VSLY[i,2] <- current_DALY_var_MWI$MWI_HPV[i]*VSLY_data[2,2]
  Malawi_vac_VSLY[i,3] <- current_DALY_var_MWI$MWI_MR[i]*VSLY_data[2,3]
  Malawi_vac_VSLY[i,4] <- current_DALY_var_MWI$MWI_PCV[i]*VSLY_data[2,4]
  Malawi_vac_VSLY[i,5] <- current_DALY_var_MWI$MWI_Meningitis[i]*VSLY_data[2,5]
  Malawi_vac_VSLY[i,6] <- current_DALY_var_MWI$MWI_Rotavirus[i]*VSLY_data[2,6]
  Malawi_vac_VSLY[i,7] <- current_DALY_var_MWI$MWI_YF[i]*VSLY_data[2,7]
}

Malawi_vac_VSLY <- as.data.frame(Malawi_vac_VSLY)

current_DALY_var_DRC <- DRC_DALY_averted
for (i in 1:vac_estimation_length){
  for (k in 1:length(DRC_col_names)){
    disease_col <- DRC_col_names[k]
    disease_index <- which(colnames(current_DALY_var_DRC) == disease_col)
    low_bound <- current_DALY_var_DRC[i, (disease_index+1)]
    high_bound <- current_DALY_var_DRC[i, (disease_index+2)]
    current_DALY_var_DRC[i, disease_index] <- runif(1, low_bound, high_bound)
  }
}

DRC_vac_VSLY <- matrix(ncol = 7, nrow = vac_estimation_length)
colnames(DRC_vac_VSLY) <- c("DRC_HepA&HiB", "DRC_HPV","DRC_MR","DRC_PCV","DRC_Meningitis","DRC_Rotavirus","DRC_YF")

for (i in 1:vac_estimation_length){
  
  DRC_vac_VSLY[i,1] <- current_DALY_var_DRC$`DRC_HepA&HiB`[i]*VSLY_data[3,1]
  DRC_vac_VSLY[i,2] <- current_DALY_var_DRC$DRC_HPV[i]*VSLY_data[3,2]
  DRC_vac_VSLY[i,3] <- current_DALY_var_DRC$DRC_MR[i]*VSLY_data[3,3]
  DRC_vac_VSLY[i,4] <- current_DALY_var_DRC$DRC_PCV[i]*VSLY_data[3,4]
  DRC_vac_VSLY[i,5] <- current_DALY_var_DRC$DRC_Meningitis[i]*VSLY_data[3,5]
  DRC_vac_VSLY[i,6] <- current_DALY_var_DRC$DRC_Rotavirus[i]*VSLY_data[3,6]
  DRC_vac_VSLY[i,7] <- current_DALY_var_DRC$DRC_YF[i]*VSLY_data[3,7]
}

DRC_vac_VSLY <- as.data.frame(DRC_vac_VSLY)


Total_vac_VSLY <- Nigeria_vac_VSLY + Malawi_vac_VSLY + DRC_vac_VSLY
colnames(Total_vac_VSLY) <- c("Total_HepA&HiB", "Total_HPV","Total_MR","Total_PCV","Total_Meningitis","Total_Rotavirus","Total_YF")


###NPV calculations
#Nigeria
NPV_NGA_vac_VSLY <- matrix(ncol = 8, nrow = 1)

colnames(NPV_NGA_vac_VSLY) <- c("NPV_VacVSLY_HepA&HiB", "NPV_VacVSLY_HPV","NPV_VacVSLY_MR","NPV_VacVSLY_PCV","NPV_VacVSLY_Meningitis","NPV_VacVSLY_Rotavirus","NPV_VacVSLY_YF","NPV_VacVSLY_Overall")

NPV_NGA_vac_VSLY[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_NGA_vac_VSLY [1,1] <- NPV_NGA_vac_VSLY [1,1]+Nigeria_vac_VSLY$`NGA_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_VSLY [1,2] <- NPV_NGA_vac_VSLY [1,2]+Nigeria_vac_VSLY$`NGA_HPV`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_VSLY [1,3] <- NPV_NGA_vac_VSLY [1,3]+Nigeria_vac_VSLY$`NGA_MR`[i]/((1+discount_rate)^(i)) 
NPV_NGA_vac_VSLY [1,4] <- NPV_NGA_vac_VSLY [1,4]+Nigeria_vac_VSLY$`NGA_PCV`[i]/((1+discount_rate)^(i))   
NPV_NGA_vac_VSLY [1,5] <- NPV_NGA_vac_VSLY [1,5]+Nigeria_vac_VSLY$`NGA_Meningitis`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_VSLY [1,6] <- NPV_NGA_vac_VSLY [1,6]+Nigeria_vac_VSLY$`NGA_Rota`[i]/((1+discount_rate)^(i))
NPV_NGA_vac_VSLY [1,7] <- NPV_NGA_vac_VSLY [1,7]+Nigeria_vac_VSLY$`NGA_YF`[i]/((1+discount_rate)^(i))
}
NPV_NGA_vac_VSLY [1,8] <- NPV_NGA_vac_VSLY[1,1] + NPV_NGA_vac_VSLY[1,2] + NPV_NGA_vac_VSLY[1,3] + NPV_NGA_vac_VSLY[1,4] + NPV_NGA_vac_VSLY[1,5] + NPV_NGA_vac_VSLY[1,6] + NPV_NGA_vac_VSLY[1,7]

NPV_NGA_vac_VSLY <- as.data.frame (NPV_NGA_vac_VSLY)

Annualized_NGA_vac_VSLY <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_NGA_vac_VSLY) <- c("Annualized_VacVSLY_HepA&HiB", "Annualized_VacVSLY_HPV","Annualized_VacVSLY_MR","Annualized_VacVSLY_PCV","Annualized_VacVSLY_Meningitis","Annualized_VacVSLY_Rotavirus","Annualized_VacVSLY_YF","Annualized_VacVSLY_Overall")
for (i in 1: ncol(Annualized_NGA_vac_VSLY)){
  Annualized_NGA_vac_VSLY[1,i] <- NPV_NGA_vac_VSLY [1,i]/vaccine_annuity_factor
}

Annualized_NGA_vac_VSLY <- as.data.frame(Annualized_NGA_vac_VSLY)

#Malawi
NPV_MWI_vac_VSLY <- matrix(ncol = 8, nrow = 1)

colnames(NPV_MWI_vac_VSLY) <- c("NPV_VacVSLY_HepA&HiB", "NPV_VacVSLY_HPV","NPV_VacVSLY_MR","NPV_VacVSLY_PCV","NPV_VacVSLY_Meningitis","NPV_VacVSLY_Rotavirus","NPV_VacVSLY_YF","NPV_VacVSLY_Overall")

NPV_MWI_vac_VSLY[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_MWI_vac_VSLY [1,1] <- NPV_MWI_vac_VSLY [1,1]+Malawi_vac_VSLY$`MWI_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_VSLY [1,2] <- NPV_MWI_vac_VSLY [1,2]+Malawi_vac_VSLY$`MWI_HPV`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_VSLY [1,3] <- NPV_MWI_vac_VSLY [1,3]+Malawi_vac_VSLY$`MWI_MR`[i]/((1+discount_rate)^(i)) 
NPV_MWI_vac_VSLY [1,4] <- NPV_MWI_vac_VSLY [1,4]+Malawi_vac_VSLY$`MWI_PCV`[i]/((1+discount_rate)^(i))   
NPV_MWI_vac_VSLY [1,5] <- NPV_MWI_vac_VSLY [1,5]+Malawi_vac_VSLY$`MWI_Meningitis`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_VSLY [1,6] <- NPV_MWI_vac_VSLY [1,6]+Malawi_vac_VSLY$`MWI_Rota`[i]/((1+discount_rate)^(i))
NPV_MWI_vac_VSLY [1,7] <- NPV_MWI_vac_VSLY [1,7]+Malawi_vac_VSLY$`MWI_YF`[i]/((1+discount_rate)^(i))
}
NPV_MWI_vac_VSLY [1,8] <- NPV_MWI_vac_VSLY[1,1] + NPV_MWI_vac_VSLY[1,2] + NPV_MWI_vac_VSLY[1,3] + NPV_MWI_vac_VSLY[1,4] + NPV_MWI_vac_VSLY[1,5] + NPV_MWI_vac_VSLY[1,6] + NPV_MWI_vac_VSLY[1,7]

NPV_MWI_vac_VSLY <- as.data.frame (NPV_MWI_vac_VSLY)

Annualized_MWI_vac_VSLY <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_MWI_vac_VSLY) <- c("Annualized_VacVSLY_HepA&HiB", "Annualized_VacVSLY_HPV","Annualized_VacVSLY_MR","Annualized_VacVSLY_PCV","Annualized_VacVSLY_Meningitis","Annualized_VacVSLY_Rotavirus","Annualized_VacVSLY_YF","Annualized_VacVSLY_Overall")
for (i in 1: ncol(Annualized_MWI_vac_VSLY)){
  Annualized_MWI_vac_VSLY[1,i] <- NPV_MWI_vac_VSLY [1,i]/vaccine_annuity_factor
}

Annualized_MWI_vac_VSLY <- as.data.frame(Annualized_MWI_vac_VSLY)

#DRC
NPV_DRC_vac_VSLY <- matrix(ncol = 8, nrow = 1)

colnames(NPV_DRC_vac_VSLY) <- c("NPV_VacVSLY_HepA&HiB", "NPV_VacVSLY_HPV","NPV_VacVSLY_MR","NPV_VacVSLY_PCV","NPV_VacVSLY_Meningitis","NPV_VacVSLY_Rotavirus","NPV_VacVSLY_YF","NPV_VacVSLY_Overall")

NPV_DRC_vac_VSLY[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_DRC_vac_VSLY [1,1] <- NPV_DRC_vac_VSLY [1,1]+DRC_vac_VSLY$`DRC_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_VSLY [1,2] <- NPV_DRC_vac_VSLY [1,2]+DRC_vac_VSLY$`DRC_HPV`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_VSLY [1,3] <- NPV_DRC_vac_VSLY [1,3]+DRC_vac_VSLY$`DRC_MR`[i]/((1+discount_rate)^(i)) 
NPV_DRC_vac_VSLY [1,4] <- NPV_DRC_vac_VSLY [1,4]+DRC_vac_VSLY$`DRC_PCV`[i]/((1+discount_rate)^(i))   
NPV_DRC_vac_VSLY [1,5] <- NPV_DRC_vac_VSLY [1,5]+DRC_vac_VSLY$`DRC_Meningitis`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_VSLY [1,6] <- NPV_DRC_vac_VSLY [1,6]+DRC_vac_VSLY$`DRC_Rota`[i]/((1+discount_rate)^(i))
NPV_DRC_vac_VSLY [1,7] <- NPV_DRC_vac_VSLY [1,7]+DRC_vac_VSLY$`DRC_YF`[i]/((1+discount_rate)^(i))
}
NPV_DRC_vac_VSLY [1,8] <- NPV_DRC_vac_VSLY[1,1] + NPV_DRC_vac_VSLY[1,2] + NPV_DRC_vac_VSLY[1,3] + NPV_DRC_vac_VSLY[1,4] + NPV_DRC_vac_VSLY[1,5] + NPV_DRC_vac_VSLY[1,6] + NPV_DRC_vac_VSLY[1,7]

NPV_DRC_vac_VSLY <- as.data.frame (NPV_DRC_vac_VSLY)

Annualized_DRC_vac_VSLY <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_DRC_vac_VSLY) <- c("Annualized_VacVSLY_HepA&HiB", "Annualized_VacVSLY_HPV","Annualized_VacVSLY_MR","Annualized_VacVSLY_PCV","Annualized_VacVSLY_Meningitis","Annualized_VacVSLY_Rotavirus","Annualized_VacVSLY_YF","Annualized_VacVSLY_Overall")
for (i in 1: ncol(Annualized_DRC_vac_VSLY)){
  Annualized_DRC_vac_VSLY[1,i] <- NPV_DRC_vac_VSLY [1,i]/vaccine_annuity_factor
}

Annualized_DRC_vac_VSLY <- as.data.frame(Annualized_DRC_vac_VSLY)

#Overall
NPV_vac_VSLY <- matrix(ncol = 8, nrow = 1)

colnames(NPV_vac_VSLY) <- c("NPV_VacVSLY_HepA&HiB", "NPV_VacVSLY_HPV","NPV_VacVSLY_MR","NPV_VacVSLY_PCV","NPV_VacVSLY_Meningitis","NPV_VacVSLY_Rotavirus","NPV_VacVSLY_YF","NPV_VacVSLY_Overall")

NPV_vac_VSLY[1,] <- 0

for (i in 1:vac_estimation_length){
NPV_vac_VSLY [1,1] <- NPV_vac_VSLY [1,1]+Total_vac_VSLY$`Total_HepA&HiB`[i]/((1+discount_rate)^(i))   
NPV_vac_VSLY [1,2] <- NPV_vac_VSLY [1,2]+Total_vac_VSLY$`Total_HPV`[i]/((1+discount_rate)^(i)) 
NPV_vac_VSLY [1,3] <- NPV_vac_VSLY [1,3]+Total_vac_VSLY$`Total_MR`[i]/((1+discount_rate)^(i)) 
NPV_vac_VSLY [1,4] <- NPV_vac_VSLY [1,4]+Total_vac_VSLY$`Total_PCV`[i]/((1+discount_rate)^(i))   
NPV_vac_VSLY [1,5] <- NPV_vac_VSLY [1,5]+Total_vac_VSLY$`Total_Meningitis`[i]/((1+discount_rate)^(i))
NPV_vac_VSLY [1,6] <- NPV_vac_VSLY [1,6]+Total_vac_VSLY$`Total_Rota`[i]/((1+discount_rate)^(i))
NPV_vac_VSLY [1,7] <- NPV_vac_VSLY [1,7]+Total_vac_VSLY$`Total_YF`[i]/((1+discount_rate)^(i))
}
NPV_vac_VSLY [1,8] <- NPV_vac_VSLY[1,1] + NPV_vac_VSLY[1,2] + NPV_vac_VSLY[1,3] + NPV_vac_VSLY[1,4] + NPV_vac_VSLY[1,5] + NPV_vac_VSLY[1,6] + NPV_vac_VSLY[1,7]

NPV_vac_VSLY <- as.data.frame (NPV_vac_VSLY)

Annualized_vac_VSLY <- matrix(ncol = 8, nrow = 1)
colnames(Annualized_vac_VSLY) <- c("Annualized_VacVSLY_HepA&HiB", "Annualized_VacVSLY_HPV","Annualized_VacVSLY_MR","Annualized_VacVSLY_PCV","Annualized_VacVSLY_Meningitis","Annualized_VacVSLY_Rotavirus","Annualized_VacVSLY_YF","Annualized_VacVSLY_Overall")
for (i in 1: ncol(Annualized_vac_VSLY)){
  Annualized_vac_VSLY[1,i] <- NPV_vac_VSLY [1,i]/vaccine_annuity_factor
}

Annualized_vac_VSLY <- as.data.frame(Annualized_vac_VSLY)


###################### Output Distributions ####################################################################################

##Nigeria
#Diesel Generator
DG_NGA_capex_result <- Annualized_DG_capex_NGA
DG_NGA_opex_result <- Annualized_DG_opex_NGA
DG_NGA_direct_cost_result <- Annualized_DG_direct_cost_NGA
DG_NGA_emission_cost_result <- Annualized_DG_emission_cost_NGA
DG_NGA_fridge_cost_result <- Annualized_cost_new_fridge_NGA

#VCRC
VCRC_NGA_capex_result <- Annualized_VCRC_capex_cost_NGA
VCRC_NGA_opex_result <- Annualized_VCRC_opex_cost_NGA
VCRC_NGA_totalVCRCcost_result <- Annualized_VCRC_total_cost_NGA
VCRC_NGA_DG_opex_result <- Annualized_NGA_VCRC_revised_DG_opex
VCRC_NGA_DG_emission_result <- annualized_rev_emission_cost_NGA
VCRC_NGA_batterycost_result <- annualized_VCRC_batterycost_NGA
VCRC_NGA_totalcost_result <- VCRC_NGA_totalVCRCcost_result + VCRC_NGA_DG_opex_result + VCRC_NGA_DG_emission_result + VCRC_NGA_batterycost_result
VCRC_NGA_gridpower_benefit <- annualized_VCRC_gridpower_benefit_NGA

#PVSYS
#PVSYS_NGA_capex_result <- Annualized_PVSYS_capex_cost_NGA
#PVSYS_NGA_opex_result <- Annualized_PVSYS_opex_cost_NGA
PVSYS_NGA_totalcost_result <- Annualized_PVSYS_total_cost_NGA
PVSYS_NGA_eleccost_averted_result <- Annualized_PVSYS_eleccostaverted_NGA
PVSYS_NGA_elec_env_averted_result <- Annualized_PVSYS_elec_envcostaverted_NGA
PVSYS_NGA_fridge_cost_result <- Annualized_cost_new_fridge_NGA

#Vaccine
vac_DG_NGA_cost_result <- Annualized_NGA_DG_vac_cost$Annualized_VacCost_Overall
vac_DG_NGA_delivery_cost_result <- Annualized_NGA_DG_vac_del_cost$Annualized_VacdelCost_Overall
vac_DG_NGA_total_cost_result <- Annualized_NGA_DG_vac_total_cost$Annualized_VacTotCost_Overall
vac_DG_NGA_COI_result <- Annualized_NGA_vac_COI$Annualized_VacCOI_Overall
vac_DG_NGA_VSL_result <- Annualized_NGA_vac_VSL$Annualized_VacVSL_Overall
vac_DG_NGA_VSLY_result <- Annualized_NGA_vac_VSLY$Annualized_VacVSLY_Overall

vac_NGA_cost_result <- Annualized_NGA_vac_cost$Annualized_VacCost_Overall
vac_NGA_delivery_cost_result <- Annualized_NGA_vac_del_cost$Annualized_VacdelCost_Overall
vac_NGA_total_cost_result <- Annualized_NGA_vac_total_cost$Annualized_VacTotCost_Overall
vac_NGA_COI_result <- Annualized_NGA_vac_COI$Annualized_VacCOI_Overall
vac_NGA_VSL_result <- Annualized_NGA_vac_VSL$Annualized_VacVSL_Overall
vac_NGA_VSLY_result <- Annualized_NGA_vac_VSLY$Annualized_VacVSLY_Overall

#MC array data store
#Diesel Generator
total_DG_NGA_capex_results[j] <- DG_NGA_capex_result
total_DG_NGA_opex_results[j] <- DG_NGA_opex_result
total_DG_NGA_totalcost_results[j] <- DG_NGA_direct_cost_result
total_DG_NGA_envcost_results[j] <- DG_NGA_emission_cost_result
total_DG_NGA_fridgecost_results[j] <- DG_NGA_fridge_cost_result

#VCRC
total_VCRC_NGA_capex_results[j] <- VCRC_NGA_capex_result
total_VCRC_NGA_opex_results[j] <- VCRC_NGA_opex_result
total_VCRC_NGA_totalVCRCcost_results[j] <- VCRC_NGA_totalVCRCcost_result
total_DG_VCRC_NGA_opex_results[j] <- VCRC_NGA_DG_opex_result
total_VCRC_NGA_envcost_results[j] <- VCRC_NGA_DG_emission_result
total_VCRC_NGA_batterycost_results[j] <- VCRC_NGA_batterycost_result
total_VCRC_NGA_totalcost_results[j] <- total_VCRC_NGA_totalVCRCcost_results[j] + total_DG_VCRC_NGA_opex_results[j] + total_VCRC_NGA_batterycost_results[j] + total_VCRC_NGA_envcost_results[j]
total_VCRC_NGA_gridpower_benefit[j] <- VCRC_NGA_gridpower_benefit

#PVSYS
#total_PVSYS_NGA_capex_results[j] <- PVSYS_NGA_capex_result
#total_PVSYS_NGA_opex_results[j] <- PVSYS_NGA_opex_result
total_PVSYS_NGA_totalcost_results[j] <- PVSYS_NGA_totalcost_result
total_PVSYS_NGA_eleccostaverted_results[j] <- PVSYS_NGA_eleccost_averted_result
total_PVSYS_NGA_envbenefit_results[j] <- PVSYS_NGA_elec_env_averted_result
total_PVSYS_NGA_fridgecost_results[j] <- PVSYS_NGA_fridge_cost_result

#Vaccine
vac_DG_NGA_cost_results[j] <- vac_DG_NGA_cost_result
vac_DG_NGA_delivery_cost_results[j] <- vac_DG_NGA_delivery_cost_result
vac_DG_NGA_total_cost_results[j] <- vac_DG_NGA_total_cost_result

vac_NGA_cost_results[j] <- vac_NGA_cost_result
vac_NGA_delivery_cost_results[j] <- vac_NGA_delivery_cost_result
vac_NGA_total_cost_results[j] <- vac_NGA_total_cost_result

#Benefits
vac_DG_NGA_COI_results[j] <- vac_DG_NGA_COI_result
vac_DG_NGA_VSL_results[j] <- vac_DG_NGA_VSL_result
vac_DG_NGA_VSLY_results[j] <- vac_DG_NGA_VSLY_result

vac_NGA_COI_results[j] <- vac_NGA_COI_result
vac_NGA_VSL_results[j] <- vac_NGA_VSL_result
vac_NGA_VSLY_results[j] <- vac_NGA_VSLY_result

#Net Benefits
vac_DG_NGA_NB_COI_results[j] <- vac_DG_NGA_COI_results[j] - vac_DG_NGA_total_cost_results[j] - total_DG_NGA_totalcost_results[j] - total_DG_NGA_envcost_results[j] - total_DG_NGA_fridgecost_results[j]

vac_DG_NGA_NB_VSL_results[j] <- vac_DG_NGA_VSL_results[j] - vac_DG_NGA_total_cost_results[j] - total_DG_NGA_totalcost_results[j] - total_DG_NGA_envcost_results[j] - total_DG_NGA_fridgecost_results[j]

vac_DG_NGA_NB_VSLY_results[j] <- vac_DG_NGA_VSLY_results[j] - vac_DG_NGA_total_cost_results[j] - total_DG_NGA_totalcost_results[j] - total_DG_NGA_envcost_results[j] - total_DG_NGA_fridgecost_results[j]



VCRC_NGA_NB_COI_results[j] <- vac_NGA_COI_results[j] + total_VCRC_NGA_gridpower_benefit[j]  - vac_NGA_total_cost_results[j] - total_VCRC_NGA_totalcost_results[j]

VCRC_NGA_NB_VSL_results[j] <- vac_NGA_VSL_results[j] + total_VCRC_NGA_gridpower_benefit[j] - vac_NGA_total_cost_results[j] - total_VCRC_NGA_totalcost_results[j]

VCRC_NGA_NB_VSLY_results[j] <- vac_NGA_VSLY_results[j] + total_VCRC_NGA_gridpower_benefit[j] - vac_NGA_total_cost_results[j] - total_VCRC_NGA_totalcost_results[j]



PVSYS_NGA_NB_COI_results[j] <- vac_NGA_COI_result - vac_NGA_total_cost_result - total_PVSYS_NGA_totalcost_results[j] + total_PVSYS_NGA_eleccostaverted_results[j] + total_PVSYS_NGA_envbenefit_results[j] - total_PVSYS_NGA_fridgecost_results[j]

PVSYS_NGA_NB_VSL_results[j] <- vac_NGA_VSL_result - vac_NGA_total_cost_result - total_PVSYS_NGA_totalcost_results[j] + total_PVSYS_NGA_eleccostaverted_results[j] + total_PVSYS_NGA_envbenefit_results[j] - total_PVSYS_NGA_fridgecost_results[j]

PVSYS_NGA_NB_VSLY_results[j] <- vac_NGA_VSLY_result - vac_NGA_total_cost_result - total_PVSYS_NGA_totalcost_results[j] + total_PVSYS_NGA_eleccostaverted_results[j] + total_PVSYS_NGA_envbenefit_results[j] - total_PVSYS_NGA_fridgecost_results[j]

##Malawi
#Diesel Generator
DG_MWI_capex_result <- Annualized_DG_capex_MWI
DG_MWI_opex_result <- Annualized_DG_opex_MWI
DG_MWI_direct_cost_result <- Annualized_DG_direct_cost_MWI
DG_MWI_emission_cost_result <- Annualized_DG_emission_cost_MWI
DG_MWI_fridge_cost_result <- Annualized_cost_new_fridge_MWI

#VCRC
VCRC_MWI_capex_result <- Annualized_VCRC_capex_cost_MWI
VCRC_MWI_opex_result <- Annualized_VCRC_opex_cost_MWI
VCRC_MWI_DG_opex_result <- Annualized_MWI_VCRC_revised_DG_opex 
VCRC_MWI_totalVCRCcost_result <- Annualized_VCRC_total_cost_MWI
VCRC_MWI_DG_emission_result <- annualized_rev_emission_cost_MWI
VCRC_MWI_batterycost_result <- annualized_VCRC_batterycost_MWI
VCRC_MWI_totalcost_result <- VCRC_MWI_totalVCRCcost_result + VCRC_MWI_DG_opex_result + VCRC_MWI_batterycost_result
VCRC_MWI_gridpower_benefit <- annualized_VCRC_gridpower_benefit_MWI
 
#PVSYS
#PVSYS_MWI_capex_result <- Annualized_PVSYS_capex_cost_MWI
#PVSYS_MWI_opex_result <- Annualized_PVSYS_opex_cost_MWI
PVSYS_MWI_totalcost_result <- Annualized_PVSYS_total_cost_MWI
PVSYS_MWI_eleccost_averted_result <- Annualized_PVSYS_eleccostaverted_MWI
PVSYS_MWI_elec_env_averted_result <- Annualized_PVSYS_elec_envcostaverted_MWI
PVSYS_MWI_fridge_cost_result <- Annualized_cost_new_fridge_MWI

#Vaccine
vac_DG_MWI_cost_result <- Annualized_MWI_DG_vac_cost$Annualized_VacCost_Overall
vac_DG_MWI_delivery_cost_result <- Annualized_MWI_DG_vac_del_cost$Annualized_VacdelCost_Overall
vac_DG_MWI_total_cost_result <- Annualized_MWI_DG_vac_total_cost$Annualized_VacTotCost_Overall
vac_DG_MWI_COI_result <- Annualized_MWI_vac_COI$Annualized_VacCOI_Overall
vac_DG_MWI_VSL_result <- Annualized_MWI_vac_VSL$Annualized_VacVSL_Overall
vac_DG_MWI_VSLY_result <- Annualized_MWI_vac_VSLY$Annualized_VacVSLY_Overall

vac_MWI_cost_result <- Annualized_MWI_vac_cost$Annualized_VacCost_Overall
vac_MWI_delivery_cost_result <- Annualized_MWI_vac_del_cost$Annualized_VacdelCost_Overall
vac_MWI_total_cost_result <- Annualized_MWI_vac_total_cost$Annualized_VacTotCost_Overall
vac_MWI_COI_result <- Annualized_MWI_vac_COI$Annualized_VacCOI_Overall
vac_MWI_VSL_result <- Annualized_MWI_vac_VSL$Annualized_VacVSL_Overall
vac_MWI_VSLY_result <- Annualized_MWI_vac_VSLY$Annualized_VacVSLY_Overall

#MC array data store
#Diesel Generators
total_DG_MWI_capex_results[j] <- DG_MWI_capex_result
total_DG_MWI_opex_results[j] <- DG_MWI_opex_result
total_DG_MWI_totalcost_results[j] <- DG_MWI_direct_cost_result
total_DG_MWI_envcost_results[j] <- DG_MWI_emission_cost_result
total_DG_MWI_fridgecost_results[j] <- DG_MWI_fridge_cost_result

#VCRC
total_VCRC_MWI_capex_results[j] <- VCRC_MWI_capex_result
total_VCRC_MWI_opex_results[j] <- VCRC_MWI_opex_result
total_VCRC_MWI_totalVCRCcost_results[j] <- VCRC_MWI_totalVCRCcost_result
total_DG_VCRC_MWI_opex_results[j] <- VCRC_MWI_DG_opex_result
total_VCRC_MWI_envcost_results[j] <- VCRC_MWI_DG_emission_result
total_VCRC_MWI_batterycost_results[j] <- VCRC_MWI_batterycost_result
total_VCRC_MWI_totalcost_results[j] <- total_VCRC_MWI_totalVCRCcost_results[j] + total_DG_VCRC_MWI_opex_results[j] + total_VCRC_MWI_batterycost_results[j] + total_VCRC_MWI_envcost_results[j]
total_VCRC_MWI_gridpower_benefit[j] <- VCRC_MWI_gridpower_benefit

#PVSYS
#total_PVSYS_MWI_capex_results[j] <- PVSYS_MWI_capex_result
#total_PVSYS_MWI_opex_results[j] <- PVSYS_MWI_opex_result
total_PVSYS_MWI_totalcost_results[j] <- PVSYS_MWI_totalcost_result
total_PVSYS_MWI_eleccostaverted_results[j] <- PVSYS_MWI_eleccost_averted_result
total_PVSYS_MWI_envbenefit_results[j] <- PVSYS_MWI_elec_env_averted_result
total_PVSYS_MWI_fridgecost_results[j] <- PVSYS_MWI_fridge_cost_result

#Vaccine
vac_DG_MWI_cost_results[j] <- vac_DG_MWI_cost_result
vac_DG_MWI_delivery_cost_results[j] <- vac_DG_MWI_delivery_cost_result
vac_DG_MWI_total_cost_results[j] <- vac_DG_MWI_total_cost_result

vac_MWI_cost_results[j] <- vac_MWI_cost_result
vac_MWI_delivery_cost_results[j] <- vac_MWI_delivery_cost_result
vac_MWI_total_cost_results[j] <- vac_MWI_total_cost_result

#Benefits
vac_DG_MWI_COI_results[j] <- vac_DG_MWI_COI_result
vac_DG_MWI_VSL_results[j] <- vac_DG_MWI_VSL_result
vac_DG_MWI_VSLY_results[j] <- vac_DG_MWI_VSLY_result

vac_MWI_COI_results[j] <- vac_MWI_COI_result
vac_MWI_VSL_results[j] <- vac_MWI_VSL_result
vac_MWI_VSLY_results[j] <- vac_MWI_VSLY_result

#Net Benefits
vac_DG_MWI_NB_COI_results[j] <- vac_DG_MWI_COI_results[j] - vac_DG_MWI_total_cost_results[j] - total_DG_MWI_totalcost_results[j] - total_DG_MWI_envcost_results[j] - total_DG_MWI_fridgecost_results[j]

vac_DG_MWI_NB_VSL_results[j] <- vac_DG_MWI_VSL_results[j] - vac_DG_MWI_total_cost_results[j] - total_DG_MWI_totalcost_results[j] - total_DG_MWI_envcost_results[j] - total_DG_MWI_fridgecost_results[j]

vac_DG_MWI_NB_VSLY_results[j] <- vac_DG_MWI_VSLY_results[j] - vac_DG_MWI_total_cost_results[j] - total_DG_MWI_totalcost_results[j] - total_DG_MWI_envcost_results[j] - total_DG_MWI_fridgecost_results[j]



VCRC_MWI_NB_COI_results[j] <- vac_MWI_COI_results[j] + total_VCRC_MWI_gridpower_benefit[j] - vac_MWI_total_cost_results[j] - total_VCRC_MWI_totalcost_results[j]

VCRC_MWI_NB_VSL_results[j] <- vac_MWI_VSL_results[j] + total_VCRC_MWI_gridpower_benefit[j] - vac_MWI_total_cost_results[j] - total_VCRC_MWI_totalcost_results[j]

VCRC_MWI_NB_VSLY_results[j] <- vac_MWI_VSLY_results[j] + total_VCRC_MWI_gridpower_benefit[j] - vac_MWI_total_cost_results[j] - total_VCRC_MWI_totalcost_results[j]



PVSYS_MWI_NB_COI_results[j] <- vac_MWI_COI_result - vac_MWI_total_cost_result - total_PVSYS_MWI_totalcost_results[j] + total_PVSYS_MWI_eleccostaverted_results[j] + total_PVSYS_MWI_envbenefit_results[j] - total_PVSYS_MWI_fridgecost_results[j]

PVSYS_MWI_NB_VSL_results[j] <- vac_MWI_VSL_result - vac_MWI_total_cost_result - total_PVSYS_MWI_totalcost_results[j] + total_PVSYS_MWI_eleccostaverted_results[j] + total_PVSYS_MWI_envbenefit_results[j] - total_PVSYS_MWI_fridgecost_results[j]

PVSYS_MWI_NB_VSLY_results[j] <- vac_MWI_VSLY_result - vac_MWI_total_cost_result - total_PVSYS_MWI_totalcost_results[j] + total_PVSYS_MWI_eleccostaverted_results[j] + total_PVSYS_MWI_envbenefit_results[j] - total_PVSYS_MWI_fridgecost_results[j]

##DRC
#Diesel Generator
DG_DRC_capex_result <- Annualized_DG_capex_DRC
DG_DRC_opex_result <- Annualized_DG_opex_DRC
DG_DRC_direct_cost_result <- Annualized_DG_direct_cost_DRC
DG_DRC_emission_cost_result <- Annualized_DG_emission_cost_DRC
DG_DRC_fridge_cost_result <- Annualized_cost_new_fridge_DRC

#VCRC
VCRC_DRC_capex_result <- Annualized_VCRC_capex_cost_DRC
VCRC_DRC_opex_result <- Annualized_VCRC_opex_cost_DRC
VCRC_DRC_DG_opex_result <- Annualized_DRC_VCRC_revised_DG_opex 
VCRC_DRC_totalVCRCcost_result <- Annualized_VCRC_total_cost_DRC
VCRC_DRC_DG_emission_result <- annualized_rev_emission_cost_DRC
VCRC_DRC_batterycost_result <- annualized_VCRC_batterycost_DRC
VCRC_DRC_totalcost_result <- VCRC_DRC_totalVCRCcost_result + VCRC_DRC_DG_opex_result + VCRC_DRC_batterycost_result
VCRC_DRC_gridpower_benefit <- annualized_VCRC_gridpower_benefit_DRC 

#PVSYS
#PVSYS_DRC_capex_result <- Annualized_PVSYS_capex_cost_DRC
#PVSYS_DRC_opex_result <- Annualized_PVSYS_opex_cost_DRC
PVSYS_DRC_totalcost_result <- Annualized_PVSYS_total_cost_DRC
PVSYS_DRC_eleccost_averted_result <- Annualized_PVSYS_eleccostaverted_DRC
PVSYS_DRC_elec_env_averted_result <- Annualized_PVSYS_elec_envcostaverted_DRC
PVSYS_DRC_fridge_cost_result <- Annualized_cost_new_fridge_DRC

#Vaccine
vac_DG_DRC_cost_result <- Annualized_DRC_DG_vac_cost$Annualized_VacCost_Overall
vac_DG_DRC_delivery_cost_result <- Annualized_DRC_DG_vac_del_cost$Annualized_VacdelCost_Overall
vac_DG_DRC_total_cost_result <- Annualized_DRC_DG_vac_total_cost$Annualized_VacTotCost_Overall
vac_DG_DRC_COI_result <- Annualized_DRC_vac_COI$Annualized_VacCOI_Overall
vac_DG_DRC_VSL_result <- Annualized_DRC_vac_VSL$Annualized_VacVSL_Overall
vac_DG_DRC_VSLY_result <- Annualized_DRC_vac_VSLY$Annualized_VacVSLY_Overall

vac_DRC_cost_result <- Annualized_DRC_vac_cost$Annualized_VacCost_Overall
vac_DRC_delivery_cost_result <- Annualized_DRC_vac_del_cost$Annualized_VacdelCost_Overall
vac_DRC_total_cost_result <- Annualized_DRC_vac_total_cost$Annualized_VacTotCost_Overall
vac_DRC_COI_result <- Annualized_DRC_vac_COI$Annualized_VacCOI_Overall
vac_DRC_VSL_result <- Annualized_DRC_vac_VSL$Annualized_VacVSL_Overall
vac_DRC_VSLY_result <- Annualized_DRC_vac_VSLY$Annualized_VacVSLY_Overall

#MC array data store
#Diesel Generator
total_DG_DRC_capex_results[j] <- DG_DRC_capex_result
total_DG_DRC_opex_results[j] <- DG_DRC_opex_result
total_DG_DRC_totalcost_results[j] <- DG_DRC_direct_cost_result
total_DG_DRC_envcost_results[j] <- DG_DRC_emission_cost_result
total_DG_DRC_fridgecost_results[j] <- DG_DRC_fridge_cost_result

#VCRC
total_VCRC_DRC_capex_results[j] <- VCRC_DRC_capex_result
total_VCRC_DRC_opex_results[j] <- VCRC_DRC_opex_result
total_VCRC_DRC_totalVCRCcost_results[j] <- VCRC_DRC_totalVCRCcost_result
total_DG_VCRC_DRC_opex_results[j] <- VCRC_DRC_DG_opex_result
total_VCRC_DRC_envcost_results[j] <- VCRC_DRC_DG_emission_result
total_VCRC_DRC_batterycost_results[j] <- VCRC_DRC_batterycost_result
total_VCRC_DRC_totalcost_results[j] <- total_VCRC_DRC_totalVCRCcost_results[j] + total_DG_VCRC_DRC_opex_results[j] + total_VCRC_DRC_batterycost_results[j] + total_VCRC_DRC_envcost_results[j]
total_VCRC_DRC_gridpower_benefit[j] <- VCRC_DRC_gridpower_benefit

#PVSYS
#total_PVSYS_DRC_capex_results[j] <- PVSYS_DRC_capex_result
#total_PVSYS_DRC_opex_results[j] <- PVSYS_DRC_opex_result
total_PVSYS_DRC_totalcost_results[j] <- PVSYS_DRC_totalcost_result
total_PVSYS_DRC_eleccostaverted_results[j] <- PVSYS_DRC_eleccost_averted_result
total_PVSYS_DRC_envbenefit_results[j] <- PVSYS_DRC_elec_env_averted_result
total_PVSYS_DRC_fridgecost_results[j] <- PVSYS_DRC_fridge_cost_result

#Vaccine
vac_DG_DRC_cost_results[j] <- vac_DG_DRC_cost_result
vac_DG_DRC_delivery_cost_results[j] <- vac_DG_DRC_delivery_cost_result
vac_DG_DRC_total_cost_results[j] <- vac_DG_DRC_total_cost_result
vac_DRC_cost_results[j] <- vac_DRC_cost_result
vac_DRC_delivery_cost_results[j] <- vac_DRC_delivery_cost_result
vac_DRC_total_cost_results[j] <- vac_DRC_total_cost_result

#Benefits
vac_DG_DRC_COI_results[j] <- vac_DG_DRC_COI_result
vac_DG_DRC_VSL_results[j] <- vac_DG_DRC_VSL_result
vac_DG_DRC_VSLY_results[j] <- vac_DG_DRC_VSLY_result

vac_DRC_COI_results[j] <- vac_DRC_COI_result
vac_DRC_VSL_results[j] <- vac_DRC_VSL_result
vac_DRC_VSLY_results[j] <- vac_DRC_VSLY_result

#Net Benefits
vac_DG_DRC_NB_COI_results[j] <- vac_DG_DRC_COI_results[j] - vac_DG_DRC_total_cost_results[j] - total_DG_DRC_totalcost_results[j] - total_DG_DRC_envcost_results[j] - total_DG_DRC_fridgecost_results[j]

vac_DG_DRC_NB_VSL_results[j] <- vac_DG_DRC_VSL_results[j] - vac_DG_DRC_total_cost_results[j] - total_DG_DRC_totalcost_results[j] - total_DG_DRC_envcost_results[j] - total_DG_DRC_fridgecost_results[j]

vac_DG_DRC_NB_VSLY_results[j] <- vac_DG_DRC_VSLY_results[j] - vac_DG_DRC_total_cost_results[j] - total_DG_DRC_totalcost_results[j] - total_DG_DRC_envcost_results[j] - total_DG_DRC_fridgecost_results[j]




VCRC_DRC_NB_COI_results[j] <- vac_DRC_COI_results[j] + total_VCRC_DRC_gridpower_benefit[j] - vac_DRC_total_cost_results[j] - total_VCRC_DRC_totalcost_results[j]

VCRC_DRC_NB_VSL_results[j] <- vac_DRC_VSL_results[j] + total_VCRC_DRC_gridpower_benefit[j] - vac_DRC_total_cost_results[j] - total_VCRC_DRC_totalcost_results[j]

VCRC_DRC_NB_VSLY_results[j] <- vac_DRC_VSLY_results[j] + total_VCRC_DRC_gridpower_benefit[j] - vac_DRC_total_cost_results[j] - total_VCRC_DRC_totalcost_results[j]




PVSYS_DRC_NB_COI_results[j] <- vac_DRC_COI_results[j] - vac_DRC_total_cost_results[j] - total_PVSYS_DRC_totalcost_results[j] + total_PVSYS_DRC_eleccostaverted_results[j] + total_PVSYS_DRC_envbenefit_results[j] - total_PVSYS_DRC_fridgecost_results[j]

PVSYS_DRC_NB_VSL_results[j] <- vac_DRC_VSL_results[j] - vac_DRC_total_cost_results[j] - total_PVSYS_DRC_totalcost_results[j] + total_PVSYS_DRC_eleccostaverted_results[j] + total_PVSYS_DRC_envbenefit_results[j] - total_PVSYS_DRC_fridgecost_results[j]

PVSYS_DRC_NB_VSLY_results[j] <- vac_DRC_VSLY_results[j] - vac_DRC_total_cost_results[j] - total_PVSYS_DRC_totalcost_results[j] + total_PVSYS_DRC_eleccostaverted_results[j] + total_PVSYS_DRC_envbenefit_results[j] - total_PVSYS_DRC_fridgecost_results[j]

##Overall
#Diesel Generator
DG_overall_capex_result <- Annualized_DG_capex_overall
DG_overall_opex_result <- Annualized_DG_opex_overall
DG_overall_direct_cost_result <- Annualized_DG_direct_cost_overall
DG_overall_emission_cost_result <- Annualized_DG_emission_cost_overall
DG_overall_fridge_cost_result <-  Annualized_cost_new_fridge_overall

#VCRC
VCRC_overall_capex_cost <- VCRC_NGA_capex_result + VCRC_MWI_capex_result + VCRC_DRC_capex_result
VCRC_overall_opex_cost <- VCRC_NGA_opex_result + VCRC_MWI_opex_result + VCRC_DRC_opex_result
VCRC_overall_DGopex_cost <- VCRC_NGA_DG_opex_result + VCRC_MWI_DG_opex_result + VCRC_DRC_DG_opex_result
VCRC_overall_totalVCRC_cost <- VCRC_NGA_totalVCRCcost_result + VCRC_MWI_totalVCRCcost_result + VCRC_DRC_totalVCRCcost_result
VCRC_overall_DG_emission_result <- VCRC_NGA_DG_emission_result + VCRC_MWI_DG_emission_result + VCRC_DRC_DG_emission_result
VCRC_overall_batterycost_result <- VCRC_NGA_batterycost_result + VCRC_MWI_batterycost_result + VCRC_DRC_batterycost_result
VCRC_overall_cost <- VCRC_NGA_totalcost_result + VCRC_MWI_totalcost_result + VCRC_DRC_totalcost_result
VCRC_overall_gridpower_benefit <- VCRC_NGA_gridpower_benefit + VCRC_MWI_gridpower_benefit + VCRC_DRC_gridpower_benefit

#PVSYS
#PVSYS_overall_capex_cost <- Annualized_PVSYS_capex_cost_overall
#PVSYS_overall_opex_cost <- Annualized_PVSYS_opex_cost_overall
PVSYS_overall_total_cost <- PVSYS_NGA_totalcost_result + PVSYS_MWI_totalcost_result + PVSYS_DRC_totalcost_result
PVSYS_overall_eleccost_averted_result <- PVSYS_NGA_eleccost_averted_result + PVSYS_MWI_eleccost_averted_result + PVSYS_DRC_eleccost_averted_result
PVSYS_overall_elec_env_averted_result <- PVSYS_NGA_elec_env_averted_result + PVSYS_MWI_elec_env_averted_result + PVSYS_DRC_elec_env_averted_result
PVSYS_overall_fridge_cost_result <- PVSYS_NGA_fridge_cost_result + PVSYS_MWI_fridge_cost_result + PVSYS_DRC_fridge_cost_result

#Vaccine
vac_DG_cost_result <- Annualized_DG_vac_cost$Annualized_VacCost_Overall
vac_DG_delivery_cost_result <- Annualized_DG_vac_del_cost$Annualized_VacdelCost_Overall
vac_DG_total_cost_result <- Annualized_DG_vac_total_cost$Annualized_VacTotCost_Overall
vac_DG_COI_result <- Annualized_vac_COI$Annualized_VacCOI_Overall
vac_DG_VSL_result <- Annualized_vac_VSL$Annualized_VacVSL_Overall
vac_DG_VSLY_result <- Annualized_vac_VSLY$Annualized_VacVSLY_Overall

vac_cost_result <- Annualized_vac_cost$Annualized_VacCost_Overall
vac_delivery_cost_result <- Annualized_vac_del_cost$Annualized_VacdelCost_Overall
vac_total_cost_result <- Annualized_vac_total_cost$Annualized_VacTotCost_Overall
vac_COI_result <- Annualized_vac_COI$Annualized_VacCOI_Overall
vac_VSL_result <- Annualized_vac_VSL$Annualized_VacVSL_Overall
vac_VSLY_result <- Annualized_vac_VSLY$Annualized_VacVSLY_Overall

#MC array data store
#Diesel Generator
total_DG_totalcapex_results[j] <- DG_overall_capex_result
total_DG_totalopex_results[j] <- DG_overall_opex_result
total_DG_totalcost_results[j] <- DG_overall_direct_cost_result
total_DG_envcost_results [j] <- DG_overall_emission_cost_result
total_DG_total_fridgecost_results[j] <- DG_overall_fridge_cost_result

#VCRC
total_VCRC_capex_results[j] <- VCRC_overall_capex_cost
total_VCRC_opex_results[j] <- VCRC_overall_opex_cost
total_VCRC_DGopexcost_results[j] <- VCRC_overall_DGopex_cost
total_VCRC_totalVCRCcost_results[j] <- VCRC_overall_totalVCRC_cost
total_VCRC_envcost_results[j] <- VCRC_overall_DG_emission_result
total_VCRC_batterycost_results[j] <- total_VCRC_NGA_batterycost_results[j] + total_VCRC_MWI_batterycost_results[j] + total_VCRC_DRC_batterycost_results[j]
total_VCRC_totalcost_results[j] <- total_VCRC_totalVCRCcost_results[j] + total_VCRC_DGopexcost_results[j] + total_VCRC_batterycost_results[j] + total_VCRC_envcost_results[j] 
total_VCRC_gridpower_benefit[j] <- VCRC_overall_gridpower_benefit

#PVSYS
#total_PVSYS_capex_results[j] <- PVSYS_overall_capex_cost
#total_PVSYS_opex_results[j] <- PVSYS_overall_opex_cost
total_PVSYS_totalcost_results[j] <- PVSYS_overall_total_cost
total_PVSYS_eleccostaverted_results[j] <- PVSYS_overall_eleccost_averted_result
total_PVSYS_envbenefit_results[j] <- PVSYS_overall_elec_env_averted_result
total_PVSYS_total_fridgecost_results[j] <- PVSYS_overall_fridge_cost_result

#Vaccine
vac_DG_cost_results[j] <- vac_DG_cost_result 
vac_DG_delivery_cost_results[j] <- vac_DG_delivery_cost_result
vac_DG_total_cost_results[j] <- vac_DG_total_cost_result
vac_cost_results[j] <- vac_cost_result 
vac_delivery_cost_results[j] <- vac_delivery_cost_result
vac_total_cost_results[j] <- vac_total_cost_result

#Benefits
vac_DG_COI_results[j] <- vac_DG_COI_result
vac_DG_VSL_results[j] <- vac_DG_VSL_result
vac_DG_VSLY_results[j] <- vac_DG_VSLY_result

vac_COI_results[j] <- vac_COI_result
vac_VSL_results[j] <- vac_VSL_result
vac_VSLY_results[j] <- vac_VSLY_result

#Net Benefits

vac_DG_NB_COI_results[j] <- vac_DG_COI_results[j] - vac_DG_total_cost_results[j] - total_DG_totalcost_results[j] - total_DG_envcost_results [j] - total_DG_total_fridgecost_results[j]

vac_DG_NB_VSL_results[j] <- vac_DG_VSL_results[j] - vac_DG_total_cost_results[j] - total_DG_totalcost_results[j] - total_DG_envcost_results [j] - total_DG_total_fridgecost_results[j]

vac_DG_NB_VSLY_results[j] <- vac_DG_VSLY_results[j] - vac_DG_total_cost_results[j] - total_DG_totalcost_results[j] - total_DG_envcost_results [j] - total_DG_total_fridgecost_results[j]



VCRC_NB_COI_results [j] <- vac_COI_results[j] + total_VCRC_gridpower_benefit[j] - vac_total_cost_results[j] - total_VCRC_totalcost_results[j]

VCRC_NB_VSL_results [j] <- vac_VSL_results[j] + total_VCRC_gridpower_benefit[j] - vac_total_cost_results[j] - total_VCRC_totalcost_results[j]

VCRC_NB_VSLY_results [j] <- vac_VSLY_results[j] + total_VCRC_gridpower_benefit[j] - vac_total_cost_results[j] - total_VCRC_totalcost_results[j]



PVSYS_NB_COI_results [j] <- vac_COI_results[j] - vac_total_cost_results[j] - total_PVSYS_totalcost_results[j] + total_PVSYS_eleccostaverted_results[j] + total_VCRC_gridpower_benefit[j] - total_PVSYS_total_fridgecost_results[j]

PVSYS_NB_VSL_results [j] <- vac_VSL_results[j] - vac_total_cost_results[j] - total_PVSYS_totalcost_results[j] + total_PVSYS_eleccostaverted_results[j] + total_VCRC_gridpower_benefit[j] - total_PVSYS_total_fridgecost_results[j]

PVSYS_NB_VSLY_results [j] <- vac_VSLY_results[j] - vac_total_cost_results[j] - total_PVSYS_totalcost_results[j] + total_PVSYS_eleccostaverted_results[j] + total_VCRC_gridpower_benefit[j] - total_PVSYS_total_fridgecost_results[j]

## end of MC loop
}

##DG Summary

Summary_table_DG <- matrix(nrow = 4, ncol = 56)
rownames(Summary_table_DG) <- c("Nigeria", "Malawi", "Demo. Republic of Congo", "Overall")
colnames(Summary_table_DG) <- c("DG_capex_median","DG_capex_mean","DG_capex_min","DG_capex_max","DG_opex_median","DG_opex_mean","DG_opex_min","DG_opex_max","DG_direct_cost_median","DG_direct_cost_mean","DG_direct_cost_min","DG_direct_cost_max","DG_fridge_cost_median","DG_fridge_cost_mean","DG_fridge_cost_min","DG_fridge_cost_max","DG_env_cost_median","DG_env_cost_mean","DG_env_cost_min","DG_env_cost_max","Vaccine_costs_median","Vaccine_costs_mean","Vaccine_costs_min","Vaccine_costs_max","Vaccine_del_costs_median","Vaccine_del_costs_mean","Vaccine_del_costs_min","Vaccine_del_costs_max","Vaccine_total_costs_median","Vaccine_total_costs_mean","Vaccine_total_costs_min","Vaccine_total_costs_max","Vaccine_COI_median","Vaccine_COI_mean","Vaccine_COI_min","Vaccine_COI_max","Vaccine_VSL_median","Vaccine_VSL_mean","Vaccine_VSL_min","Vaccine_VSL_max","Vaccine_VSLY_median","Vaccine_VSLY_mean","Vaccine_VSLY_min","Vaccine_VSLY_max","NB_COI_median","NB_COI_mean","NB_COI_min","NB_COI_max","NB_VSL_median","NB_VSL_mean","NB_VSL_min","NB_VSL_max","NB_VSLY_median","NB_VSLY_mean","NB_VSLY_min","NB_VSLY_max")

Summary_table_DG[1,] <- c(median(total_DG_NGA_capex_results),mean(total_DG_NGA_capex_results),min(total_DG_NGA_capex_results),max(total_DG_NGA_capex_results),median(total_DG_NGA_opex_results),mean(total_DG_NGA_opex_results),min(total_DG_NGA_opex_results),max(total_DG_NGA_opex_results),median(total_DG_NGA_totalcost_results),mean(total_DG_NGA_totalcost_results),min(total_DG_NGA_totalcost_results),max(total_DG_NGA_totalcost_results),median(total_DG_NGA_fridgecost_results),mean(total_DG_NGA_fridgecost_results),min(total_DG_NGA_fridgecost_results),max(total_DG_NGA_fridgecost_results),median(total_DG_NGA_envcost_results),mean(total_DG_NGA_envcost_results),min(total_DG_NGA_envcost_results),max(total_DG_NGA_envcost_results),median(vac_DG_NGA_cost_results),mean(vac_DG_NGA_cost_results),min(vac_DG_NGA_cost_results),max(vac_DG_NGA_cost_results),median(vac_DG_NGA_delivery_cost_results),mean(vac_DG_NGA_delivery_cost_results),min(vac_DG_NGA_delivery_cost_results),max(vac_DG_NGA_delivery_cost_results),median(vac_DG_NGA_total_cost_results),mean(vac_DG_NGA_total_cost_results),min(vac_DG_NGA_total_cost_results),max(vac_DG_NGA_total_cost_results),median(vac_DG_NGA_COI_results),mean(vac_DG_NGA_COI_results),min(vac_DG_NGA_COI_results),max(vac_DG_NGA_COI_results),median(vac_DG_NGA_VSL_results),mean(vac_DG_NGA_VSL_results),min(vac_DG_NGA_VSL_results),max(vac_DG_NGA_VSL_results),median(vac_DG_NGA_VSLY_results),mean(vac_DG_NGA_VSLY_results),min(vac_DG_NGA_VSLY_results),max(vac_DG_NGA_VSLY_results),median(vac_DG_NGA_NB_COI_results),mean(vac_DG_NGA_NB_COI_results),min(vac_DG_NGA_NB_COI_results),max(vac_DG_NGA_NB_COI_results),median(vac_DG_NGA_NB_VSL_results),mean(vac_DG_NGA_NB_VSL_results),min(vac_DG_NGA_NB_VSL_results),max(vac_DG_NGA_NB_VSL_results),median(vac_DG_NGA_NB_VSLY_results),mean(vac_DG_NGA_NB_VSLY_results),min(vac_DG_NGA_NB_VSLY_results),max(vac_DG_NGA_NB_VSLY_results))


Summary_table_DG[2,] <- c(median(total_DG_MWI_capex_results),mean(total_DG_MWI_capex_results),min(total_DG_MWI_capex_results),max(total_DG_MWI_capex_results),median(total_DG_MWI_opex_results),mean(total_DG_MWI_opex_results),min(total_DG_MWI_opex_results),max(total_DG_MWI_opex_results),median(total_DG_MWI_totalcost_results),mean(total_DG_MWI_totalcost_results),min(total_DG_MWI_totalcost_results),max(total_DG_MWI_totalcost_results),median(total_DG_MWI_fridgecost_results),mean(total_DG_MWI_fridgecost_results),min(total_DG_MWI_fridgecost_results),max(total_DG_MWI_fridgecost_results),median(total_DG_MWI_envcost_results),mean(total_DG_MWI_envcost_results),min(total_DG_MWI_envcost_results),max(total_DG_MWI_envcost_results),median(vac_DG_MWI_cost_results),mean(vac_DG_MWI_cost_results),min(vac_DG_MWI_cost_results),max(vac_DG_MWI_cost_results),median(vac_DG_MWI_delivery_cost_results),mean(vac_DG_MWI_delivery_cost_results),min(vac_DG_MWI_delivery_cost_results),max(vac_DG_MWI_delivery_cost_results),median(vac_DG_MWI_total_cost_results),mean(vac_DG_MWI_total_cost_results),min(vac_DG_MWI_total_cost_results),max(vac_DG_MWI_total_cost_results),median(vac_DG_MWI_COI_results),mean(vac_DG_MWI_COI_results),min(vac_DG_MWI_COI_results),max(vac_DG_MWI_COI_results),median(vac_DG_MWI_VSL_results),mean(vac_DG_MWI_VSL_results),min(vac_DG_MWI_VSL_results),max(vac_DG_MWI_VSL_results),median(vac_DG_MWI_VSLY_results),mean(vac_DG_MWI_VSLY_results),min(vac_DG_MWI_VSLY_results),max(vac_DG_MWI_VSLY_results),median(vac_DG_MWI_NB_COI_results),mean(vac_DG_MWI_NB_COI_results),min(vac_DG_MWI_NB_COI_results),max(vac_DG_MWI_NB_COI_results),median(vac_DG_MWI_NB_VSL_results),mean(vac_DG_MWI_NB_VSL_results),min(vac_DG_MWI_NB_VSL_results),max(vac_DG_MWI_NB_VSL_results),median(vac_DG_MWI_NB_VSLY_results),mean(vac_DG_MWI_NB_VSLY_results),min(vac_DG_MWI_NB_VSLY_results),max(vac_DG_MWI_NB_VSLY_results))

Summary_table_DG[3,] <- c(median(total_DG_DRC_capex_results),mean(total_DG_DRC_capex_results),min(total_DG_DRC_capex_results),max(total_DG_DRC_capex_results),median(total_DG_DRC_opex_results),mean(total_DG_DRC_opex_results),min(total_DG_DRC_opex_results),max(total_DG_DRC_opex_results),median(total_DG_DRC_totalcost_results),mean(total_DG_DRC_totalcost_results),min(total_DG_DRC_totalcost_results),max(total_DG_DRC_totalcost_results),median(total_DG_DRC_fridgecost_results),mean(total_DG_DRC_fridgecost_results),min(total_DG_DRC_fridgecost_results),max(total_DG_DRC_fridgecost_results),median(total_DG_DRC_envcost_results),mean(total_DG_DRC_envcost_results),min(total_DG_DRC_envcost_results),max(total_DG_DRC_envcost_results),median(vac_DG_DRC_cost_results),mean(vac_DG_DRC_cost_results),min(vac_DG_DRC_cost_results),max(vac_DG_DRC_cost_results),median(vac_DG_DRC_delivery_cost_results),mean(vac_DG_DRC_delivery_cost_results),min(vac_DG_DRC_delivery_cost_results),max(vac_DG_DRC_delivery_cost_results),median(vac_DG_DRC_total_cost_results),mean(vac_DG_DRC_total_cost_results),min(vac_DG_DRC_total_cost_results),max(vac_DG_DRC_total_cost_results),median(vac_DG_DRC_COI_results),mean(vac_DG_DRC_COI_results),min(vac_DG_DRC_COI_results),max(vac_DG_DRC_COI_results),median(vac_DG_DRC_VSL_results),mean(vac_DG_DRC_VSL_results),min(vac_DG_DRC_VSL_results),max(vac_DG_DRC_VSL_results),median(vac_DG_DRC_VSLY_results),mean(vac_DG_DRC_VSLY_results),min(vac_DG_DRC_VSLY_results),max(vac_DG_DRC_VSLY_results),median(vac_DG_DRC_NB_COI_results),mean(vac_DG_DRC_NB_COI_results),min(vac_DG_DRC_NB_COI_results),max(vac_DG_DRC_NB_COI_results),median(vac_DG_DRC_NB_VSL_results),mean(vac_DG_DRC_NB_VSL_results),min(vac_DG_DRC_NB_VSL_results),max(vac_DG_DRC_NB_VSL_results),median(vac_DG_DRC_NB_VSLY_results),mean(vac_DG_DRC_NB_VSLY_results),min(vac_DG_DRC_NB_VSLY_results),max(vac_DG_DRC_NB_VSLY_results))

Summary_table_DG[4,] <- c(median(total_DG_totalcapex_results),mean(total_DG_totalcapex_results),min(total_DG_totalcapex_results),max(total_DG_totalcapex_results),median(total_DG_totalopex_results),mean(total_DG_totalopex_results),min(total_DG_totalopex_results),max(total_DG_totalopex_results),median(total_DG_totalcost_results),mean(total_DG_totalcost_results),min(total_DG_totalcost_results),max(total_DG_totalcost_results),median(total_DG_total_fridgecost_results),mean(total_DG_total_fridgecost_results),min(total_DG_total_fridgecost_results),max(total_DG_total_fridgecost_results),median(total_DG_envcost_results),mean(total_DG_envcost_results),min(total_DG_envcost_results),max(total_DG_envcost_results),median(vac_DG_cost_results),mean(vac_DG_cost_results),min(vac_DG_cost_results),max(vac_DG_cost_results),median(vac_DG_delivery_cost_results),mean(vac_DG_delivery_cost_results),min(vac_DG_delivery_cost_results),max(vac_DG_delivery_cost_results),median(vac_DG_total_cost_results),mean(vac_DG_total_cost_results),min(vac_DG_total_cost_results),max(vac_DG_total_cost_results),median(vac_DG_COI_results),mean(vac_DG_COI_results),min(vac_DG_COI_results),max(vac_DG_COI_results),median(vac_DG_VSL_results),mean(vac_DG_VSL_results),min(vac_DG_VSL_results),max(vac_DG_VSL_results),median(vac_DG_VSLY_results),mean(vac_DG_VSLY_results),min(vac_DG_VSLY_results),max(vac_DG_VSLY_results),median(vac_DG_NB_COI_results),mean(vac_DG_NB_COI_results),min(vac_DG_NB_COI_results),max(vac_DG_NB_COI_results),median(vac_DG_NB_VSL_results),mean(vac_DG_NB_VSL_results),min(vac_DG_NB_VSL_results),max(vac_DG_NB_VSL_results),median(vac_DG_NB_VSLY_results),mean(vac_DG_NB_VSLY_results),min(vac_DG_NB_VSLY_results),max(vac_DG_NB_VSLY_results))

Summary_table_DG <- as.data.frame(Summary_table_DG)
library(openxlsx)
write.xlsx(Summary_table_DG, paste("Summary_table_StatusQuo_VCRC.xlsx"))

hist(total_DG_totalcost_results, main = "DG Direct Cost", cex.main = 1,xlab = "MC DG Direct Cost ($ million)", col = "lightblue", border = "black")

hist(total_DG_envcost_results, main = "DG Environment Cost",cex.main = 1, xlab = "MC DG Environment Cost ($ million)", col = "lightblue", border = "black")

hist(vac_DG_cost_results, main = "Vaccination purchase Cost", cex.main = 1,xlab = "MC Vaccination purchase Cost ($ million)", col = "lightblue", border = "black")

hist(vac_DG_delivery_cost_results, main = "Vaccination delivery Cost",cex.main = 1, xlab = "MC Vaccination delivery Cost ($ million)", col = "lightblue", border = "black")

hist(vac_DG_total_cost_results, main = "Vaccination Total Cost", cex.main = 1,xlab = "MC Vaccination Total Cost ($ million)", col = "lightblue", border = "black")

hist(vac_DG_COI_results, main = " Vaccine Benefit (COI Method)",cex.main = 1, xlab = "MC Benefit COI method ($ million)", col = "lightblue", border = "black")

hist(vac_DG_VSL_results, main = "Vaccine Benefit (VSL Method)",cex.main = 1, xlab = "MC Benefit VSL method ($ million)", col = "lightblue", border = "black")

hist(vac_DG_VSLY_results, main = "Vaccine Benefit (VSLY Method)",cex.main = 1, xlab = "MC Benefit VSLY method ($ million)", col = "lightblue", border = "black")

hist(total_DG_total_fridgecost_results, main = "DG battery costs",cex.main = 1, xlab = "MC DG battery costs", col = "lightblue", border = "black")

options(scipen = 999)
hist(vac_DG_NB_COI_results, main = "Monte Carlo histogram for Net Benefit using COI Method for Status_Quo", cex.main = 1,xlab = "Net Benefit COI method ($ million)", ylab = "number of cases from a total of 10,000",col = "lightblue", border = "black", axes=FALSE)
axis(side = 1, at = pretty(vac_DG_NB_COI_results), labels = paste("$", format(pretty(vac_DG_NB_COI_results), big.mark = ",")), las = 1)
axis(side = 2)
options(scipen = 0)
box()

summary(vac_DG_NB_COI_results)

options(scipen = 999)
hist(vac_DG_NB_VSL_results, main = "Monte Carlo histogram for Net Benefit using VSL Method for Status_Quo", cex.main = 1,xlab = "Net Benefit VSL method ($ million)", ylab = "number of cases from a total of 10,000",col = "lightblue", border = "black", axes=FALSE)
axis(side = 1, at = pretty(vac_DG_NB_VSL_results), labels = paste("$", format(pretty(vac_DG_NB_VSL_results), big.mark = ",")), las = 1)
axis(side = 2)
options(scipen = 0)
box()

summary(vac_DG_NB_VSL_results)

options(scipen = 999)
hist(vac_DG_NB_VSLY_results, main = "Monte Carlo histogram for Net Benefit using VSLY Method for Status_Quo",cex.main = 1, xlab = "Net Benefit VSLY method ($ million)", ylab = "number of cases from a total of 10,000",col = "lightblue", border = "black", axes=FALSE)
axis(side = 1, at = pretty(vac_DG_NB_VSLY_results), labels = paste("$", format(pretty(vac_DG_NB_VSLY_results), big.mark = ",")), las = 1)
axis(side = 2)
options(scipen = 0)
box()

summary(vac_DG_NB_VSLY_results)


#VCRC Summary
Summary_table_SF <- matrix(nrow = 4, ncol = 60)
rownames(Summary_table_SF) <- c("Nigeria", "Malawi", "Demo. Republic of Congo", "Overall")
colnames(Summary_table_SF) <- c("VCRC_cost_median","VCRC_cost_mean","VCRC_cost_min","VCRC_cost_max","VCRC_DGopex_median","VCRC_DGopex_mean","VCRC_DGopex_min","VCRC_DGopex_max","VCRC_battery_cost_median","VCRC_battery_cost_mean","VCRC_battery_cost_min","VCRC_battery_cost_max","VCRC_emission_cost_median","VCRC_emission_cost_mean","VCRC_emission_cost_min","VCRC_emission_cost_max","VCRC_totalcost_median","VCRC_totalcost_mean","VCRC_totalcost_min","VCRC_totalcost_max","Low_elec_beneift_median","Low_elec_beneift_mean","Low_elec_beneift_min","Low_elec_beneift_max","Vaccine_costs_median","Vaccine_costs_mean","Vaccine_costs_min","Vaccine_costs_max","Vaccine_del_costs_median","Vaccine_del_costs_mean","Vaccine_del_costs_min","Vaccine_del_costs_max","Vaccine_total_costs_median","Vaccine_total_costs_mean","Vaccine_total_costs_min","Vaccine_total_costs_max","Vaccine_COI_median","Vaccine_COI_mean","Vaccine_COI_min","Vaccine_COI_max","Vaccine_VSL_median","Vaccine_VSL_mean","Vaccine_VSL_min","Vaccine_VSL_max","Vaccine_VSLY_median","Vaccine_VSLY_mean","Vaccine_VSLY_min","Vaccine_VSLY_max","NB_COI_median","NB_COI_mean","NB_COI_min","NB_COI_max","NB_VSL_median","NB_VSL_mean","NB_VSL_min","NB_VSL_max","NB_VSLY_median","NB_VSLY_mean","NB_VSLY_min","NB_VSLY_max")
Summary_table_SF[1,] <- c(median(total_VCRC_NGA_totalVCRCcost_results),mean(total_VCRC_NGA_totalVCRCcost_results),min(total_VCRC_NGA_totalVCRCcost_results),max(total_VCRC_NGA_totalVCRCcost_results),median(total_DG_VCRC_NGA_opex_results),mean(total_DG_VCRC_NGA_opex_results),min(total_DG_VCRC_NGA_opex_results),max(total_DG_VCRC_NGA_opex_results),median(total_VCRC_NGA_batterycost_results),mean(total_VCRC_NGA_batterycost_results),min(total_VCRC_NGA_batterycost_results),max(total_VCRC_NGA_batterycost_results),median(total_VCRC_NGA_envcost_results),mean(total_VCRC_NGA_envcost_results),min(total_VCRC_NGA_envcost_results),max(total_VCRC_NGA_envcost_results),median(total_VCRC_NGA_totalcost_results),mean(total_VCRC_NGA_totalcost_results),min(total_VCRC_NGA_totalcost_results),max(total_VCRC_NGA_totalcost_results),median(total_VCRC_NGA_gridpower_benefit),mean(total_VCRC_NGA_gridpower_benefit),min(total_VCRC_NGA_gridpower_benefit),max(total_VCRC_NGA_gridpower_benefit),median(vac_NGA_cost_results),mean(vac_NGA_cost_results),min(vac_NGA_cost_results),max(vac_NGA_cost_results),median(vac_NGA_delivery_cost_results),mean(vac_NGA_delivery_cost_results),min(vac_NGA_delivery_cost_results),max(vac_NGA_delivery_cost_results),median(vac_NGA_total_cost_results),mean(vac_NGA_total_cost_results),min(vac_NGA_total_cost_results),max(vac_NGA_total_cost_results),median(vac_NGA_COI_results),mean(vac_NGA_COI_results),min(vac_NGA_COI_results),max(vac_NGA_COI_results),median(vac_NGA_VSL_results),mean(vac_NGA_VSL_results),min(vac_NGA_VSL_results),max(vac_NGA_VSL_results),median(vac_NGA_VSLY_results),mean(vac_NGA_VSLY_results),min(vac_NGA_VSLY_results),max(vac_NGA_VSLY_results),median(VCRC_NGA_NB_COI_results),mean(VCRC_NGA_NB_COI_results),min(VCRC_NGA_NB_COI_results),max(VCRC_NGA_NB_COI_results),median(VCRC_NGA_NB_VSL_results),mean(VCRC_NGA_NB_VSL_results),min(VCRC_NGA_NB_VSL_results),max(VCRC_NGA_NB_VSL_results),median(VCRC_NGA_NB_VSLY_results),mean(VCRC_NGA_NB_VSLY_results),min(VCRC_NGA_NB_VSLY_results),max(VCRC_NGA_NB_VSLY_results))

Summary_table_SF[2,] <- c(median(total_VCRC_MWI_totalVCRCcost_results),mean(total_VCRC_MWI_totalVCRCcost_results),min(total_VCRC_MWI_totalVCRCcost_results),max(total_VCRC_MWI_totalVCRCcost_results),median(total_DG_VCRC_MWI_opex_results),mean(total_DG_VCRC_MWI_opex_results),min(total_DG_VCRC_MWI_opex_results),max(total_DG_VCRC_MWI_opex_results),median(total_VCRC_MWI_batterycost_results),mean(total_VCRC_MWI_batterycost_results),min(total_VCRC_MWI_batterycost_results),max(total_VCRC_MWI_batterycost_results),median(total_VCRC_MWI_envcost_results),mean(total_VCRC_MWI_envcost_results),min(total_VCRC_MWI_envcost_results),max(total_VCRC_MWI_envcost_results),median(total_VCRC_MWI_totalcost_results),mean(total_VCRC_MWI_totalcost_results),min(total_VCRC_MWI_totalcost_results),max(total_VCRC_MWI_totalcost_results),median(total_VCRC_MWI_gridpower_benefit),mean(total_VCRC_MWI_gridpower_benefit),min(total_VCRC_MWI_gridpower_benefit),max(total_VCRC_MWI_gridpower_benefit),median(vac_MWI_cost_results),mean(vac_MWI_cost_results),min(vac_MWI_cost_results),max(vac_MWI_cost_results),median(vac_MWI_delivery_cost_results),mean(vac_MWI_delivery_cost_results),min(vac_MWI_delivery_cost_results),max(vac_MWI_delivery_cost_results),median(vac_MWI_total_cost_results),mean(vac_MWI_total_cost_results),min(vac_MWI_total_cost_results),max(vac_MWI_total_cost_results),median(vac_MWI_COI_results),mean(vac_MWI_COI_results),min(vac_MWI_COI_results),max(vac_MWI_COI_results),median(vac_MWI_VSL_results),mean(vac_MWI_VSL_results),min(vac_MWI_VSL_results),max(vac_MWI_VSL_results),median(vac_MWI_VSLY_results),mean(vac_MWI_VSLY_results),min(vac_MWI_VSLY_results),max(vac_MWI_VSLY_results),median(VCRC_MWI_NB_COI_results),mean(VCRC_MWI_NB_COI_results),min(VCRC_MWI_NB_COI_results),max(VCRC_MWI_NB_COI_results),median(VCRC_MWI_NB_VSL_results),mean(VCRC_MWI_NB_VSL_results),min(VCRC_MWI_NB_VSL_results),max(VCRC_MWI_NB_VSL_results),median(VCRC_MWI_NB_VSLY_results),mean(VCRC_MWI_NB_VSLY_results),min(VCRC_MWI_NB_VSLY_results),max(VCRC_MWI_NB_VSLY_results))

Summary_table_SF[3,] <- c(median(total_VCRC_DRC_totalVCRCcost_results),mean(total_VCRC_DRC_totalVCRCcost_results),min(total_VCRC_DRC_totalVCRCcost_results),max(total_VCRC_DRC_totalVCRCcost_results),median(total_DG_VCRC_DRC_opex_results),mean(total_DG_VCRC_DRC_opex_results),min(total_DG_VCRC_DRC_opex_results),max(total_DG_VCRC_DRC_opex_results),median(total_VCRC_DRC_batterycost_results),mean(total_VCRC_DRC_batterycost_results),min(total_VCRC_DRC_batterycost_results),max(total_VCRC_DRC_batterycost_results),median(total_VCRC_DRC_envcost_results),mean(total_VCRC_DRC_envcost_results),min(total_VCRC_DRC_envcost_results),max(total_VCRC_DRC_envcost_results),median(total_VCRC_DRC_totalcost_results),mean(total_VCRC_DRC_totalcost_results),min(total_VCRC_DRC_totalcost_results),max(total_VCRC_DRC_totalcost_results),median(total_VCRC_DRC_gridpower_benefit),mean(total_VCRC_DRC_gridpower_benefit),min(total_VCRC_DRC_gridpower_benefit),max(total_VCRC_DRC_gridpower_benefit),median(vac_DRC_cost_results),mean(vac_DRC_cost_results),min(vac_DRC_cost_results),max(vac_DRC_cost_results),median(vac_DRC_delivery_cost_results),mean(vac_DRC_delivery_cost_results),min(vac_DRC_delivery_cost_results),max(vac_DRC_delivery_cost_results),median(vac_DRC_total_cost_results),mean(vac_DRC_total_cost_results),min(vac_DRC_total_cost_results),max(vac_DRC_total_cost_results),median(vac_DRC_COI_results),mean(vac_DRC_COI_results),min(vac_DRC_COI_results),max(vac_DRC_COI_results),median(vac_DRC_VSL_results),mean(vac_DRC_VSL_results),min(vac_DRC_VSL_results),max(vac_DRC_VSL_results),median(vac_DRC_VSLY_results),mean(vac_DRC_VSLY_results),min(vac_DRC_VSLY_results),max(vac_DRC_VSLY_results),median(VCRC_DRC_NB_COI_results),mean(VCRC_DRC_NB_COI_results),min(VCRC_DRC_NB_COI_results),max(VCRC_DRC_NB_COI_results),median(VCRC_DRC_NB_VSL_results),mean(VCRC_DRC_NB_VSL_results),min(VCRC_DRC_NB_VSL_results),max(VCRC_DRC_NB_VSL_results),median(VCRC_DRC_NB_VSLY_results),mean(VCRC_DRC_NB_VSLY_results),min(VCRC_DRC_NB_VSLY_results),max(VCRC_DRC_NB_VSLY_results))

Summary_table_SF[4,] <- c(median(total_VCRC_totalVCRCcost_results),mean(total_VCRC_totalVCRCcost_results),min(total_VCRC_totalVCRCcost_results),max(total_VCRC_totalVCRCcost_results),median(total_VCRC_DGopexcost_results),mean(total_VCRC_DGopexcost_results),min(total_VCRC_DGopexcost_results),max(total_VCRC_DGopexcost_results),median(total_VCRC_batterycost_results),mean(total_VCRC_batterycost_results),min(total_VCRC_batterycost_results),max(total_VCRC_batterycost_results),median(total_VCRC_envcost_results),mean(total_VCRC_envcost_results),min(total_VCRC_envcost_results),max(total_VCRC_envcost_results),median(total_VCRC_totalcost_results),mean(total_VCRC_totalcost_results),min(total_VCRC_totalcost_results),max(total_VCRC_totalcost_results),median(total_VCRC_gridpower_benefit),mean(total_VCRC_gridpower_benefit),min(total_VCRC_gridpower_benefit),max(total_VCRC_gridpower_benefit),median(vac_cost_results),mean(vac_cost_results),min(vac_cost_results),max(vac_cost_results),median(vac_delivery_cost_results),mean(vac_delivery_cost_results),min(vac_delivery_cost_results),max(vac_delivery_cost_results),median(vac_total_cost_results),mean(vac_total_cost_results),min(vac_total_cost_results),max(vac_total_cost_results),median(vac_COI_results),mean(vac_COI_results),min(vac_COI_results),max(vac_COI_results),median(vac_VSL_results),mean(vac_VSL_results),min(vac_VSL_results),max(vac_VSL_results),median(vac_VSLY_results),mean(vac_VSLY_results),min(vac_VSLY_results),max(vac_VSLY_results),median(VCRC_NB_COI_results),mean(VCRC_NB_COI_results),min(VCRC_NB_COI_results),max(VCRC_NB_COI_results),median(VCRC_NB_VSL_results),mean(VCRC_NB_VSL_results),min(VCRC_NB_VSL_results),max(VCRC_NB_VSL_results),median(VCRC_NB_VSLY_results),mean(VCRC_NB_VSLY_results),min(VCRC_NB_VSLY_results),max(VCRC_NB_VSLY_results))

Summary_table_SF <- as.data.frame(Summary_table_SF)

#PVSYS Summary

Summary_table_PV <- matrix(nrow = 4, ncol = 48)
rownames(Summary_table_PV) <- c("Nigeria", "Malawi", "Demo. Republic of Congo", "Overall")
colnames(Summary_table_PV) <- c("PVSYS_cost_median","PVSYS_cost_mean","PVSYS_cost_min","PVSYS_cost_max","Grid_elec_cost_av_median","Grid_elec_cost_av_max","Grid_elec_cost_av_min","Grid_elec_cost_av_max","PVSYS_fridge_cost_median","PVSYS_fridge_cost_mean","PVSYS_fridge_cost_min","PVSYS_fridge_cost_max","Vaccine_costs_median","Vaccine_costs_mean","Vaccine_costs_min","Vaccine_costs_max","Vaccine_del_costs_median","Vaccine_del_costs_mean","Vaccine_del_costs_min","Vaccine_del_costs_max","Vaccine_total_costs_median","Vaccine_total_costs_mean","Vaccine_total_costs_min","Vaccine_total_costs_max","Vaccine_COI_median","Vaccine_COI_mean","Vaccine_COI_min","Vaccine_COI_max","Vaccine_VSL_median","Vaccine_VSL_mean","Vaccine_VSL_min","Vaccine_VSL_max","Vaccine_VSLY_median","Vaccine_VSLY_mean","Vaccine_VSLY_min","Vaccine_VSLY_max","NB_COI_median","NB_COI_mean","NB_COI_min","NB_COI_max","NB_VSL_median","NB_VSL_mean","NB_VSL_min","NB_VSL_max","NB_VSLY_median","NB_VSLY_mean","NB_VSLY_min","NB_VSLY_max")
Summary_table_PV[1,] <- c(median(total_PVSYS_NGA_totalcost_results),mean(total_PVSYS_NGA_totalcost_results),min(total_PVSYS_NGA_totalcost_results),max(total_PVSYS_NGA_totalcost_results),median(total_PVSYS_NGA_eleccostaverted_results),mean(total_PVSYS_NGA_eleccostaverted_results),min(total_PVSYS_NGA_eleccostaverted_results),max(total_PVSYS_NGA_eleccostaverted_results),median(total_PVSYS_NGA_fridgecost_results),mean(total_PVSYS_NGA_fridgecost_results),min(total_PVSYS_NGA_fridgecost_results),max(total_PVSYS_NGA_fridgecost_results),median(vac_NGA_cost_results),mean(vac_NGA_cost_results),min(vac_NGA_cost_results),max(vac_NGA_cost_results),median(vac_NGA_delivery_cost_results),mean(vac_NGA_delivery_cost_results),min(vac_NGA_delivery_cost_results),max(vac_NGA_delivery_cost_results),median(vac_NGA_total_cost_results),mean(vac_NGA_total_cost_results),min(vac_NGA_total_cost_results),max(vac_NGA_total_cost_results),median(vac_NGA_COI_results),mean(vac_NGA_COI_results),min(vac_NGA_COI_results),max(vac_NGA_COI_results),median(vac_NGA_VSL_results),mean(vac_NGA_VSL_results),min(vac_NGA_VSL_results),max(vac_NGA_VSL_results),median(vac_NGA_VSLY_results),mean(vac_NGA_VSLY_results),min(vac_NGA_VSLY_results),max(vac_NGA_VSLY_results),median(PVSYS_NGA_NB_COI_results),mean(PVSYS_NGA_NB_COI_results),min(PVSYS_NGA_NB_COI_results),max(PVSYS_NGA_NB_COI_results),median(PVSYS_NGA_NB_VSL_results),mean(PVSYS_NGA_NB_VSL_results),min(PVSYS_NGA_NB_VSL_results),max(PVSYS_NGA_NB_VSL_results),median(PVSYS_NGA_NB_VSLY_results),mean(PVSYS_NGA_NB_VSLY_results),min(PVSYS_NGA_NB_VSLY_results),max(PVSYS_NGA_NB_VSLY_results))

Summary_table_PV[2,] <- c(median(total_PVSYS_MWI_totalcost_results),mean(total_PVSYS_MWI_totalcost_results),min(total_PVSYS_MWI_totalcost_results),max(total_PVSYS_MWI_totalcost_results),median(total_PVSYS_MWI_eleccostaverted_results),mean(total_PVSYS_MWI_eleccostaverted_results),min(total_PVSYS_MWI_eleccostaverted_results),max(total_PVSYS_MWI_eleccostaverted_results),median(total_PVSYS_MWI_fridgecost_results),mean(total_PVSYS_MWI_fridgecost_results),min(total_PVSYS_MWI_fridgecost_results),max(total_PVSYS_MWI_fridgecost_results),median(vac_MWI_cost_results),mean(vac_MWI_cost_results),min(vac_MWI_cost_results),max(vac_MWI_cost_results),median(vac_MWI_delivery_cost_results),mean(vac_MWI_delivery_cost_results),min(vac_MWI_delivery_cost_results),max(vac_MWI_delivery_cost_results),median(vac_MWI_total_cost_results),mean(vac_MWI_total_cost_results),min(vac_MWI_total_cost_results),max(vac_MWI_total_cost_results),median(vac_MWI_COI_results),mean(vac_MWI_COI_results),min(vac_MWI_COI_results),max(vac_MWI_COI_results),median(vac_MWI_VSL_results),mean(vac_MWI_VSL_results),min(vac_MWI_VSL_results),max(vac_MWI_VSL_results),median(vac_MWI_VSLY_results),mean(vac_MWI_VSLY_results),min(vac_MWI_VSLY_results),max(vac_MWI_VSLY_results),median(PVSYS_MWI_NB_COI_results),mean(PVSYS_MWI_NB_COI_results),min(PVSYS_MWI_NB_COI_results),max(PVSYS_MWI_NB_COI_results),median(PVSYS_MWI_NB_VSL_results),mean(PVSYS_MWI_NB_VSL_results),min(PVSYS_MWI_NB_VSL_results),max(PVSYS_MWI_NB_VSL_results),median(PVSYS_MWI_NB_VSLY_results),mean(PVSYS_MWI_NB_VSLY_results),min(PVSYS_MWI_NB_VSLY_results),max(PVSYS_MWI_NB_VSLY_results))

Summary_table_PV[3,] <- c(median(total_PVSYS_DRC_totalcost_results),mean(total_PVSYS_DRC_totalcost_results),min(total_PVSYS_DRC_totalcost_results),max(total_PVSYS_DRC_totalcost_results),median(total_PVSYS_DRC_eleccostaverted_results),mean(total_PVSYS_DRC_eleccostaverted_results),min(total_PVSYS_DRC_eleccostaverted_results),max(total_PVSYS_DRC_eleccostaverted_results),median(total_PVSYS_DRC_fridgecost_results),mean(total_PVSYS_DRC_fridgecost_results),min(total_PVSYS_DRC_fridgecost_results),max(total_PVSYS_DRC_fridgecost_results),median(vac_DRC_cost_results),mean(vac_DRC_cost_results),min(vac_DRC_cost_results),max(vac_DRC_cost_results),median(vac_DRC_delivery_cost_results),mean(vac_DRC_delivery_cost_results),min(vac_DRC_delivery_cost_results),max(vac_DRC_delivery_cost_results),median(vac_DRC_total_cost_results),mean(vac_DRC_total_cost_results),min(vac_DRC_total_cost_results),max(vac_DRC_total_cost_results),median(vac_DRC_COI_results),mean(vac_DRC_COI_results),min(vac_DRC_COI_results),max(vac_DRC_COI_results),median(vac_DRC_VSL_results),mean(vac_DRC_VSL_results),min(vac_DRC_VSL_results),max(vac_DRC_VSL_results),median(vac_DRC_VSLY_results),mean(vac_DRC_VSLY_results),min(vac_DRC_VSLY_results),max(vac_DRC_VSLY_results),median(PVSYS_DRC_NB_COI_results),mean(PVSYS_DRC_NB_COI_results),min(PVSYS_DRC_NB_COI_results),max(PVSYS_DRC_NB_COI_results),median(PVSYS_DRC_NB_VSL_results),mean(PVSYS_DRC_NB_VSL_results),min(PVSYS_DRC_NB_VSL_results),max(PVSYS_DRC_NB_VSL_results),median(PVSYS_DRC_NB_VSLY_results),mean(PVSYS_DRC_NB_VSLY_results),min(PVSYS_DRC_NB_VSLY_results),max(PVSYS_DRC_NB_VSLY_results))

Summary_table_PV[4,] <- c(median(total_PVSYS_totalcost_results),mean(total_PVSYS_totalcost_results),min(total_PVSYS_totalcost_results),max(total_PVSYS_totalcost_results),median(total_PVSYS_eleccostaverted_results),mean(total_PVSYS_eleccostaverted_results),min(total_PVSYS_eleccostaverted_results),max(total_PVSYS_eleccostaverted_results),median(total_PVSYS_total_fridgecost_results),mean(total_PVSYS_total_fridgecost_results),min(total_PVSYS_total_fridgecost_results),max(total_PVSYS_total_fridgecost_results),median(vac_cost_results),mean(vac_cost_results),min(vac_cost_results),max(vac_cost_results),median(vac_delivery_cost_results),mean(vac_delivery_cost_results),min(vac_delivery_cost_results),max(vac_delivery_cost_results),median(vac_total_cost_results),mean(vac_total_cost_results),min(vac_total_cost_results),max(vac_total_cost_results),median(vac_COI_results),mean(vac_COI_results),min(vac_COI_results),max(vac_COI_results),median(vac_VSL_results),mean(vac_VSL_results),min(vac_VSL_results),max(vac_VSL_results),median(vac_VSLY_results),mean(vac_VSLY_results),min(vac_VSLY_results),max(vac_VSLY_results),median(PVSYS_NB_COI_results),mean(PVSYS_NB_COI_results),min(PVSYS_NB_COI_results),max(PVSYS_NB_COI_results),median(PVSYS_NB_VSL_results),mean(PVSYS_NB_VSL_results),min(PVSYS_NB_VSL_results),max(PVSYS_NB_VSL_results),median(PVSYS_NB_VSLY_results),mean(PVSYS_NB_VSLY_results),min(PVSYS_NB_VSLY_results),max(PVSYS_NB_VSLY_results))

Summary_table_PV <- as.data.frame(Summary_table_PV)


View(Summary_table_PV)
View(Summary_table_SF)


library(openxlsx)
write.xlsx(Summary_table_SF, paste("Summary_table_VCRC.xlsx"))
write.xlsx(Summary_table_PV, paste("Summary_table_PVSYS_VCRC.xlsx"))

#Energy System cost distribution plots
hist(total_VCRC_totalcost_results, main = "VCRC Direct Cost", cex.main = 1,xlab = "MC VCRC Direct Cost ($ million)", col = "lightblue", border = "black")
hist(total_PVSYS_totalcost_results, main = "PVSYS Direct Cost", cex.main = 1,xlab = "MC PVSYS Direct Cost ($ million)", col = "lightblue", border = "black")


#Vaccination cost distribution plots
hist(vac_cost_results, main = "Vaccination purchase Cost",cex.main = 1, xlab = "MC Vaccination purchase Cost ($ million)", col = "lightblue", border = "black")
hist(vac_delivery_cost_results, main = "Vaccination delivery Cost",cex.main = 1, xlab = "MC Vaccination delivery Cost ($ million)", col = "lightblue", border = "black")
hist(vac_total_cost_results, main = "Vaccination Total Cost",cex.main = 1, xlab = "MC Vaccination Total Cost ($ million)", col = "lightblue", border = "black")

#Benefits distribution plot
hist(vac_COI_results, main = "Vaccine Benefit (COI Method)",cex.main = 1, xlab = "MC Benefit COI method ($ million)", col = "lightblue", border = "black")
hist(vac_VSL_results, main = "Vaccine Benefit (VSL Method)", cex.main = 1,xlab = "MC Benefit VSL method ($ million)", col = "lightblue", border = "black")
hist(vac_VSLY_results, main = "Vaccine Benefit (VSLY Method)", cex.main = 1,xlab = "MC Benefit VSLY method ($ million)", col = "lightblue", border = "black")

#Net Benefits distribution plots

options(scipen = 999)
hist(VCRC_NB_COI_results, main = "Monte Carlo histogram for Net Benefit using using Solar Fridges (COI Method)",cex.main = 1, xlab = "Net_Benefit [VCRC_COI method] ($ million)", ylab = "Number of cases from a total of 10,000",col = "lightblue", border = "black", axes=FALSE)
axis(side = 1, at = pretty(VCRC_NB_COI_results), labels = paste("$", format(pretty(VCRC_NB_COI_results), big.mark = ",")), las = 1)
axis(side = 2)
options(scipen = 0)
box()
summary(VCRC_NB_COI_results)

options(scipen = 999)
hist(PVSYS_NB_COI_results, main = "Monte Carlo histogram for Net Benefit using using PV Systems (COI Method)", cex.main = 1,xlab = "Net_Benefit [PVSYS_COI method] ($ million)", ylab = "Number of cases from a total of 10,000",col = "lightblue", border = "black", axes=FALSE)
axis(side = 1, at = pretty(PVSYS_NB_COI_results), labels = paste("$", format(pretty(PVSYS_NB_COI_results), big.mark = ",")), las = 1)
axis(side = 2)
options(scipen = 0)
box()
summary(PVSYS_NB_COI_results)


options(scipen = 999)
hist(VCRC_NB_VSL_results, main = "Monte Carlo histogram for Net Benefit using using Solar Fridges (VSL Method)",cex.main = 1, xlab = "Net_Benefit [VCRC_VSL method] ($ million)", ylab = "Number of cases from a total of 10,000",col = "lightblue", border = "black", axes=FALSE)
axis(side = 1, at = pretty(VCRC_NB_VSL_results), labels = paste("$", format(pretty(VCRC_NB_VSL_results), big.mark = ",")), las = 1)
axis(side = 2)
options(scipen = 0)
box()
summary(VCRC_NB_VSL_results)

options(scipen = 999)
hist(PVSYS_NB_VSL_results, main = "Monte Carlo histogram for Net Benefit using using PV Systems (VSL Method)", cex.main = 1,xlab = "Net_Benefit [PVSYS_VSL method] ($ million)", ylab = "Number of cases from a total of 10,000",col = "lightblue", border = "black", axes=FALSE)
axis(side = 1, at = pretty(PVSYS_NB_VSL_results), labels = paste("$", format(pretty(PVSYS_NB_VSL_results), big.mark = ",")), las = 1)
axis(side = 2)
options(scipen = 0)
box()
summary(PVSYS_NB_VSL_results)


options(scipen = 999)
hist(VCRC_NB_VSLY_results, main = "Monte Carlo histogram for Net Benefit using using Solar Fridges (VSLY Method)",cex.main = 1, xlab = "Net_Benefit [VCRC_VSLY method] ($ million)", ylab = "Number of cases from a total of 10,000",col = "lightblue", border = "black", axes=FALSE)
axis(side = 1, at = pretty(VCRC_NB_VSLY_results), labels = paste("$", format(pretty(VCRC_NB_VSLY_results), big.mark = ",")), las = 1)
axis(side = 2)
options(scipen = 0)
box()
summary(VCRC_NB_VSLY_results)

options(scipen = 999)
hist(PVSYS_NB_VSLY_results, main = "Monte Carlo histogram for Net Benefit using using PV Systems (VSLY Method)", cex.main = 1, xlab = "Net_Benefit [PVSYS_VSLY method] ($ million)", ylab = "Number of cases from a total of 10,000",col = "lightblue", border = "black", axes=FALSE)
axis(side = 1, at = pretty(PVSYS_NB_VSLY_results), labels = paste("$", format(pretty(PVSYS_NB_VSLY_results), big.mark = ",")), las = 1)
axis(side = 2)
options(scipen = 0)
box()
summary(PVSYS_NB_VSLY_results)


```
